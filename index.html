<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrayLink - Messages Anonymes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
        }
        
        .app-container {
            max-width: 375px;
            margin: 0 auto;
            min-height: 100vh;
            background: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 768px) {
            .app-container {
                max-width: 100%;
                box-shadow: none;
            }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .premium-glow {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        .question-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .game-card {
            transition: all 0.3s ease;
        }
        
        .game-card:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .simple-btn {
            transition: background-color 0.2s ease;
            cursor: pointer;
        }
        
        .simple-btn:hover {
            opacity: 0.9;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #667eea;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="app-container">
        
        <!-- Page 1: Accueil -->
        <div id="welcomePage" class="gradient-bg h-screen flex flex-col justify-center items-center text-white p-8">
            <div class="text-center mb-12">
                <div class="w-32 h-32 bg-white rounded-full mx-auto mb-6 flex items-center justify-center text-6xl">
                    üôè
                </div>
                <h1 class="text-4xl font-bold mb-4">PrayLink</h1>
                <p class="text-lg opacity-90">Messages anonymes bibliques</p>
            </div>
            
            <div class="w-full max-w-sm">
                <button onclick="goToPage('platformPage')" class="w-full bg-white text-gray-900 font-bold py-4 px-6 rounded-2xl text-lg mb-6 shadow-lg simple-btn">
                    üöÄ D√©marrer
                </button>
                
                <div class="text-center text-sm opacity-75">
                    <p class="mb-2">En continuant, vous acceptez les</p>
                    <a href="#" class="underline">Conditions d'utilisation</a>
                </div>
            </div>
        </div>

        <!-- Page 2: Choix de plateforme -->
        <div id="platformPage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center mb-8">
                <button onclick="goToPage('welcomePage')" class="text-2xl simple-btn">‚Üê</button>
                <h2 class="text-xl font-semibold ml-4">Choisir une plateforme</h2>
            </div>
            
            <div class="flex-1 flex flex-col justify-center">
                <p class="text-center text-gray-600 mb-8">Sous quel nom veux-tu utiliser PrayLink ?</p>
                
                <div class="space-y-4 mb-8">
                    <button onclick="selectPlatform('instagram')" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-xl simple-btn">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center text-white text-xl mr-4">
                                üì∑
                            </div>
                            <span class="font-medium">Instagram</span>
                        </div>
                        <span class="text-gray-400 text-2xl">‚Üí</span>
                    </button>
                    
                    <button onclick="selectPlatform('whatsapp')" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-xl simple-btn">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center text-white text-xl mr-4">
                                üì±
                            </div>
                            <span class="font-medium">WhatsApp</span>
                        </div>
                        <span class="text-gray-400 text-2xl">‚Üí</span>
                    </button>
                    
                    <button onclick="selectPlatform('snapchat')" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-xl simple-btn">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-yellow-400 rounded-xl flex items-center justify-center text-gray-800 text-xl mr-4">
                                üëª
                            </div>
                            <span class="font-medium">Snapchat</span>
                        </div>
                        <span class="text-gray-400 text-2xl">‚Üí</span>
                    </button>
                </div>
                
                <button onclick="goToPage('usernamePage')" class="w-full bg-gray-900 text-white font-semibold py-4 rounded-xl simple-btn">
                    Continuer
                </button>
            </div>
        </div>

        <!-- Page 3: Nom d'utilisateur -->
        <div id="usernamePage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center mb-8">
                <button onclick="goToPage('platformPage')" class="text-2xl interactive-btn">‚Üê</button>
                <h2 class="text-xl font-semibold ml-4">Nom d'utilisateur</h2>
            </div>
            
            <div class="flex-1 flex flex-col justify-center">
                <p class="text-center text-gray-600 mb-8">Choisis ton nom d'utilisateur</p>
                
                <div class="mb-6">
                    <input type="text" id="usernameInput" placeholder="@tonnom" 
                           class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl text-lg focus:border-gray-900 focus:outline-none">
                </div>
                
                <button onclick="goToPage('profilePhotoPage')" class="w-full bg-gray-900 text-white font-semibold py-4 rounded-xl mb-4 interactive-btn hover:glow">
                    Continuer
                </button>
            </div>
        </div>

        <!-- Page 4: Photo de profil -->
        <div id="profilePhotoPage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center mb-8">
                <button onclick="goToPage('usernamePage')" class="text-2xl interactive-btn">‚Üê</button>
                <h2 class="text-xl font-semibold ml-4">Photo de profil</h2>
            </div>
            
            <div class="flex-1 flex flex-col justify-center items-center">
                <p class="text-center text-gray-600 mb-8">Choisis une photo pour ton profil</p>
                
                <div class="w-32 h-32 bg-gray-200 rounded-full mb-8 flex items-center justify-center text-4xl cursor-pointer simple-btn" onclick="selectProfilePhoto()">
                    <span id="profileEmoji">üì∑</span>
                </div>
                
                <div class="grid grid-cols-4 gap-4 mb-8">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('üôè')">üôè</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('‚ú®')">‚ú®</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('üí´')">üí´</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('üåü')">üåü</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('üíù')">üíù</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('üïäÔ∏è')">üïäÔ∏è</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('üëº')">üëº</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('üéØ')">üéØ</div>
                </div>
                
                <div class="w-full space-y-3">
                    <button onclick="registerUser()" class="w-full bg-gray-900 text-white font-semibold py-4 rounded-xl interactive-btn hover:glow">
                        Continuer
                    </button>
                    <button onclick="goToPage('premiumPage')" class="w-full text-gray-500 py-2 interactive-btn">
                        Ignorer
                    </button>
                </div>
            </div>
        </div>

        <!-- Page 5: Acc√®s illimit√© -->
        <div id="premiumPage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center justify-between mb-8">
                <button onclick="goToPage('profilePhotoPage')" class="text-2xl interactive-btn">‚Üê</button>
                <button onclick="goToPage('mainPage')" class="text-purple-600 font-medium interactive-btn">Passer</button>
            </div>
            
            <div class="flex-1 flex flex-col justify-center">
                <div class="text-center mb-8">
                    <div class="w-24 h-24 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center text-4xl premium-glow pulse-effect">
                        üëë
                    </div>
                    <h2 class="text-2xl font-bold mb-2">Acc√®s illimit√©</h2>
                    <p class="text-gray-600">D√©bloquez toutes les fonctionnalit√©s premium</p>
                </div>
                
                <div class="space-y-4 mb-8">
                    <div class="flex items-center p-4 bg-yellow-50 rounded-xl">
                        <span class="text-2xl mr-4">üéÆ</span>
                        <span class="font-medium">100 jeux bibliques exclusifs</span>
                    </div>
                    <div class="flex items-center p-4 bg-blue-50 rounded-xl">
                        <span class="text-2xl mr-4">üèÜ</span>
                        <span class="font-medium">3 niveaux de difficult√©</span>
                    </div>
                    <div class="flex items-center p-4 bg-purple-50 rounded-xl">
                        <span class="text-2xl mr-4">üìä</span>
                        <span class="font-medium">Suivi de progression</span>
                    </div>
                </div>
                
                <button onclick="goToPage('mainPage')" class="w-full bg-gray-900 text-white font-bold py-4 rounded-xl mb-4 interactive-btn hover:glow">
                    Continuer
                </button>
            </div>
        </div>

        <!-- Page 6: Page principale -->
        <div id="mainPage" class="hidden h-screen bg-white flex flex-col">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 border-b">
                <h1 class="text-xl font-bold">PrayLink</h1>
                <div class="flex items-center space-x-4">
                    <button onclick="goToPage('inboxPage')" class="relative interactive-btn">
                        <span class="text-2xl">üì¨</span>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center pulse-effect">3</span>
                    </button>
                    <button onclick="goToPage('settingsPage')" class="text-2xl interactive-btn">‚öôÔ∏è</button>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="flex border-b">
                <button onclick="showTab('play')" class="flex-1 py-4 text-center font-medium border-b-2 border-gray-900 text-gray-900 interactive-btn" id="playTab">
                    Play
                </button>
                <button onclick="showTab('games')" class="flex-1 py-4 text-center font-medium text-gray-500 interactive-btn" id="gamesTab">
                    Jeux
                </button>
                <button onclick="showTab('inbox')" class="flex-1 py-4 text-center font-medium text-gray-500 interactive-btn" id="inboxTab">
                    Inbox
                </button>
            </div>
            
            <!-- Play Content -->
            <div id="playContent" class="flex-1 flex flex-col overflow-y-auto">
                <!-- Profil principal -->
                <div class="p-6 border-b bg-white">
                    <div class="flex items-center mb-4">
                        <div class="w-20 h-20 bg-gradient-to-br from-gray-700 to-gray-900 rounded-full flex items-center justify-center text-3xl shadow-lg mr-4 pulse-effect">
                            <span id="mainProfileEmoji">üôè</span>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-xl font-bold mb-1" id="mainUsername">@PrayerWarrior</h2>
                            <p class="text-gray-600 text-sm">Messages anonymes bibliques üìñ</p>
                        </div>
                    </div>
                    
                    <div class="flex space-x-6">
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">42</div>
                            <div class="text-xs text-gray-500">Messages</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">15</div>
                            <div class="text-xs text-gray-500">Pri√®res</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">8</div>
                            <div class="text-xs text-gray-500">T√©moignages</div>
                        </div>
                    </div>
                </div>
                
                <!-- Choix Questions ou Versets -->
                <div class="p-6 bg-white">
                    <h3 class="text-lg font-semibold text-center mb-6">Que veux-tu partager ?</h3>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Bouton Questions -->
                        <button onclick="openQuestionsModal()" class="bg-gradient-to-br from-purple-500 to-pink-600 text-white p-6 rounded-2xl text-center hover:shadow-lg transition-all interactive-btn">
                            <div class="text-4xl mb-3">‚ùì</div>
                            <h4 class="font-bold text-lg mb-2">Questions</h4>
                            <p class="text-sm opacity-90">100 questions bibliques √† partager</p>
                        </button>
                        
                        <!-- Bouton Versets -->
                        <button onclick="openVersetsModal()" class="bg-gradient-to-br from-blue-500 to-indigo-600 text-white p-6 rounded-2xl text-center hover:shadow-lg transition-all interactive-btn">
                            <div class="text-4xl mb-3">üìñ</div>
                            <h4 class="font-bold text-lg mb-2">Versets</h4>
                            <p class="text-sm opacity-90">Versets inspirants √† partager</p>
                        </button>
                    </div>
                </div>
                
                <!-- Section Statistiques -->
                <div class="p-6 bg-gray-50">
                    <h3 class="text-lg font-semibold mb-4">Tes partages</h3>
                    <div class="grid grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold text-purple-600">12</div>
                            <div class="text-xs text-gray-500">Questions partag√©es</div>
                        </div>
                        <div class="bg-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold text-blue-600">8</div>
                            <div class="text-xs text-gray-500">Versets partag√©s</div>
                        </div>
                        <div class="bg-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold text-green-600">25</div>
                            <div class="text-xs text-gray-500">R√©ponses re√ßues</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Games Content -->
            <div id="gamesContent" class="hidden flex-1 p-4 overflow-y-auto">
                <div class="text-center mb-6">
                    <h3 class="text-lg font-semibold mb-2">Jeux Bibliques</h3>
                    <p class="text-gray-600 text-sm">D√©couvre la Bible en t'amusant !</p>
                </div>
                
                <!-- Jeux Gratuits -->
                <div class="mb-6">
                    <h4 class="text-md font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="text-green-600 mr-2">üÜì</span>
                        Jeux Gratuits
                    </h4>
                    
                    <div class="space-y-4">
                        <div class="bg-gradient-to-r from-gray-700 to-gray-900 rounded-2xl p-6 text-white">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">üìñ Quiz Biblique</h4>
                                    <p class="text-sm opacity-90">Teste tes connaissances</p>
                                </div>
                                <div class="text-3xl pulse-effect">üß†</div>
                            </div>
                            <button onclick="startBibleQuiz()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                üéÆ Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-gray-600 to-gray-800 rounded-2xl p-6 text-white">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">üîç Trouve le Verset</h4>
                                    <p class="text-sm opacity-90">Compl√®te les versets manquants</p>
                                </div>
                                <div class="text-3xl pulse-effect">üìú</div>
                            </div>
                            <button onclick="startVerseGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                üéÆ Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-gray-500 to-gray-700 rounded-2xl p-6 text-white">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">üß© M√©moire Biblique</h4>
                                    <p class="text-sm opacity-90">M√©morise les personnages</p>
                                </div>
                                <div class="text-3xl pulse-effect">üéØ</div>
                            </div>
                            <button onclick="startMemoryGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                üéÆ Jouer maintenant
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Jeux Premium -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-md font-semibold text-gray-700 flex items-center">
                            <span class="text-yellow-500 mr-2">üëë</span>
                            Jeux Premium
                        </h4>
                        <button onclick="upgradeToPremium()" class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-3 py-1 rounded-full text-xs font-bold premium-glow">
                            D√âBLOQUER
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-2xl p-6 text-white relative overflow-hidden">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                ‚úÖ D√âBLOQU√â
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">‚öîÔ∏è Bataille Biblique</h4>
                                    <p class="text-sm opacity-90">D√©fie tes amis en temps r√©el</p>
                                </div>
                                <div class="text-3xl pulse-effect">‚öîÔ∏è</div>
                            </div>
                            <button onclick="startBattleGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                üéÆ Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-500 to-pink-600 rounded-2xl p-6 text-white relative overflow-hidden premium-glow">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                ‚úÖ D√âBLOQU√â
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">üèÜ Tournoi des Proph√®tes</h4>
                                    <p class="text-sm opacity-90">Comp√©tition mondiale ‚Ä¢ 2,847 participants</p>
                                </div>
                                <div class="text-3xl pulse-effect">üèÜ</div>
                            </div>
                            <button onclick="startTournament()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                üéÆ Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl p-6 text-white relative overflow-hidden premium-glow">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                ‚úÖ D√âBLOQU√â
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">üé≠ Myst√®res Bibliques</h4>
                                    <p class="text-sm opacity-90">R√©sous des √©nigmes sacr√©es ‚Ä¢ ‚àû myst√®res infinis ‚Ä¢ Myst√®re ultime : La R√©surrection</p>
                                </div>
                                <div class="text-3xl pulse-effect">üîç</div>
                            </div>
                            <button onclick="startMysteryGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                üéÆ Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white relative overflow-hidden premium-glow">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                ‚úÖ D√âBLOQU√â
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">üåü Parcours Spirituel</h4>
                                    <p class="text-sm opacity-90">Aventure interactive de 40 jours ‚Ä¢ Jour 1/40 ‚Ä¢ Croissance personnelle</p>
                                </div>
                                <div class="text-3xl pulse-effect">üó∫Ô∏è</div>
                            </div>
                            <button onclick="startSpiritualJourney()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                üéÆ Commencer le parcours
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Avantages Premium -->
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-2xl p-4">
                    <div class="text-center mb-4">
                        <div class="text-3xl mb-2">üëë</div>
                        <h4 class="font-bold text-gray-800 mb-1">Passe Premium !</h4>
                        <p class="text-sm text-gray-600">D√©bloquer tous les jeux exclusifs</p>
                    </div>
                    
                    <div class="space-y-2 mb-4">
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úÖ</span>
                            <span>4 jeux premium exclusifs</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úÖ</span>
                            <span>Mode multijoueur en temps r√©el</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úÖ</span>
                            <span>Classements et r√©compenses</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">‚úÖ</span>
                            <span>Parcours spirituel personnalis√©</span>
                        </div>
                    </div>
                    
                    <button onclick="upgradeToPremium()" class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold py-3 rounded-xl premium-glow interactive-btn">
                        üëë Passer Premium - 4,99‚Ç¨/mois
                    </button>
                </div>
            </div>
            
            <!-- Inbox Content -->
            <div id="inboxContent" class="hidden flex-1 p-4">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold">Messages re√ßus</h3>
                    <button onclick="generateRandomQuestion()" class="bg-gray-100 text-gray-900 px-3 py-1 rounded-full text-sm interactive-btn hover:glow">
                        üé≤ Question al√©atoire
                    </button>
                </div>
                
                <div class="space-y-4" id="messagesList">
                    <!-- Les messages seront charg√©s dynamiquement -->
                </div>
            </div>
        </div>

        <!-- Page 9: Actualit√©s des versets -->
        <div id="inboxPage" class="hidden h-screen bg-white flex flex-col">
            <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white">
                <button onclick="goToPage('mainPage')" class="text-2xl mr-4 interactive-btn text-white">‚Üê</button>
                <div class="flex-1">
                    <h2 class="text-xl font-semibold">üì¨ Actualit√©s</h2>
                    <p class="text-sm opacity-90">Versets partag√©s aujourd'hui</p>
                </div>
                <div class="text-right">
                    <div class="text-lg font-bold">24</div>
                    <div class="text-xs opacity-75">nouveaux</div>
                </div>
            </div>
            
            <!-- Filtres -->
            <div class="flex items-center p-4 border-b bg-gray-50">
                <button onclick="filterVerses('all')" class="px-4 py-2 bg-purple-600 text-white rounded-full text-sm mr-3 interactive-btn" id="filterAll">
                    Tous
                </button>
                <button onclick="filterVerses('recent')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm mr-3 interactive-btn" id="filterRecent">
                    R√©cents
                </button>
                <button onclick="filterVerses('popular')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm interactive-btn" id="filterPopular">
                    Populaires
                </button>
            </div>
            
            <!-- Liste des versets -->
            <div class="flex-1 overflow-y-auto p-4 custom-scrollbar" id="versesNewsFeed" style="max-height: calc(100vh - 200px);">
                <!-- Le contenu sera charg√© dynamiquement -->
            </div>
        </div>

        <!-- Page 10: Param√®tres -->
        <div id="settingsPage" class="hidden h-screen bg-white flex flex-col">
            <div class="flex items-center p-4 border-b">
                <button onclick="goToPage('mainPage')" class="text-2xl mr-4 interactive-btn">‚Üê</button>
                <h2 class="text-xl font-semibold">Param√®tres</h2>
            </div>
            
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 border-b">
                    <button onclick="showHowToShare()" class="w-full flex items-center justify-between interactive-btn">
                        <div class="flex items-center">
                            <span class="text-2xl mr-4">üì±</span>
                            <span class="font-medium">Comment partager le lien</span>
                        </div>
                        <span class="text-gray-400">‚Üí</span>
                    </button>
                </div>
                
                <div class="p-4 border-b">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="text-2xl mr-4">üîî</span>
                            <span class="font-medium">Notifications</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="p-4">
                    <button onclick="deleteAccount()" class="w-full flex items-center justify-between text-red-600 interactive-btn">
                        <div class="flex items-center">
                            <span class="text-2xl mr-4">üóëÔ∏è</span>
                            <span class="font-medium">Supprimer le compte</span>
                        </div>
                        <span class="text-gray-400">‚Üí</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Questions -->
        <div id="questionsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">‚ùì Questions Bibliques</h3>
                    <button onclick="closeQuestionsModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="questionCard" class="p-6 bg-gradient-to-br from-purple-500 to-pink-600 text-white rounded-2xl mb-4">
                    <div class="text-center">
                        <div id="questionEmoji" class="text-4xl mb-3">‚ùì</div>
                        <h4 id="questionText" class="text-lg font-bold mb-2">Quel verset biblique te parle aujourd'hui ?</h4>
                        <p class="text-sm opacity-75">Question <span id="currentQuestionNumber">1</span> ‚Ä¢ <span id="totalQuestionsCount">‚àû</span> questions disponibles</p>
                        <div class="mt-2">
                            <span class="bg-white bg-opacity-20 px-2 py-1 rounded-full text-xs" id="questionCategory">Versets</span>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center justify-center space-x-4 mb-4">
                    <button onclick="previousQuestion()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        ‚Üê
                    </button>
                    <button onclick="randomQuestion()" class="bg-gray-100 text-gray-900 px-4 py-2 rounded-full text-sm font-medium interactive-btn">
                        üé≤ Al√©atoire
                    </button>
                    <button onclick="nextQuestion()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        ‚Üí
                    </button>
                </div>
                
                <div class="space-y-3">
                    <button onclick="shareCurrentQuestion()" class="w-full bg-purple-600 text-white font-bold py-3 rounded-xl interactive-btn">
                        üì± Partager cette question
                    </button>
                    <button onclick="copyCurrentQuestion()" class="w-full bg-gray-100 text-gray-700 font-medium py-3 rounded-xl interactive-btn">
                        üìã Copier le lien
                    </button>
                    <button onclick="showQuestionInsights()" class="w-full bg-blue-100 text-blue-700 font-medium py-3 rounded-xl interactive-btn">
                        üìä Voir les indices
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Versets -->
        <div id="versetsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">üìñ Versets Inspirants</h3>
                    <button onclick="closeVersetsModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="versetCard" class="p-6 bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-2xl mb-4">
                    <div class="text-center">
                        <div class="text-4xl mb-3">üìñ</div>
                        <div class="bg-white bg-opacity-20 rounded-lg p-4 mb-4">
                            <p id="versetText" class="text-sm font-medium italic mb-2">"Car Dieu a tant aim√© le monde qu'il a donn√© son Fils unique, afin que quiconque croit en lui ne p√©risse point, mais qu'il ait la vie √©ternelle."</p>
                            <p id="versetRef" class="text-xs opacity-75">Jean 3:16</p>
                        </div>
                        <p class="text-sm opacity-75">Verset <span id="currentVersetNumber">1</span>/50</p>
                    </div>
                </div>
                
                <div class="flex items-center justify-center space-x-4 mb-4">
                    <button onclick="previousVerset()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        ‚Üê
                    </button>
                    <button onclick="randomVerset()" class="bg-gray-100 text-gray-900 px-4 py-2 rounded-full text-sm font-medium interactive-btn">
                        üé≤ Al√©atoire
                    </button>
                    <button onclick="nextVerset()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        ‚Üí
                    </button>
                </div>
                
                <div class="space-y-3">
                    <button onclick="shareCurrentVerset()" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl interactive-btn">
                        üì± Partager ce verset
                    </button>
                    <button onclick="sendVersetToSomeone()" class="w-full bg-green-600 text-white font-bold py-3 rounded-xl interactive-btn">
                        üíå Envoyer √† quelqu'un
                    </button>
                    <button onclick="copyCurrentVerset()" class="w-full bg-gray-100 text-gray-700 font-medium py-3 rounded-xl interactive-btn">
                        üìã Copier le verset
                    </button>
                    <button onclick="showVersetInsights()" class="w-full bg-green-100 text-green-700 font-medium py-3 rounded-xl interactive-btn">
                        üìä Voir les indices
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Quiz Biblique -->
        <div id="quizModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">üìñ Quiz Biblique</h3>
                    <button onclick="closeQuizModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="quizContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">üß†</div>
                        <h4 class="font-semibold mb-2" id="quizQuestion">Qui a construit l'arche ?</h4>
                        <p class="text-sm text-gray-600">Question <span id="quizNumber">1</span> ‚Ä¢ Score: <span id="currentScore">0</span></p>
                    </div>
                    
                    <div class="space-y-3 mb-6" id="quizOptions">
                        <button onclick="selectQuizAnswer(0)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            A) Mo√Øse
                        </button>
                        <button onclick="selectQuizAnswer(1)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            B) No√©
                        </button>
                        <button onclick="selectQuizAnswer(2)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            C) Abraham
                        </button>
                        <button onclick="selectQuizAnswer(3)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            D) David
                        </button>
                    </div>
                    
                    <button onclick="nextQuizQuestion()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow" id="nextQuizBtn" disabled>
                        Suivant
                    </button>
                </div>
                
                <div id="quizResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect">üéâ</div>
                    <h4 class="text-lg font-semibold mb-2">Quiz termin√© !</h4>
                    <p class="text-gray-600 mb-4">Score: <span id="finalScore">0</span>/5</p>
                    <button onclick="restartQuiz()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                        Rejouer
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal M√©moire Biblique -->
        <div id="memoryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">üß© M√©moire Biblique</h3>
                    <button onclick="closeMemoryModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="memoryContent">
                    <div class="text-center mb-4">
                        <div class="text-4xl mb-2 pulse-effect">üéØ</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Niveau: <span id="memoryLevel" class="font-bold text-purple-600">1</span></div>
                            <div>Score: <span id="memoryScore" class="font-bold text-green-600">0</span></div>
                            <div>Temps: <span id="memoryTimer" class="font-bold text-red-600">60s</span></div>
                        </div>
                        <div class="text-xs text-gray-500 mb-4">
                            Coups: <span id="memoryMoves">0</span> ‚Ä¢ Paires: <span id="memoryPairs">0</span>/<span id="memoryTotal">6</span>
                        </div>
                    </div>
                    
                    <div id="memoryGrid" class="grid grid-cols-4 gap-2 mb-4">
                        <!-- Les cartes seront g√©n√©r√©es ici -->
                    </div>
                    
                    <div class="text-center">
                        <button onclick="restartMemoryGame()" class="bg-purple-600 text-white px-4 py-2 rounded-xl text-sm interactive-btn hover:glow">
                            üîÑ Recommencer
                        </button>
                    </div>
                </div>
                
                <div id="memoryResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="memoryResultIcon">üéâ</div>
                    <h4 class="text-lg font-semibold mb-2" id="memoryResultText">Niveau termin√© !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-purple-600" id="finalMemoryScore">0</div>
                                <div class="text-xs text-gray-500">Points</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-blue-600" id="finalMemoryMoves">0</div>
                                <div class="text-xs text-gray-500">Coups</div>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="nextMemoryLevel()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow" id="nextLevelBtn">
                            ‚û°Ô∏è Niveau suivant
                        </button>
                        <button onclick="restartMemoryGame()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üîÑ Rejouer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Trouve le Verset -->
        <div id="verseModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">üîç Trouve le Verset</h3>
                    <button onclick="closeVerseModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="verseContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">üìú</div>
                        <p class="text-sm text-gray-600 mb-4">Compl√®te ce verset c√©l√®bre</p>
                        <div class="bg-gray-50 p-4 rounded-lg mb-4">
                            <p class="text-sm" id="verseText">"Car Dieu a tant aim√© le monde qu'il a donn√© son Fils _____, afin que quiconque croit en lui ne p√©risse point, mais qu'il ait la vie _____."</p>
                            <p class="text-xs text-gray-500 mt-2" id="verseRef">Jean 3:16</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3 mb-6">
                        <input type="text" id="verseInput1" placeholder="Premier mot manquant" class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none">
                        <input type="text" id="verseInput2" placeholder="Second mot manquant" class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none">
                    </div>
                    
                    <button onclick="checkVerseAnswer()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                        V√©rifier
                    </button>
                </div>
                
                <div id="verseResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="verseResultIcon">‚úÖ</div>
                    <h4 class="text-lg font-semibold mb-2" id="verseResultText">Correct !</h4>
                    <p class="text-gray-600 mb-4" id="verseResultMessage">Bien jou√© ! Tu connais bien tes versets.</p>
                    <button onclick="nextVerse()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                        Verset suivant
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal de partage -->
        <div id="shareModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800">üì± Partager</h3>
                    <button onclick="closeShareModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        √ó
                    </button>
                </div>
                
                <!-- Aper√ßu du message -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-4 mb-6 border border-purple-100">
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            üôè
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm" id="shareUsername">@PrayerWarrior</p>
                            <p class="text-xs text-gray-500">Question biblique</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-700 mb-3" id="shareText">Quel verset biblique te parle aujourd'hui ?</p>
                    <div class="bg-white rounded-lg p-3 border border-gray-200">
                        <p class="text-xs text-gray-500 mb-1">Lien de r√©ponse</p>
                        <input type="text" id="shareLink" class="w-full text-xs text-purple-600 bg-transparent border-none outline-none" readonly>
                    </div>
                </div>
                
                <!-- Boutons de partage -->
                <div class="space-y-3 mb-4">
                    <button onclick="copyShareLink()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-4 rounded-2xl flex items-center justify-center space-x-3 hover:shadow-lg transition-all">
                        <span class="text-xl">üìã</span>
                        <span>Copier le lien</span>
                    </button>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="shareToInstagram()" class="bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">üì∑</span>
                            <span class="text-sm">Instagram</span>
                        </button>
                        
                        <button onclick="shareToWhatsApp()" class="bg-gradient-to-br from-green-500 to-emerald-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">üí¨</span>
                            <span class="text-sm">WhatsApp</span>
                        </button>
                        
                        <button onclick="shareToSnapchat()" class="bg-gradient-to-br from-yellow-400 to-orange-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">üëª</span>
                            <span class="text-sm">Snapchat</span>
                        </button>
                        
                        <button onclick="shareToTwitter()" class="bg-gradient-to-br from-blue-500 to-cyan-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">üê¶</span>
                            <span class="text-sm">Twitter</span>
                        </button>
                    </div>
                </div>
                
                <!-- Statistiques -->
                <div class="bg-gray-50 rounded-2xl p-4">
                    <div class="flex items-center justify-between text-sm">
                        <div class="text-center">
                            <div class="font-bold text-purple-600">12</div>
                            <div class="text-xs text-gray-500">Vues</div>
                        </div>
                        <div class="text-center">
                            <div class="font-bold text-green-600">5</div>
                            <div class="text-xs text-gray-500">R√©ponses</div>
                        </div>
                        <div class="text-center">
                            <div class="font-bold text-blue-600">3</div>
                            <div class="text-xs text-gray-500">Partages</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal How to Share -->
        <div id="howToShareModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full">
                <h3 class="text-lg font-semibold mb-4">Comment partager ton lien</h3>
                <div class="space-y-4 mb-6">
                    <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-2xl mr-3">üì±</span>
                        <span class="text-sm">Copie ton lien personnel</span>
                    </div>
                    <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-2xl mr-3">üì∑</span>
                        <span class="text-sm">Partage sur ta story Instagram</span>
                    </div>
                    <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-2xl mr-3">üí¨</span>
                        <span class="text-sm">Envoie √† tes amis</span>
                    </div>
                </div>
                <button onclick="closeHowToShare()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                    Compris !
                </button>
            </div>
        </div>

        <!-- Modal de Conversation -->
        <div id="conversationModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl max-w-sm w-full h-[80vh] flex flex-col shadow-2xl">
                <!-- Header de conversation -->
                <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-t-3xl">
                    <button onclick="closeConversation()" class="text-2xl mr-4 interactive-btn text-white">‚Üê</button>
                    <div class="flex items-center flex-1">
                        <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-lg mr-3" id="conversationUserAvatar">
                            üë§
                        </div>
                        <div>
                            <h3 class="font-semibold" id="conversationUserName">Marie_2024</h3>
                            <p class="text-xs opacity-75" id="conversationStatus">En ligne</p>
                        </div>
                    </div>
                    <button onclick="blockUser()" class="text-lg interactive-btn text-white opacity-75">üö´</button>
                </div>
                
                <!-- Messages -->
                <div class="flex-1 overflow-y-auto p-4 space-y-4" id="conversationMessages">
                    <!-- Les messages seront charg√©s ici -->
                </div>
                
                <!-- Zone de saisie -->
                <div class="p-4 border-t bg-gray-50 rounded-b-3xl">
                    <div class="flex items-center space-x-3">
                        <input type="text" id="messageInput" placeholder="√âcris ton message..." 
                               class="flex-1 px-4 py-3 border border-gray-200 rounded-2xl focus:border-purple-500 focus:outline-none text-sm"
                               onkeypress="handleMessageKeyPress(event)">
                        <button onclick="sendMessage()" class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl flex items-center justify-center interactive-btn">
                            <span class="text-lg">üì§</span>
                        </button>
                    </div>
                    <div class="flex items-center justify-between mt-3">
                        <div class="flex space-x-2">
                            <button onclick="addEmoji('üôè')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">üôè</button>
                            <button onclick="addEmoji('‚ù§Ô∏è')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">‚ù§Ô∏è</button>
                            <button onclick="addEmoji('‚ú®')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">‚ú®</button>
                            <button onclick="addEmoji('üïäÔ∏è')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">üïäÔ∏è</button>
                        </div>
                        <button onclick="shareVerse()" class="text-xs text-purple-600 font-medium interactive-btn">üìñ Partager un verset</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Bataille Biblique -->
        <div id="battleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">‚öîÔ∏è Bataille Biblique</h3>
                    <button onclick="closeBattleModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="battleContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">‚öîÔ∏è</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Manche: <span id="battleRound" class="font-bold text-orange-600">1</span>/5</div>
                            <div>Score: <span id="battleScore" class="font-bold text-green-600">0</span></div>
                            <div>Temps: <span id="battleTimer" class="font-bold text-red-600">10s</span></div>
                        </div>
                        <div class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-xl p-3 mb-4">
                            <p class="text-xs mb-1">üèÜ Adversaire: <strong>David_Foi</strong></p>
                            <div class="flex items-center justify-between">
                                <div class="text-center">
                                    <div class="text-lg font-bold">0</div>
                                    <div class="text-xs">Toi</div>
                                </div>
                                <div class="text-2xl">‚öîÔ∏è</div>
                                <div class="text-center">
                                    <div class="text-lg font-bold">0</div>
                                    <div class="text-xs">David_Foi</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3 text-center" id="battleQuestion">Qui a construit l'arche de No√© ?</h4>
                        <div class="space-y-2" id="battleOptions">
                            <button onclick="selectBattleAnswer(0)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                A) Mo√Øse
                            </button>
                            <button onclick="selectBattleAnswer(1)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                B) No√©
                            </button>
                            <button onclick="selectBattleAnswer(2)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                C) Abraham
                            </button>
                            <button onclick="selectBattleAnswer(3)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                D) David
                            </button>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="restartBattle()" class="bg-orange-600 text-white px-4 py-2 rounded-xl text-sm interactive-btn hover:glow">
                            üîÑ Nouvelle bataille
                        </button>
                    </div>
                </div>
                
                <div id="battleResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="battleResultIcon">üèÜ</div>
                    <h4 class="text-lg font-semibold mb-2" id="battleResultText">Victoire !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-green-600" id="finalBattleScore">3</div>
                                <div class="text-xs text-gray-500">Tes points</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-red-600" id="opponentScore">2</div>
                                <div class="text-xs text-gray-500">Adversaire</div>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="findNewOpponent()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üîç Nouvel adversaire
                        </button>
                        <button onclick="restartBattle()" class="w-full bg-orange-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üîÑ Rejouer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Myst√®res Bibliques -->
        <div id="mysteryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">üé≠ Myst√®res Bibliques</h3>
                    <button onclick="closeMysteryModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="mysteryContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">üîç</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Myst√®re: <span id="mysteryNumber" class="font-bold text-indigo-600">1</span>/25</div>
                            <div>Score: <span id="mysteryScore" class="font-bold text-green-600">0</span></div>
                            <div>Indices: <span id="mysteryHints" class="font-bold text-blue-600">3</span></div>
                        </div>
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-4 mb-4">
                            <h4 class="font-bold mb-2">üîÆ Myst√®re √† r√©soudre</h4>
                            <p class="text-sm" id="mysteryQuestion">Je suis celui qui a √©t√© vendu par ses fr√®res pour 20 pi√®ces d'argent. Mes r√™ves ont pr√©dit l'avenir et j'ai sauv√© l'√âgypte de la famine. Qui suis-je ?</p>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <input type="text" id="mysteryAnswer" placeholder="Tape ta r√©ponse..." 
                               class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:outline-none text-center font-medium"
                               onkeypress="handleMysteryKeyPress(event)">
                    </div>
                    
                    <div class="space-y-3 mb-4">
                        <button onclick="checkMysteryAnswer()" class="w-full bg-indigo-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üîç V√©rifier la r√©ponse
                        </button>
                        <button onclick="getMysteryHint()" class="w-full bg-blue-100 text-blue-700 py-3 rounded-xl interactive-btn" id="hintBtn">
                            üí° Demander un indice (3 restants)
                        </button>
                    </div>
                    
                    <!-- Zone des indices -->
                    <div id="hintsContainer" class="space-y-2 mb-4 hidden">
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                            <h5 class="font-semibold text-yellow-800 mb-1">üí° Indices r√©v√©l√©s :</h5>
                            <div id="hintsList" class="space-y-1 text-sm text-yellow-700">
                                <!-- Les indices appara√Ætront ici -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="skipMystery()" class="bg-gray-100 text-gray-600 px-4 py-2 rounded-xl text-sm interactive-btn">
                            ‚è≠Ô∏è Passer ce myst√®re
                        </button>
                    </div>
                </div>
                
                <div id="mysteryResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="mysteryResultIcon">üéâ</div>
                    <h4 class="text-lg font-semibold mb-2" id="mysteryResultText">Myst√®re r√©solu !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-indigo-600" id="finalMysteryScore">0</div>
                                <div class="text-xs text-gray-500">Points gagn√©s</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-green-600" id="mysteryTime">0s</div>
                                <div class="text-xs text-gray-500">Temps pris</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <p class="text-sm text-gray-700" id="mysteryExplanation">Joseph √©tait le fils de Jacob, vendu par ses fr√®res jaloux. Ses dons d'interpr√©tation des r√™ves l'ont men√© √† devenir vice-roi d'√âgypte.</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="nextMystery()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üîç Myst√®re suivant
                        </button>
                        <button onclick="restartMysteryGame()" class="w-full bg-indigo-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üîÑ Recommencer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Tournoi des Proph√®tes -->
        <div id="tournamentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">üèÜ Tournoi des Proph√®tes</h3>
                    <button onclick="closeTournamentModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="tournamentContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">üèÜ</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Manche: <span id="tournamentRound" class="font-bold text-purple-600">1</span>/10</div>
                            <div>Score: <span id="tournamentScore" class="font-bold text-green-600">0</span></div>
                            <div>Temps: <span id="tournamentTimer" class="font-bold text-red-600">15s</span></div>
                        </div>
                        <div class="bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-xl p-3 mb-4">
                            <p class="text-xs mb-1">üåç Classement mondial</p>
                            <div class="flex items-center justify-center">
                                <div class="text-center">
                                    <div class="text-lg font-bold" id="playerRank">156</div>
                                    <div class="text-xs">Ton rang</div>
                                </div>
                                <div class="text-2xl mx-4">üèÜ</div>
                                <div class="text-center">
                                    <div class="text-lg font-bold">2,847</div>
                                    <div class="text-xs">Participants</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3 text-center" id="tournamentQuestion">Qui √©tait le plus jeune des fils de Jacob ?</h4>
                        <div class="space-y-2" id="tournamentOptions">
                            <button onclick="selectTournamentAnswer(0)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                A) Joseph
                            </button>
                            <button onclick="selectTournamentAnswer(1)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                B) Benjamin
                            </button>
                            <button onclick="selectTournamentAnswer(2)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                C) Dan
                            </button>
                            <button onclick="selectTournamentAnswer(3)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                D) Nephtali
                            </button>
                        </div>
                    </div>
                    
                    <!-- Classement en temps r√©el -->
                    <div class="bg-gray-50 rounded-xl p-4">
                        <h5 class="font-semibold text-gray-800 mb-3 text-center">üèÖ Top 5 en direct</h5>
                        <div class="space-y-2" id="tournamentLeaderboard">
                            <div class="flex items-center justify-between text-sm">
                                <div class="flex items-center">
                                    <span class="text-yellow-500 mr-2">ü•á</span>
                                    <span class="font-medium">David_Proph√®te</span>
                                </div>
                                <span class="font-bold text-purple-600">2,450 pts</span>
                            </div>
                            <div class="flex items-center justify-between text-sm">
                                <div class="flex items-center">
                                    <span class="text-gray-400 mr-2">ü•à</span>
                                    <span class="font-medium">Marie_Sagesse</span>
                                </div>
                                <span class="font-bold text-purple-600">2,380 pts</span>
                            </div>
                            <div class="flex items-center justify-between text-sm">
                                <div class="flex items-center">
                                    <span class="text-orange-500 mr-2">ü•â</span>
                                    <span class="font-medium">Paul_V√©rit√©</span>
                                </div>
                                <span class="font-bold text-purple-600">2,290 pts</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="tournamentResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="tournamentResultIcon">üèÜ</div>
                    <h4 class="text-lg font-semibold mb-2" id="tournamentResultText">Tournoi termin√© !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-purple-600" id="finalTournamentScore">0</div>
                                <div class="text-xs text-gray-500">Points totaux</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-blue-600" id="finalTournamentRank">0</div>
                                <div class="text-xs text-gray-500">Classement final</div>
                            </div>
                        </div>
                        <div class="mt-3 text-center">
                            <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-bold" id="tournamentReward">+50 XP</span>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="joinNewTournament()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üéØ Nouveau tournoi
                        </button>
                        <button onclick="restartTournament()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            üîÑ Rejouer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal des Indices -->
        <div id="insightsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800 flex items-center">
                        <span class="text-2xl mr-2">üìä</span>
                        Indices d'activit√©
                    </h3>
                    <button onclick="closeInsightsModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        √ó
                    </button>
                </div>
                
                <!-- Statistiques g√©n√©rales -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-4 mb-6 border border-purple-100">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">üìà</span>
                        Statistiques du lien
                    </h4>
                    <div class="grid grid-cols-3 gap-3">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-600" id="insightViews">24</div>
                            <div class="text-xs text-gray-600">Vues</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600" id="insightClicks">12</div>
                            <div class="text-xs text-gray-600">Clics</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600" id="insightResponses">5</div>
                            <div class="text-xs text-gray-600">R√©ponses</div>
                        </div>
                    </div>
                </div>
                
                <!-- Indices des visiteurs -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">üë•</span>
                        Qui a vu ton lien
                    </h4>
                    <div class="space-y-3" id="visitorsInsights">
                        <!-- Contenu g√©n√©r√© dynamiquement -->
                    </div>
                </div>
                
                <!-- Indices des r√©pondants -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">üí¨</span>
                        Qui t'a envoy√© un message
                    </h4>
                    <div class="space-y-3" id="respondersInsights">
                        <!-- Contenu g√©n√©r√© dynamiquement -->
                    </div>
                </div>
                
                <!-- Graphique temporel -->
                <div class="bg-gray-50 rounded-2xl p-4">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">‚è∞</span>
                        Activit√© dans le temps
                    </h4>
                    <div class="flex items-end justify-between h-20 mb-2">
                        <div class="bg-purple-300 w-4 rounded-t" style="height: 30%"></div>
                        <div class="bg-purple-400 w-4 rounded-t" style="height: 60%"></div>
                        <div class="bg-purple-500 w-4 rounded-t" style="height: 80%"></div>
                        <div class="bg-purple-600 w-4 rounded-t" style="height: 100%"></div>
                        <div class="bg-purple-400 w-4 rounded-t" style="height: 45%"></div>
                        <div class="bg-purple-300 w-4 rounded-t" style="height: 25%"></div>
                        <div class="bg-purple-200 w-4 rounded-t" style="height: 15%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>Lun</span>
                        <span>Mar</span>
                        <span>Mer</span>
                        <span>Jeu</span>
                        <span>Ven</span>
                        <span>Sam</span>
                        <span>Dim</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Parcours Spirituel -->
        <div id="spiritualJourneyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">üåü Parcours Spirituel</h3>
                    <button onclick="closeSpiritualJourneyModal()" class="text-2xl text-gray-400 interactive-btn">√ó</button>
                </div>
                
                <div id="journeyContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">üó∫Ô∏è</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Jour: <span id="journeyDay" class="font-bold text-emerald-600">1</span>/40</div>
                            <div>√âtapes: <span id="journeySteps" class="font-bold text-blue-600">0</span>/5</div>
                            <div>XP: <span id="journeyXP" class="font-bold text-purple-600">0</span></div>
                        </div>
                        <!-- S√©lecteur de parcours -->
                        <div class="mb-4">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">üìö Choisir un parcours</h4>
                                <button onclick="showJourneySelector()" class="text-sm text-purple-600 font-medium interactive-btn">
                                    Changer
                                </button>
                            </div>
                            <div class="bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl p-3 mb-2" id="currentJourneyCard">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-bold text-sm" id="currentJourneyTitle">üå± Les Fondations</h5>
                                        <p class="text-xs opacity-90" id="currentJourneySubtitle">Parcours spirituel de base</p>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-lg font-bold" id="currentJourneyProgress">1/40</div>
                                        <div class="text-xs opacity-75">jours</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl p-4 mb-4" id="dailyThemeCard">
                            <h4 class="font-bold mb-2" id="journeyTitle">üå± Jour 1 : Les Fondations</h4>
                            <p class="text-sm" id="journeyDescription">Aujourd'hui, nous posons les bases de ton parcours spirituel. D√©couvre les piliers de la foi chr√©tienne.</p>
                        </div>
                        
                        <!-- Barre de progression du jour -->
                        <div class="mb-4">
                            <div class="flex items-center justify-between text-xs text-gray-600 mb-1">
                                <span>Progression du jour</span>
                                <span id="journeyProgress">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-emerald-500 to-teal-600 h-2 rounded-full transition-all duration-300" style="width: 0%" id="journeyProgressBar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- √âtapes du jour -->
                    <div class="space-y-3 mb-6" id="journeyStepsContainer">
                        <div class="flex items-center p-3 bg-emerald-50 rounded-xl border border-emerald-200 cursor-pointer hover:bg-emerald-100 transition-all" onclick="completeJourneyStep(1)">
                            <div class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span id="step1Icon">1</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-emerald-800 text-sm">üìñ Lire Jean 3:16</p>
                                <p class="text-xs text-emerald-600">M√©dite sur l'amour de Dieu</p>
                            </div>
                            <div class="text-emerald-600" id="step1Status">‚è≥</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>2</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">üôè Prier 5 minutes</p>
                                <p class="text-xs text-gray-500">Parle √† Dieu de ton c≈ìur</p>
                            </div>
                            <div class="text-gray-400">üîí</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>3</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">‚úçÔ∏è √âcrire une gratitude</p>
                                <p class="text-xs text-gray-500">Note une chose pour laquelle tu es reconnaissant</p>
                            </div>
                            <div class="text-gray-400">üîí</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>4</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">üíù Acte de bont√©</p>
                                <p class="text-xs text-gray-500">Fais quelque chose de gentil pour quelqu'un</p>
                            </div>
                            <div class="text-gray-400">üîí</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>5</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">üéØ R√©flexion du jour</p>
                                <p class="text-xs text-gray-500">R√©ponds √† la question de r√©flexion</p>
                            </div>
                            <div class="text-gray-400">üîí</div>
                        </div>
                    </div>
                    
                    <!-- R√©compenses du jour -->
                    <div class="bg-yellow-50 rounded-xl p-4 border border-yellow-200 mb-4">
                        <h5 class="font-semibold text-yellow-800 mb-2 flex items-center">
                            <span class="text-lg mr-2">üèÜ</span>
                            R√©compenses du jour
                        </h5>
                        <div class="grid grid-cols-3 gap-2">
                            <div class="text-center">
                                <div class="text-lg">üåü</div>
                                <div class="text-xs text-yellow-700">+50 XP</div>
                            </div>
                            <div class="text-center">
                                <div class="text-lg">üéñÔ∏è</div>
                                <div class="text-xs text-yellow-700">Badge Fondation</div>
                            </div>
                            <div class="text-center">
                                <div class="text-lg">üìú</div>
                                <div class="text-xs text-yellow-700">Verset du jour</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="viewJourneyCalendar()" class="bg-emerald-100 text-emerald-700 px-4 py-2 rounded-xl text-sm interactive-btn mr-2">
                            üìÖ Voir le calendrier
                        </button>
                        <button onclick="viewJourneyStats()" class="bg-blue-100 text-blue-700 px-4 py-2 rounded-xl text-sm interactive-btn">
                            üìä Mes statistiques
                        </button>
                    </div>
                </div>
                
                <!-- Vue Calendrier -->
                <div id="journeyCalendar" class="hidden">
                    <div class="text-center mb-4">
                        <h4 class="font-semibold text-gray-800 mb-2">üìÖ Calendrier du Parcours</h4>
                        <p class="text-sm text-gray-600">40 jours de croissance spirituelle</p>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1 mb-4">
                        <!-- En-t√™tes des jours -->
                        <div class="text-center text-xs font-medium text-gray-500 p-2">L</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">M</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">M</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">J</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">V</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">S</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">D</div>
                        
                        <!-- Jours du calendrier -->
                        <div class="aspect-square bg-green-500 rounded-lg flex items-center justify-center text-white text-xs font-bold">1</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">2</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">3</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">4</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">5</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">6</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">7</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">8</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">9</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">10</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">11</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">12</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">13</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">14</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">15</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">16</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">17</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">18</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">19</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">20</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">21</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">22</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">23</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">24</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">25</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">26</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">27</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">28</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">29</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">30</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">31</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">32</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">33</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">34</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">35</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">36</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">37</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">38</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">39</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">40</div>
                    </div>
                    
                    <div class="flex items-center justify-center space-x-4 text-xs mb-4">
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-green-500 rounded mr-1"></div>
                            <span>Termin√©</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-yellow-500 rounded mr-1"></div>
                            <span>En cours</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-gray-200 rounded mr-1"></div>
                            <span>√Ä venir</span>
                        </div>
                    </div>
                    
                    <button onclick="backToJourney()" class="w-full bg-emerald-600 text-white py-3 rounded-xl interactive-btn">
                        ‚Üê Retour au jour actuel
                    </button>
                </div>
                
                <!-- Vue Statistiques -->
                <div id="journeyStats" class="hidden">
                    <div class="text-center mb-4">
                        <h4 class="font-semibold text-gray-800 mb-2">üìä Tes Statistiques</h4>
                        <p class="text-sm text-gray-600">Progression de ton parcours spirituel</p>
                    </div>
                    
                    <div class="space-y-4 mb-6">
                        <div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-4 border border-emerald-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-emerald-800">Jours compl√©t√©s</span>
                                <span class="text-lg font-bold text-emerald-600">1/40</span>
                            </div>
                            <div class="w-full bg-emerald-200 rounded-full h-2">
                                <div class="bg-emerald-500 h-2 rounded-full" style="width: 2.5%"></div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-purple-800">XP Total</span>
                                <span class="text-lg font-bold text-purple-600">0</span>
                            </div>
                            <div class="text-xs text-purple-600">Niveau 1 ‚Ä¢ 0/100 XP pour le niveau suivant</div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-blue-50 rounded-xl p-3 border border-blue-200 text-center">
                                <div class="text-2xl font-bold text-blue-600">0</div>
                                <div class="text-xs text-blue-700">Badges gagn√©s</div>
                            </div>
                            <div class="bg-yellow-50 rounded-xl p-3 border border-yellow-200 text-center">
                                <div class="text-2xl font-bold text-yellow-600">0</div>
                                <div class="text-xs text-yellow-700">S√©rie actuelle</div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-xl p-4">
                            <h5 class="font-semibold text-gray-800 mb-3">üèÜ Badges disponibles</h5>
                            <div class="grid grid-cols-4 gap-2">
                                <div class="text-center opacity-50">
                                    <div class="text-2xl">üå±</div>
                                    <div class="text-xs text-gray-600">Fondation</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">üôè</div>
                                    <div class="text-xs text-gray-600">Pri√®re</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">üìñ</div>
                                    <div class="text-xs text-gray-600">Lecture</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">üíù</div>
                                    <div class="text-xs text-gray-600">Service</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">üî•</div>
                                    <div class="text-xs text-gray-600">Passion</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">üïäÔ∏è</div>
                                    <div class="text-xs text-gray-600">Paix</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">‚≠ê</div>
                                    <div class="text-xs text-gray-600">Fid√©lit√©</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">üëë</div>
                                    <div class="text-xs text-gray-600">Ma√Ætre</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="backToJourney()" class="w-full bg-emerald-600 text-white py-3 rounded-xl interactive-btn">
                        ‚Üê Retour au jour actuel
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal S√©lecteur de Parcours -->
        <div id="journeySelectorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800">üìö Choisir un Parcours</h3>
                    <button onclick="closeJourneySelector()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        √ó
                    </button>
                </div>
                
                <div class="space-y-4" id="journeyOptions">
                    <!-- Parcours 1: Les Fondations -->
                    <div class="journey-option bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-2xl p-4 cursor-pointer hover:shadow-lg transition-all" onclick="selectJourney(1)">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    üå±
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800">Les Fondations</h4>
                                    <p class="text-xs text-gray-600">Parcours spirituel de base</p>
                                </div>
                            </div>
                            <div class="text-emerald-600 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">D√©couvre les piliers essentiels de la foi chr√©tienne en 40 jours</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-600">
                                <span class="mr-3">üèÜ 8 badges</span>
                                <span>‚≠ê Niveau d√©butant</span>
                            </div>
                            <div class="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-xs font-bold">
                                En cours
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parcours 2: La Vie de J√©sus -->
                    <div class="journey-option bg-gradient-to-br from-blue-50 to-purple-50 border-2 border-blue-200 rounded-2xl p-4 cursor-pointer hover:shadow-lg transition-all" onclick="selectJourney(2)">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    ‚úùÔ∏è
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800">La Vie de J√©sus</h4>
                                    <p class="text-xs text-gray-600">Suivre les pas du Sauveur</p>
                                </div>
                            </div>
                            <div class="text-blue-600 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">D√©couvre la vie, les enseignements et l'≈ìuvre de J√©sus-Christ en 40 jours</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-600">
                                <span class="mr-3">üèÜ 10 badges</span>
                                <span>‚≠ê Niveau interm√©diaire</span>
                            </div>
                            <div class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                                üîí D√©bloqu√© apr√®s Fondations
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parcours 3: La Vie de Joseph -->
                    <div class="journey-option bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-2xl p-4 cursor-pointer hover:shadow-lg transition-all" onclick="selectJourney(3)">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gradient-to-r from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    üåà
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800">La Vie de Joseph</h4>
                                    <p class="text-xs text-gray-600">De l'√©preuve √† la gloire</p>
                                </div>
                            </div>
                            <div class="text-yellow-600 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">D√©couvre l'histoire inspirante de Joseph, de ses r√™ves √† son r√®gne en √âgypte</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-600">
                                <span class="mr-3">üèÜ 12 badges</span>
                                <span>‚≠ê Niveau avanc√©</span>
                            </div>
                            <div class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                                üîí D√©bloqu√© apr√®s J√©sus
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parcours √† venir -->
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 rounded-2xl p-4 opacity-60">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gray-400 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    üîÆ
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-600">Parcours √† venir</h4>
                                    <p class="text-xs text-gray-500">Bient√¥t disponible</p>
                                </div>
                            </div>
                            <div class="text-gray-500 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">D'autres parcours passionnants arrivent bient√¥t !</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-500">
                                <span class="mr-3">üèÜ ? badges</span>
                                <span>‚≠ê Tous niveaux</span>
                            </div>
                            <div class="bg-gray-200 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                                üöß En d√©veloppement
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <p class="text-xs text-gray-500 mb-3">üí° Conseil : Termine un parcours pour d√©bloquer le suivant</p>
                    <button onclick="closeJourneySelector()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-xl text-sm font-medium">
                        Fermer
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal de R√©ponse -->
        <div id="replyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl max-w-sm w-full max-h-[80vh] flex flex-col shadow-2xl">
                <!-- Header -->
                <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-t-3xl">
                    <button onclick="closeReplyModal()" class="text-2xl mr-4 interactive-btn text-white">‚Üê</button>
                    <div class="flex items-center flex-1">
                        <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-lg mr-3" id="replyUserAvatar">
                            üë§
                        </div>
                        <div>
                            <h3 class="font-semibold" id="replyUserName">Anonyme #1</h3>
                            <p class="text-xs opacity-75">Message re√ßu</p>
                        </div>
                    </div>
                </div>
                
                <!-- Message original -->
                <div class="p-4 bg-gray-50 border-b">
                    <div class="bg-white rounded-xl p-3 border border-gray-200">
                        <div class="flex items-center mb-2">
                            <span class="bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-xs font-medium" id="replyMessageType">üôè Pri√®re</span>
                            <span class="text-xs text-gray-500 ml-2" id="replyMessageTime">14:32</span>
                        </div>
                        <p class="text-sm text-gray-800" id="replyOriginalMessage">
                            "Peux-tu prier pour mon examen demain ? J'ai besoin de force üôè"
                        </p>
                    </div>
                </div>
                
                <!-- Zone de r√©ponse -->
                <div class="flex-1 p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">üí¨ Ta r√©ponse</h4>
                    <textarea id="replyTextarea" placeholder="√âcris ta r√©ponse encourageante..." 
                              class="w-full h-32 px-4 py-3 border border-gray-200 rounded-2xl focus:border-purple-500 focus:outline-none text-sm resize-none"
                              maxlength="500"></textarea>
                    <div class="flex items-center justify-between mt-2">
                        <span class="text-xs text-gray-500"><span id="replyCharCount">0</span>/500 caract√®res</span>
                        <div class="flex space-x-2">
                            <button onclick="addReplyEmoji('üôè')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">üôè</button>
                            <button onclick="addReplyEmoji('‚ù§Ô∏è')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">‚ù§Ô∏è</button>
                            <button onclick="addReplyEmoji('‚ú®')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">‚ú®</button>
                            <button onclick="addReplyEmoji('üí™')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">üí™</button>
                        </div>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="p-4 border-t bg-gray-50 rounded-b-3xl">
                    <div class="space-y-3">
                        <!-- R√©ponses rapides -->
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setQuickReply('Je prie pour toi ! üôè Que Dieu te donne la force et la sagesse.')" 
                                    class="bg-blue-100 text-blue-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                üôè Je prie pour toi
                            </button>
                            <button onclick="setQuickReply('Que Dieu te b√©nisse ! ‚ú® Tu peux compter sur mes pri√®res.')" 
                                    class="bg-green-100 text-green-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                ‚ú® B√©n√©dictions
                            </button>
                            <button onclick="setQuickReply('Courage ! üí™ Dieu est avec toi dans cette √©preuve.')" 
                                    class="bg-orange-100 text-orange-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                üí™ Courage
                            </button>
                            <button onclick="setQuickReply('Amen ! üïäÔ∏è Que la paix de Dieu soit avec toi.')" 
                                    class="bg-purple-100 text-purple-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                üïäÔ∏è Paix
                            </button>
                        </div>
                        
                        <!-- Boutons d'action -->
                        <div class="space-y-3">
                            <div class="flex space-x-3">
                                <button onclick="sendReply()" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-3 rounded-2xl interactive-btn">
                                    üì§ Envoyer la r√©ponse
                                </button>
                                <button onclick="startPrivateChat()" class="bg-blue-100 text-blue-700 px-4 py-3 rounded-2xl interactive-btn">
                                    üí¨
                                </button>
                            </div>
                            
                            <!-- Nouveau bouton pour g√©n√©rer le template -->
                            <button onclick="generateReplyTemplateFromModal()" class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white font-semibold py-3 rounded-2xl interactive-btn">
                                üì∏ Cr√©er template pour statut
                            </button>
                        </div>
                        
                        <!-- Option de discussion priv√©e -->
                        <div class="text-center">
                            <button onclick="startPrivateChat()" class="text-sm text-blue-600 font-medium interactive-btn">
                                üí¨ Commencer une discussion priv√©e
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de G√©n√©ration de Template -->
        <div id="templateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl max-w-sm w-full max-h-[90vh] flex flex-col shadow-2xl">
                <!-- Header -->
                <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-t-3xl">
                    <button onclick="closeTemplateModal()" class="text-2xl mr-4 interactive-btn text-white">‚Üê</button>
                    <div class="flex-1">
                        <h3 class="font-semibold">üì∏ Template de R√©ponse</h3>
                        <p class="text-xs opacity-75">Pr√™t √† partager sur ton statut</p>
                    </div>
                </div>
                
                <!-- Template Preview -->
                <div class="flex-1 p-4 bg-gray-50">
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden mb-4" id="templatePreview">
                        <!-- Template sera g√©n√©r√© ici -->
                    </div>
                    
                    <!-- Informations -->
                    <div class="bg-blue-50 rounded-xl p-3 mb-4 border border-blue-200">
                        <div class="flex items-center mb-2">
                            <span class="text-lg mr-2">üí°</span>
                            <h4 class="font-semibold text-blue-800 text-sm">Comment utiliser</h4>
                        </div>
                        <div class="space-y-1 text-xs text-blue-700">
                            <p>‚Ä¢ Sauvegarde cette image sur ton t√©l√©phone</p>
                            <p>‚Ä¢ Partage-la sur ton statut WhatsApp/Instagram</p>
                            <p>‚Ä¢ Tes amis pourront voir ta r√©ponse et ton lien</p>
                        </div>
                    </div>
                    
                    <!-- Lien personnel -->
                    <div class="bg-purple-50 rounded-xl p-3 border border-purple-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-purple-800 text-sm">üîó Ton lien PrayLink</span>
                            <button onclick="copyPersonalLink()" class="text-purple-600 text-xs font-medium interactive-btn">üìã Copier</button>
                        </div>
                        <input type="text" id="personalLink" class="w-full text-xs text-purple-600 bg-transparent border-none outline-none" readonly>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="p-4 border-t bg-gray-50 rounded-b-3xl">
                    <div class="space-y-3">
                        <button onclick="downloadTemplate()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-3 rounded-2xl interactive-btn">
                            üì± T√©l√©charger l'image
                        </button>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="shareToWhatsAppStatus()" class="bg-green-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 interactive-btn">
                                <span class="text-lg">üì±</span>
                                <span class="text-sm">WhatsApp</span>
                            </button>
                            
                            <button onclick="shareToInstagramStory()" class="bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 interactive-btn">
                                <span class="text-lg">üì∑</span>
                                <span class="text-sm">Instagram</span>
                            </button>
                        </div>
                        
                        <button onclick="closeTemplateModal()" class="w-full bg-gray-200 text-gray-700 font-medium py-3 rounded-xl interactive-btn">
                            Fermer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Envoyer Verset -->
        <div id="sendVersetModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800">üíå Envoyer un Verset</h3>
                    <button onclick="closeSendVersetModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        √ó
                    </button>
                </div>
                
                <!-- Aper√ßu du verset -->
                <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-4 mb-6 border border-blue-100">
                    <div class="text-center">
                        <div class="text-3xl mb-3">üìñ</div>
                        <p class="text-sm font-medium italic text-gray-700 mb-2" id="sendVersetText">"Car Dieu a tant aim√© le monde..."</p>
                        <p class="text-xs text-blue-600 font-bold" id="sendVersetRef">Jean 3:16</p>
                    </div>
                </div>
                
                <!-- Formulaire d'envoi -->
                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">üì± Num√©ro de t√©l√©phone ou email</label>
                        <input type="text" id="recipientContact" placeholder="06 12 34 56 78 ou email@exemple.com" 
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none text-sm">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">üí¨ Message personnel (optionnel)</label>
                        <textarea id="personalMessage" placeholder="Ajoute un message personnel..." 
                                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none text-sm resize-none h-20"
                                  maxlength="200"></textarea>
                        <div class="text-xs text-gray-500 mt-1">
                            <span id="messageCharCount">0</span>/200 caract√®res
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">üé® Choisir un style</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="selectVersetStyle('classic')" class="p-3 border-2 border-blue-200 rounded-xl text-center hover:border-blue-500 transition-all" id="styleClassic">
                                <div class="text-lg mb-1">üìú</div>
                                <div class="text-xs">Classique</div>
                            </button>
                            <button onclick="selectVersetStyle('modern')" class="p-3 border-2 border-gray-200 rounded-xl text-center hover:border-blue-500 transition-all" id="styleModern">
                                <div class="text-lg mb-1">‚ú®</div>
                                <div class="text-xs">Moderne</div>
                            </button>
                            <button onclick="selectVersetStyle('elegant')" class="p-3 border-2 border-gray-200 rounded-xl text-center hover:border-blue-500 transition-all" id="styleElegant">
                                <div class="text-lg mb-1">üåü</div>
                                <div class="text-xs">√âl√©gant</div>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Boutons d'action -->
                <div class="space-y-3">
                    <button onclick="sendVersetNow()" class="w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold py-4 rounded-2xl hover:shadow-lg transition-all">
                        üì§ Envoyer le verset
                    </button>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="previewVersetMessage()" class="bg-blue-100 text-blue-700 font-medium py-3 rounded-xl hover:bg-blue-200 transition-all">
                            üëÄ Aper√ßu
                        </button>
                        <button onclick="saveVersetDraft()" class="bg-gray-100 text-gray-700 font-medium py-3 rounded-xl hover:bg-gray-200 transition-all">
                            üíæ Brouillon
                        </button>
                    </div>
                </div>
                
                <!-- Contacts sugg√©r√©s -->
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">üë• Contacts sugg√©r√©s</h4>
                    <div class="space-y-2">
                        <button onclick="selectSuggestedContact('Marie', '06 12 34 56 78')" class="w-full flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all text-left">
                            <div class="w-8 h-8 bg-pink-100 rounded-full flex items-center justify-center text-sm mr-3">üå∏</div>
                            <div>
                                <p class="text-sm font-medium text-gray-800">Marie</p>
                                <p class="text-xs text-gray-500">06 12 34 56 78</p>
                            </div>
                        </button>
                        <button onclick="selectSuggestedContact('Paul', 'paul@email.com')" class="w-full flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all text-left">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm mr-3">‚ö°</div>
                            <div>
                                <p class="text-sm font-medium text-gray-800">Paul</p>
                                <p class="text-xs text-gray-500">paul@email.com</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Premium Upgrade -->
        <div id="premiumUpgradeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800 flex items-center">
                        <span class="text-2xl mr-2">üëë</span>
                        PrayLink Premium
                    </h3>
                    <button onclick="closePremiumModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        √ó
                    </button>
                </div>
                
                <!-- Hero Section -->
                <div class="text-center mb-6">
                    <div class="w-20 h-20 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center text-3xl premium-glow pulse-effect">
                        üëë
                    </div>
                    <h4 class="text-lg font-bold text-gray-800 mb-2">D√©bloquer l'exp√©rience compl√®te</h4>
                    <p class="text-sm text-gray-600">Acc√®de √† tous les jeux premium et fonctionnalit√©s exclusives</p>
                </div>
                
                <!-- Avantages Premium -->
                <div class="space-y-3 mb-6">
                    <div class="flex items-center p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl border border-yellow-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            ‚öîÔ∏è
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">Bataille Biblique</p>
                            <p class="text-xs text-gray-600">D√©fie tes amis en temps r√©el</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            üèÜ
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">Tournoi des Proph√®tes</p>
                            <p class="text-xs text-gray-600">Comp√©tition mondiale</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-3 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl border border-indigo-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            üé≠
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">Myst√®res Bibliques</p>
                            <p class="text-xs text-gray-600">√ânigmes sacr√©es √† r√©soudre</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-3 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border border-emerald-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            üåü
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">Parcours Spirituel</p>
                            <p class="text-xs text-gray-600">Aventure de 40 jours</p>
                        </div>
                    </div>
                </div>
                
                <!-- Prix et CTA -->
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-2xl p-4 mb-4">
                    <div class="text-center">
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-2xl font-bold text-gray-800">4,99‚Ç¨</span>
                            <span class="text-sm text-gray-600 ml-1">/mois</span>
                        </div>
                        <p class="text-xs text-gray-600 mb-3">Annule √† tout moment ‚Ä¢ Essai gratuit 7 jours</p>
                        
                        <button onclick="purchasePremium()" class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold py-4 rounded-2xl premium-glow interactive-btn mb-3">
                            üöÄ Commencer l'essai gratuit
                        </button>
                        
                        <p class="text-xs text-gray-500">Paiement s√©curis√© ‚Ä¢ Sans engagement</p>
                    </div>
                </div>
                
                <!-- T√©moignages -->
                <div class="text-center">
                    <p class="text-xs text-gray-500 mb-2">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê 4.9/5 (2,847 avis)</p>
                    <p class="text-xs text-gray-600 italic">"Les jeux premium ont transform√© ma lecture biblique !" - Marie, 24 ans</p>
                </div>
            </div>
        </div>

    </div>

    <script>
        let currentPage = 'welcomePage';
        let selectedPlatform = '';
        let username = '';
        let profileEmoji = 'üôè';
        let currentQuestionIndex = 0;
        let currentVersetIndex = 0;
        let currentConversation = null;
        let currentFilter = 'all';

        // IMPORTANT: Remplacez cette URL par l'URL de votre script Google Apps Script d√©ploy√©
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbznqEPPRCC79rujx_rKALbzHftiJIZ2WP0-F-jPZ-GDNh6zT0sWCwhyyvNOVdmuR4oiMA/exec';

        // Loader functions
        function showLoader() { document.getElementById('loader').classList.remove('hidden'); document.getElementById('loader').classList.add('flex'); }
        function hideLoader() { document.getElementById('loader').classList.add('hidden'); document.getElementById('loader').classList.remove('flex'); }


        // Donn√©es d'indices d'activit√©
        const insightsData = {
            visitors: [
                {
                    id: 1,
                    avatar: 'üå∏',
                    hint: 'Personne de ton lyc√©e',
                    location: 'Paris, France',
                    time: '14:32',
                    device: 'iPhone',
                    hasResponded: true
                },
                {
                    id: 2,
                    avatar: '‚ö°',
                    hint: 'Ami de ton fr√®re',
                    location: 'Lyon, France',
                    time: '12:15',
                    device: 'Android',
                    hasResponded: false
                },
                {
                    id: 3,
                    avatar: '‚ú®',
                    hint: 'Quelqu\'un de ton √©glise',
                    location: 'Marseille, France',
                    time: '10:45',
                    device: 'iPad',
                    hasResponded: true
                },
                {
                    id: 4,
                    avatar: 'üî•',
                    hint: 'Personne de ta classe',
                    location: 'Toulouse, France',
                    time: '09:20',
                    device: 'iPhone',
                    hasResponded: false
                },
                {
                    id: 5,
                    avatar: 'üíñ',
                    hint: 'Ami proche',
                    location: 'Nice, France',
                    time: '08:30',
                    device: 'Android',
                    hasResponded: true
                }
            ],
            responders: [
                {
                    id: 1,
                    avatar: 'üå∏',
                    hint: 'Personne de ton lyc√©e',
                    message: 'Merci pour cette question, elle me fait r√©fl√©chir...',
                    time: '14:35',
                    sentiment: 'positive'
                },
                {
                    id: 3,
                    avatar: '‚ú®',
                    hint: 'Quelqu\'un de ton √©glise',
                    message: 'Ce verset m\'a beaucoup aid√© cette semaine üôè',
                    time: '10:50',
                    sentiment: 'positive'
                },
                {
                    id: 5,
                    avatar: 'üíñ',
                    hint: 'Ami proche',
                    message: 'J\'aimerais en parler avec toi en priv√©',
                    time: '08:45',
                    sentiment: 'neutral'
                }
            ]
        };

        // Donn√©es des versets partag√©s aujourd'hui
        const todayVerses = [
            {
                id: 1,
                user: 'Marie_2024',
                avatar: 'üå∏',
                time: '14:32',
                verse: 'Car Dieu a tant aim√© le monde qu\'il a donn√© son Fils unique, afin que quiconque croit en lui ne p√©risse point, mais qu\'il ait la vie √©ternelle.',
                reference: 'Jean 3:16',
                message: 'Ce verset me donne tellement d\'espoir aujourd\'hui ! üôè',
                likes: 12,
                comments: 5,
                shares: 3,
                isLiked: false,
                link: 'https://praylink.app/v/marie2024/1'
            },
            {
                id: 2,
                user: 'David_Foi',
                avatar: '‚ö°',
                time: '12:15',
                verse: 'Je puis tout par celui qui me fortifie.',
                reference: 'Philippiens 4:13',
                message: 'Avant mon entretien d\'embauche... Ce verset me donne la force ! üí™',
                likes: 8,
                comments: 3,
                shares: 2,
                isLiked: true,
                link: 'https://praylink.app/v/davidfoi/2'
            },
            {
                id: 3,
                user: 'Sarah_Lumi√®re',
                avatar: '‚ú®',
                time: '10:45',
                verse: 'L\'√âternel est mon berger: je ne manquerai de rien.',
                reference: 'Psaume 23:1',
                message: 'Dans les moments difficiles, ce psaume me rappelle que Dieu pourvoit √† tout üïäÔ∏è',
                likes: 15,
                comments: 7,
                shares: 4,
                isLiked: false,
                link: 'https://praylink.app/v/sarahlumiere/3'
            },
            {
                id: 4,
                user: 'Paul_Espoir',
                avatar: 'üî•',
                time: '09:20',
                verse: 'Et nous savons que toutes choses concourent au bien de ceux qui aiment Dieu.',
                reference: 'Romains 8:28',
                message: 'M√™me dans l\'√©preuve, Dieu a un plan parfait ! üôå',
                likes: 20,
                comments: 9,
                shares: 6,
                isLiked: true,
                link: 'https://praylink.app/v/paulespoir/4'
            },
            {
                id: 5,
                user: 'Emma_Grace',
                avatar: 'üíñ',
                time: '08:30',
                verse: 'Venez √† moi, vous tous qui √™tes fatigu√©s et charg√©s, et je vous donnerai du repos.',
                reference: 'Matthieu 11:28',
                message: 'Pour tous ceux qui sont √©puis√©s... J√©sus nous invite au repos ‚ù§Ô∏è',
                likes: 18,
                comments: 12,
                shares: 8,
                isLiked: false,
                link: 'https://praylink.app/v/emmagrace/5'
            }
        ];

        // Messages de conversation exemple
        const conversationData = {
            'Marie_2024': {
                avatar: 'üå∏',
                status: 'En ligne',
                messages: [
                    { type: 'received', text: 'Salut ! J\'ai vu que tu as aim√© mon verset üòä', time: '14:35' },
                    { type: 'received', text: 'Jean 3:16 me touche vraiment en ce moment', time: '14:35' },
                    { type: 'sent', text: 'Salut Marie ! Oui, ce verset est magnifique üôè', time: '14:37' },
                    { type: 'received', text: 'Tu as un verset qui te parle en ce moment ?', time: '14:38' }
                ]
            }
        };

        // Base de donn√©es de questions infinies
        const questionCategories = {
            versets: [
                'Quel verset biblique te parle aujourd\'hui ?',
                'Envoie-moi ton verset pr√©f√©r√©, anonymement',
                'Quel verset t\'a aid√© √† traverser une √©preuve ?',
                'Si tu devais offrir un verset √† quelqu\'un ce soir ?',
                'Quel verset te donne de l\'espoir ?',
                'Partage un verset qui t\'a marqu√© cette semaine',
                'Quel verset r√©cites-tu quand tu as peur ?',
                'Un verset qui te fait sourire ?',
                'Le verset que tu aimerais graver dans ton c≈ìur ?',
                'Quel verset t\'aide √† pardonner ?',
                'Un verset pour les moments difficiles ?',
                'Le verset qui d√©crit le mieux l\'amour de Dieu ?',
                'Quel verset te rappelle la fid√©lit√© de Dieu ?',
                'Un verset qui t\'encourage √† pers√©v√©rer ?',
                'Le verset qui t\'aide √† avoir confiance ?',
                'Quel verset te parle de la paix ?',
                'Un verset sur la joie qui te touche ?',
                'Le verset qui t\'aide dans tes relations ?',
                'Quel verset te rappelle ta valeur aux yeux de Dieu ?',
                'Un verset qui t\'aide √† g√©rer le stress ?'
            ],
            foi: [
                'Qu\'est-ce que la foi pour toi ?',
                'Comment ta foi a-t-elle grandi cette ann√©e ?',
                'Raconte un moment o√π ta foi a √©t√© test√©e',
                'Qu\'est-ce qui renforce ta foi au quotidien ?',
                'Comment expliques-tu ta foi √† tes amis ?',
                'Quel est ton plus grand d√©fi de foi ?',
                'Comment pries-tu quand tu doutes ?',
                'Qu\'est-ce qui t\'a amen√© √† croire ?',
                'Comment vois-tu Dieu dans ta vie ?',
                'Quel miracle as-tu v√©cu r√©cemment ?',
                'Comment Dieu t\'a-t-il surpris cette semaine ?',
                'Qu\'est-ce que tu aimerais demander √† J√©sus ?',
                'Comment sens-tu la pr√©sence de Dieu ?',
                'Quel est ton t√©moignage en une phrase ?',
                'Comment ta foi influence-t-elle tes choix ?',
                'Qu\'est-ce que tu aimerais voir Dieu faire ?',
                'Comment Dieu t\'a-t-il consol√© r√©cemment ?',
                'Quel aspect de Dieu t\'√©merveille le plus ?',
                'Comment partages-tu ta foi avec les autres ?',
                'Qu\'est-ce que tu apprends sur Dieu en ce moment ?'
            ],
            priere: [
                'Comment pries-tu quand tu es triste ?',
                'Quelle est ta pri√®re du matin ?',
                'Pour quoi pries-tu le plus souvent ?',
                'Comment Dieu a-t-il r√©pondu √† tes pri√®res ?',
                'Quel est ton lieu de pri√®re pr√©f√©r√© ?',
                'Comment pries-tu quand tu es en col√®re ?',
                'Quelle pri√®re t\'a le plus marqu√© ?',
                'Comment pries-tu pour tes amis ?',
                'Qu\'est-ce qui t\'aide √† te concentrer en priant ?',
                'Comment pries-tu dans les transports ?',
                'Quelle est ta pri√®re avant de dormir ?',
                'Comment pries-tu quand tu es stress√© ?',
                'Pour qui aimerais-tu qu\'on prie ?',
                'Comment pries-tu en groupe ?',
                'Quelle pri√®re de la Bible t\'inspire ?',
                'Comment pries-tu quand tu es reconnaissant ?',
                'Qu\'est-ce que tu demandes le plus √† Dieu ?',
                'Comment pries-tu pour ton avenir ?',
                'Quelle est ta pri√®re d\'intercession ?',
                'Comment pries-tu dans la nature ?'
            ],
            personnages: [
                'Quel personnage biblique t\'inspire le plus ?',
                'Si tu pouvais d√Æner avec un personnage biblique ?',
                'Quel personnage biblique te ressemble ?',
                'Quelle femme de la Bible t\'inspire ?',
                'Quel roi de la Bible admires-tu ?',
                'Quel proph√®te aimerais-tu rencontrer ?',
                'Quel disciple de J√©sus te ressemble ?',
                'Quelle histoire biblique te marque ?',
                'Quel personnage biblique a eu le plus de courage ?',
                'Qui dans la Bible a montr√© le plus d\'amour ?',
                'Quel personnage biblique a surmont√© ses peurs ?',
                'Qui dans la Bible t\'apprend la patience ?',
                'Quel personnage biblique a eu la foi la plus forte ?',
                'Qui dans la Bible t\'inspire pour le pardon ?',
                'Quel personnage biblique √©tait le plus fid√®le ?',
                'Qui dans la Bible a montr√© le plus d\'humilit√© ?',
                'Quel personnage biblique t\'apprend la pers√©v√©rance ?',
                'Qui dans la Bible a eu le c≈ìur le plus g√©n√©reux ?',
                'Quel personnage biblique t\'inspire pour servir ?',
                'Qui dans la Bible a montr√© le plus de sagesse ?'
            ],
            vie: [
                'Comment vis-tu ta foi au travail/√©cole ?',
                'Quel d√©fi spirituel traverses-tu ?',
                'Comment Dieu guide-t-il tes d√©cisions ?',
                'Qu\'est-ce que tu aimerais changer dans ta vie ?',
                'Comment g√®res-tu les tentations ?',
                'Qu\'est-ce qui te rapproche de Dieu ?',
                'Comment aides-tu les autres autour de toi ?',
                'Quel fruit de l\'Esprit d√©veloppes-tu ?',
                'Comment g√®res-tu les conflits ?',
                'Qu\'est-ce que tu apprends sur l\'amour ?',
                'Comment pratiques-tu le pardon ?',
                'Quel service rends-tu √† ton √©glise ?',
                'Comment honores-tu tes parents ?',
                'Qu\'est-ce qui te donne de la joie ?',
                'Comment g√®res-tu l\'anxi√©t√© ?',
                'Qu\'est-ce que tu fais pour grandir spirituellement ?',
                'Comment aimes-tu tes ennemis ?',
                'Qu\'est-ce que tu sacrifies pour Dieu ?',
                'Comment utilises-tu tes talents pour Dieu ?',
                'Qu\'est-ce que tu fais pour la justice ?'
            ],
            espoir: [
                'Qu\'est-ce qui te donne de l\'espoir aujourd\'hui ?',
                'Comment vois-tu ton avenir avec Dieu ?',
                'Quel r√™ve as-tu pour le royaume de Dieu ?',
                'Comment Dieu restaure-t-il ta vie ?',
                'Qu\'est-ce que tu attends avec impatience ?',
                'Comment l\'espoir change-t-il ta perspective ?',
                'Quel miracle esp√®res-tu voir ?',
                'Comment encourages-tu les autres ?',
                'Qu\'est-ce qui te motive √† continuer ?',
                'Comment vois-tu Dieu agir dans le monde ?',
                'Quel changement esp√®res-tu voir ?',
                'Comment l\'espoir t\'aide-t-il dans les √©preuves ?',
                'Qu\'est-ce que tu esp√®res apprendre ?',
                'Comment partages-tu l\'espoir avec les autres ?',
                'Quel impact veux-tu avoir ?',
                'Comment l\'espoir influence-t-il tes pri√®res ?',
                'Qu\'est-ce que tu esp√®res pour ta famille ?',
                'Comment l\'espoir change-t-il tes relations ?',
                'Quel h√©ritage spirituel veux-tu laisser ?',
                'Comment l\'espoir t\'aide-t-il √† pardonner ?'
            ]
        };

        const questionEmojis = ['üìñ', 'üôè', 'üíù', '‚ú®', 'üí™', 'üåü', '‚ù§Ô∏è', 'üïäÔ∏è', 'üî•', 'üí´', 'üåà', '‚≠ê', 'üíé', 'üéØ', 'üå∏', 'ü¶ã', 'üåÖ', 'üéµ', 'üèÜ', 'üíñ'];
        const questionColors = [
            'from-blue-500 to-indigo-600',
            'from-purple-500 to-pink-600', 
            'from-green-500 to-teal-600',
            'from-pink-500 to-rose-600',
            'from-yellow-500 to-orange-600',
            'from-indigo-500 to-purple-600',
            'from-amber-500 to-yellow-600',
            'from-blue-400 to-cyan-500',
            'from-violet-500 to-purple-600',
            'from-emerald-500 to-green-600',
            'from-red-500 to-pink-600',
            'from-teal-500 to-cyan-600',
            'from-orange-500 to-red-600',
            'from-lime-500 to-green-600',
            'from-fuchsia-500 to-pink-600',
            'from-sky-500 to-blue-600',
            'from-rose-500 to-pink-600',
            'from-cyan-500 to-teal-600',
            'from-indigo-400 to-purple-500',
            'from-emerald-400 to-teal-500'
        ];

        // Fonction pour g√©n√©rer une question al√©atoire infinie
        function generateInfiniteQuestion() {
            const categories = Object.keys(questionCategories);
            const randomCategory = categories[Math.floor(Math.random() * categories.length)];
            const categoryQuestions = questionCategories[randomCategory];
            const randomQuestion = categoryQuestions[Math.floor(Math.random() * categoryQuestions.length)];
            const randomEmoji = questionEmojis[Math.floor(Math.random() * questionEmojis.length)];
            const randomColor = questionColors[Math.floor(Math.random() * questionColors.length)];
            
            return {
                text: randomQuestion,
                emoji: randomEmoji,
                color: randomColor,
                buttonColor: 'bg-purple-600',
                category: randomCategory
            };
        }

        // Questions actuelles (g√©n√©r√©es dynamiquement)
        let allQuestions = [];
        let totalQuestionsGenerated = 0;

        // Initialiser avec 100 questions
        function initializeQuestions() {
            allQuestions = [];
            for (let i = 0; i < 100; i++) {
                allQuestions.push(generateInfiniteQuestion());
                totalQuestionsGenerated++;
            }
        }

        // Versets bibliques
        const allVersets = [
            { text: "Car Dieu a tant aim√© le monde qu'il a donn√© son Fils unique, afin que quiconque croit en lui ne p√©risse point, mais qu'il ait la vie √©ternelle.", ref: "Jean 3:16" },
            { text: "Je puis tout par celui qui me fortifie.", ref: "Philippiens 4:13" },
            { text: "L'√âternel est mon berger: je ne manquerai de rien.", ref: "Psaume 23:1" },
            { text: "Cherchez premi√®rement le royaume et la justice de Dieu; et toutes ces choses vous seront donn√©es par-dessus.", ref: "Matthieu 6:33" },
            { text: "Car mes pens√©es ne sont pas vos pens√©es, et vos voies ne sont pas mes voies, dit l'√âternel.", ref: "√âsa√Øe 55:8" },
            { text: "Venez √† moi, vous tous qui √™tes fatigu√©s et charg√©s, et je vous donnerai du repos.", ref: "Matthieu 11:28" },
            { text: "Et nous savons que toutes choses concourent au bien de ceux qui aiment Dieu.", ref: "Romains 8:28" },
            { text: "Que votre c≈ìur ne se trouble point. Croyez en Dieu, et croyez en moi.", ref: "Jean 14:1" },
            { text: "L'√âternel combattra pour vous; et vous, gardez le silence.", ref: "Exode 14:14" },
            { text: "Car l√† o√π deux ou trois sont assembl√©s en mon nom, je suis au milieu d'eux.", ref: "Matthieu 18:20" }
        ];

        // Quiz data
        let quizData = {
            questions: [
                {
                    question: "Qui a construit l'arche ?",
                    options: ["A) Mo√Øse", "B) No√©", "C) Abraham", "D) David"],
                    correct: 1
                },
                {
                    question: "Combien de disciples J√©sus avait-il ?",
                    options: ["A) 10", "B) 11", "C) 12", "D) 13"],
                    correct: 2
                },
                {
                    question: "Dans quelle ville J√©sus est-il n√© ?",
                    options: ["A) Nazareth", "B) J√©rusalem", "C) Bethl√©em", "D) Capharna√ºm"],
                    correct: 2
                },
                {
                    question: "Qui a trahi J√©sus ?",
                    options: ["A) Pierre", "B) Jean", "C) Judas", "D) Thomas"],
                    correct: 2
                },
                {
                    question: "Combien de jours J√©sus a-t-il je√ªn√© ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 60"],
                    correct: 1
                },
                {
                    question: "Qui √©tait le roi le plus sage d'Isra√´l ?",
                    options: ["A) David", "B) Salomon", "C) Sa√ºl", "D) Josias"],
                    correct: 1
                },
                {
                    question: "Combien de livres y a-t-il dans la Bible ?",
                    options: ["A) 64", "B) 65", "C) 66", "D) 67"],
                    correct: 2
                },
                {
                    question: "Qui a √©crit le plus de livres du Nouveau Testament ?",
                    options: ["A) Pierre", "B) Jean", "C) Paul", "D) Matthieu"],
                    correct: 2
                },
                {
                    question: "Quel √©tait le m√©tier de Pierre avant de suivre J√©sus ?",
                    options: ["A) Charpentier", "B) P√™cheur", "C) Berger", "D) Collecteur d'imp√¥ts"],
                    correct: 1
                },
                {
                    question: "Combien de plaies Dieu a-t-il envoy√©es sur l'√âgypte ?",
                    options: ["A) 8", "B) 9", "C) 10", "D) 12"],
                    correct: 2
                },
                {
                    question: "Qui a √©t√© aval√© par un grand poisson ?",
                    options: ["A) Jonas", "B) √âlie", "C) √âz√©chiel", "D) Daniel"],
                    correct: 0
                },
                {
                    question: "Combien d'ann√©es les Isra√©lites ont-ils err√© dans le d√©sert ?",
                    options: ["A) 30", "B) 35", "C) 40", "D) 50"],
                    correct: 2
                },
                {
                    question: "Qui √©tait la m√®re de J√©sus ?",
                    options: ["A) Marie", "B) Marthe", "C) Marie-Madeleine", "D) √âlisabeth"],
                    correct: 0
                },
                {
                    question: "Quel √©tait le nom du jardin o√π Adam et √àve vivaient ?",
                    options: ["A) Geths√©man√©", "B) √âden", "C) Oliviers", "D) Sina√Ø"],
                    correct: 1
                },
                {
                    question: "Qui a baptis√© J√©sus ?",
                    options: ["A) Pierre", "B) Jean l'√âvang√©liste", "C) Jean-Baptiste", "D) Andr√©"],
                    correct: 2
                },
                {
                    question: "Combien de fr√®res Joseph avait-il ?",
                    options: ["A) 10", "B) 11", "C) 12", "D) 13"],
                    correct: 1
                },
                {
                    question: "Qui a re√ßu les Dix Commandements ?",
                    options: ["A) Abraham", "B) Mo√Øse", "C) David", "D) Salomon"],
                    correct: 1
                },
                {
                    question: "Dans quel fleuve J√©sus a-t-il √©t√© baptis√© ?",
                    options: ["A) Nil", "B) Euphrate", "C) Jourdain", "D) Tigre"],
                    correct: 2
                },
                {
                    question: "Qui √©tait le p√®re de Jean-Baptiste ?",
                    options: ["A) Zacharie", "B) Sim√©on", "C) Joseph", "D) H√©rode"],
                    correct: 0
                },
                {
                    question: "Combien de pains J√©sus a-t-il multipli√©s pour nourrir 5000 personnes ?",
                    options: ["A) 3", "B) 5", "C) 7", "D) 12"],
                    correct: 1
                },
                {
                    question: "Qui a ni√© conna√Ætre J√©sus trois fois ?",
                    options: ["A) Jean", "B) Pierre", "C) Thomas", "D) Judas"],
                    correct: 1
                },
                {
                    question: "Quel √©tait le nom du mont o√π Mo√Øse a re√ßu les commandements ?",
                    options: ["A) Carmel", "B) Horeb", "C) Sina√Ø", "D) Sion"],
                    correct: 2
                },
                {
                    question: "Qui √©tait le plus petit des disciples ?",
                    options: ["A) Matthieu", "B) Zach√©e", "C) Jean", "D) Andr√©"],
                    correct: 1
                },
                {
                    question: "Combien de fois par jour Daniel priait-il ?",
                    options: ["A) 2", "B) 3", "C) 5", "D) 7"],
                    correct: 1
                },
                {
                    question: "Qui a construit le premier temple de J√©rusalem ?",
                    options: ["A) David", "B) Salomon", "C) Esdras", "D) N√©h√©mie"],
                    correct: 1
                },
                {
                    question: "Quel √©tait le nom de la femme d'Abraham ?",
                    options: ["A) Rachel", "B) L√©a", "C) Sara", "D) R√©becca"],
                    correct: 2
                },
                {
                    question: "Combien d'animaux de chaque esp√®ce No√© a-t-il pris dans l'arche ?",
                    options: ["A) 1 couple", "B) 2 couples", "C) 7 couples", "D) √áa d√©pend de l'esp√®ce"],
                    correct: 3
                },
                {
                    question: "Qui √©tait le roi g√©ant que David a vaincu ?",
                    options: ["A) Goliath", "B) Og", "C) Sihon", "D) Nebucadnetsar"],
                    correct: 0
                },
                {
                    question: "Dans quelle ville Paul a-t-il √©t√© converti ?",
                    options: ["A) J√©rusalem", "B) Damas", "C) Antioche", "D) Tarse"],
                    correct: 1
                },
                {
                    question: "Qui √©tait la s≈ìur de Mo√Øse ?",
                    options: ["A) D√©bora", "B) Esther", "C) Miriam", "D) Ruth"],
                    correct: 2
                },
                {
                    question: "Combien de jours et nuits a dur√© le d√©luge ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 150"],
                    correct: 1
                },
                {
                    question: "Qui √©tait le p√®re d'Isaac ?",
                    options: ["A) Abraham", "B) Jacob", "C) No√©", "D) Adam"],
                    correct: 0
                },
                {
                    question: "Quel √©tait le nom du serviteur d'Abraham ?",
                    options: ["A) √âli√©zer", "B) Lot", "C) Isma√´l", "D) Laban"],
                    correct: 0
                },
                {
                    question: "Qui a interpr√©t√© les r√™ves de Pharaon ?",
                    options: ["A) Mo√Øse", "B) Joseph", "C) Daniel", "D) √âz√©chiel"],
                    correct: 1
                },
                {
                    question: "Combien d'√©pouses le roi Salomon avait-il ?",
                    options: ["A) 300", "B) 500", "C) 700", "D) 1000"],
                    correct: 2
                },
                {
                    question: "Qui √©tait la m√®re de Samuel ?",
                    options: ["A) Anne", "B) Ruth", "C) D√©bora", "D) Esther"],
                    correct: 0
                },
                {
                    question: "Dans quelle ville J√©sus a-t-il grandi ?",
                    options: ["A) Bethl√©em", "B) Nazareth", "C) Capharna√ºm", "D) J√©rusalem"],
                    correct: 1
                },
                {
                    question: "Qui √©tait le premier roi d'Isra√´l ?",
                    options: ["A) David", "B) Salomon", "C) Sa√ºl", "D) Samuel"],
                    correct: 2
                },
                {
                    question: "Combien de chapitres y a-t-il dans le livre des Psaumes ?",
                    options: ["A) 120", "B) 130", "C) 140", "D) 150"],
                    correct: 3
                },
                {
                    question: "Qui √©tait l'√©pouse de Jacob qu'il aimait le plus ?",
                    options: ["A) L√©a", "B) Rachel", "C) Bilha", "D) Zilpa"],
                    correct: 1
                },
                {
                    question: "Quel √©tait le nom du fr√®re de Mo√Øse ?",
                    options: ["A) Aaron", "B) Josu√©", "C) Caleb", "D) √âl√©azar"],
                    correct: 0
                }
            ],
            currentQuestion: 0,
            score: 0,
            selectedAnswer: null,
            questionsAnswered: 0
        };

        // Battle game data
        let battleData = {
            currentRound: 1,
            maxRounds: 5,
            playerScore: 0,
            opponentScore: 0,
            timeLeft: 10,
            timer: null,
            selectedAnswer: null,
            currentQuestion: 0,
            opponentName: 'David_Foi',
            questions: [
                {
                    question: "Qui a construit l'arche de No√© ?",
                    options: ["A) Mo√Øse", "B) No√©", "C) Abraham", "D) David"],
                    correct: 1
                },
                {
                    question: "Combien de disciples J√©sus avait-il ?",
                    options: ["A) 10", "B) 11", "C) 12", "D) 13"],
                    correct: 2
                },
                {
                    question: "Dans quelle ville J√©sus est-il n√© ?",
                    options: ["A) Nazareth", "B) J√©rusalem", "C) Bethl√©em", "D) Capharna√ºm"],
                    correct: 2
                },
                {
                    question: "Qui a trahi J√©sus ?",
                    options: ["A) Pierre", "B) Jean", "C) Judas", "D) Thomas"],
                    correct: 2
                },
                {
                    question: "Combien de jours J√©sus a-t-il je√ªn√© ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 60"],
                    correct: 1
                },
                {
                    question: "Qui √©tait le roi le plus sage d'Isra√´l ?",
                    options: ["A) David", "B) Salomon", "C) Sa√ºl", "D) Josias"],
                    correct: 1
                },
                {
                    question: "Qui a re√ßu les Dix Commandements ?",
                    options: ["A) Abraham", "B) Mo√Øse", "C) David", "D) Salomon"],
                    correct: 1
                },
                {
                    question: "Dans quel fleuve J√©sus a-t-il √©t√© baptis√© ?",
                    options: ["A) Nil", "B) Euphrate", "C) Jourdain", "D) Tigre"],
                    correct: 2
                },
                {
                    question: "Qui √©tait le p√®re de Jean-Baptiste ?",
                    options: ["A) Zacharie", "B) Sim√©on", "C) Joseph", "D) H√©rode"],
                    correct: 0
                },
                {
                    question: "Combien de pains J√©sus a-t-il multipli√©s pour nourrir 5000 personnes ?",
                    options: ["A) 3", "B) 5", "C) 7", "D) 12"],
                    correct: 1
                }
            ]
        };

        // Memory game data
        let memoryData = {
            currentLevel: 1,
            score: 0,
            flippedCards: [],
            matchedPairs: 0,
            moves: 0,
            timeLeft: 60,
            timer: null,
            cards: [
                { id: 1, name: 'No√©', emoji: 'üö¢', description: 'Constructeur de l\'arche' },
                { id: 2, name: 'Mo√Øse', emoji: 'üìú', description: 'Lib√©rateur d\'Isra√´l' },
                { id: 3, name: 'David', emoji: 'üëë', description: 'Roi berger' },
                { id: 4, name: 'Salomon', emoji: 'üèõÔ∏è', description: 'Roi sage' },
                { id: 5, name: 'Daniel', emoji: 'ü¶Å', description: 'Dans la fosse aux lions' },
                { id: 6, name: 'Jonas', emoji: 'üêã', description: 'Aval√© par un poisson' },
                { id: 7, name: 'Abraham', emoji: '‚≠ê', description: 'P√®re de la foi' },
                { id: 8, name: 'Joseph', emoji: 'üåà', description: 'Manteau multicolore' },
                { id: 9, name: '√âlie', emoji: 'üî•', description: 'Proph√®te du feu' },
                { id: 10, name: 'Samuel', emoji: 'üïØÔ∏è', description: 'Proph√®te enfant' },
                { id: 11, name: 'Josu√©', emoji: '‚öîÔ∏è', description: 'Conqu√©rant de Canaan' },
                { id: 12, name: 'G√©d√©on', emoji: 'üè∫', description: 'Juge victorieux' }
            ]
        };

        // Verse game data
        let verseData = {
            verses: [
                {
                    text: "Car Dieu a tant aim√© le monde qu'il a donn√© son Fils _____, afin que quiconque croit en lui ne p√©risse point, mais qu'il ait la vie _____.",
                    answers: ["unique", "√©ternelle"],
                    ref: "Jean 3:16"
                },
                {
                    text: "Je suis le _____ et la _____. Nul ne vient au P√®re que par moi.",
                    answers: ["chemin", "v√©rit√©"],
                    ref: "Jean 14:6"
                },
                {
                    text: "Je puis _____ par celui qui me _____.",
                    answers: ["tout", "fortifie"],
                    ref: "Philippiens 4:13"
                },
                {
                    text: "L'√âternel est mon _____ : je ne _____ de rien.",
                    answers: ["berger", "manquerai"],
                    ref: "Psaume 23:1"
                },
                {
                    text: "Cherchez premi√®rement le _____ et la _____ de Dieu.",
                    answers: ["royaume", "justice"],
                    ref: "Matthieu 6:33"
                },
                {
                    text: "Venez √† moi, vous tous qui √™tes _____ et _____, et je vous donnerai du repos.",
                    answers: ["fatigu√©s", "charg√©s"],
                    ref: "Matthieu 11:28"
                },
                {
                    text: "Et nous savons que toutes choses concourent au _____ de ceux qui _____ Dieu.",
                    answers: ["bien", "aiment"],
                    ref: "Romains 8:28"
                },
                {
                    text: "Que votre _____ ne se trouble point. Croyez en Dieu, et croyez en _____.",
                    answers: ["c≈ìur", "moi"],
                    ref: "Jean 14:1"
                },
                {
                    text: "L'√âternel _____ pour vous ; et vous, gardez le _____.",
                    answers: ["combattra", "silence"],
                    ref: "Exode 14:14"
                },
                {
                    text: "Car l√† o√π _____ ou _____ sont assembl√©s en mon nom, je suis au milieu d'eux.",
                    answers: ["deux", "trois"],
                    ref: "Matthieu 18:20"
                },
                {
                    text: "Confie-toi en l'√âternel de tout ton _____, et ne t'appuie pas sur ta propre _____.",
                    answers: ["c≈ìur", "intelligence"],
                    ref: "Proverbes 3:5"
                },
                {
                    text: "Car mes _____ ne sont pas vos _____, dit l'√âternel.",
                    answers: ["pens√©es", "pens√©es"],
                    ref: "√âsa√Øe 55:8"
                },
                {
                    text: "Ne crains rien, car je suis avec toi ; ne prom√®ne pas des regards _____, car je suis ton _____.",
                    answers: ["inquiets", "Dieu"],
                    ref: "√âsa√Øe 41:10"
                },
                {
                    text: "L'√âternel ton Dieu est au _____ de toi, comme un h√©ros qui _____.",
                    answers: ["milieu", "sauve"],
                    ref: "Sophonie 3:17"
                },
                {
                    text: "Celui qui demeure sous l'_____ du Tr√®s-Haut repose √† l'_____ du Tout-Puissant.",
                    answers: ["abri", "ombre"],
                    ref: "Psaume 91:1"
                },
                {
                    text: "J√©sus lui dit : Je suis la _____ et la _____ ; celui qui croit en moi vivra.",
                    answers: ["r√©surrection", "vie"],
                    ref: "Jean 11:25"
                },
                {
                    text: "Mais ceux qui se _____ en l'√âternel renouvellent leur _____ ; ils prennent le vol comme les aigles.",
                    answers: ["confient", "force"],
                    ref: "√âsa√Øe 40:31"
                },
                {
                    text: "Car c'est par la _____ que vous √™tes sauv√©s, par le moyen de la _____ ; et cela ne vient pas de vous.",
                    answers: ["gr√¢ce", "foi"],
                    ref: "√âph√©siens 2:8"
                },
                {
                    text: "Remets ton _____ √† l'√âternel, et il _____.",
                    answers: ["sort", "agira"],
                    ref: "Psaume 37:5"
                },
                {
                    text: "Approchez-vous de Dieu, et il s'_____ de vous.",
                    answers: ["approchera"],
                    ref: "Jacques 4:8"
                },
                {
                    text: "Car l'√âternel prend _____ √† son peuple, et il a _____ de ses malheureux.",
                    answers: ["plaisir", "compassion"],
                    ref: "Psaume 149:4"
                },
                {
                    text: "Heureux ceux qui ont le c≈ìur _____, car ils _____ Dieu !",
                    answers: ["pur", "verront"],
                    ref: "Matthieu 5:8"
                },
                {
                    text: "Demandez, et l'on vous _____ ; cherchez, et vous _____ ; frappez, et l'on vous ouvrira.",
                    answers: ["donnera", "trouverez"],
                    ref: "Matthieu 7:7"
                },
                {
                    text: "L'√âternel est _____ et _____ ; lent √† la col√®re et riche en bont√©.",
                    answers: ["mis√©ricordieux", "compatissant"],
                    ref: "Psaume 103:8"
                },
                {
                    text: "Go√ªtez et voyez combien l'√âternel est _____ ! Heureux l'homme qui cherche en lui son _____ !",
                    answers: ["bon", "refuge"],
                    ref: "Psaume 34:8"
                },
                {
                    text: "Si nous _____ nos p√©ch√©s, il est _____ et juste pour nous les pardonner.",
                    answers: ["confessons", "fid√®le"],
                    ref: "1 Jean 1:9"
                },
                {
                    text: "Car Dieu n'est pas un Dieu de _____, mais de _____.",
                    answers: ["d√©sordre", "paix"],
                    ref: "1 Corinthiens 14:33"
                },
                {
                    text: "R√©jouissez-vous toujours dans le _____ ; je le dis encore : _____-vous !",
                    answers: ["Seigneur", "r√©jouissez"],
                    ref: "Philippiens 4:4"
                },
                {
                    text: "Ne vous _____ de rien ; mais en toute chose faites conna√Ætre vos besoins √† Dieu par des _____ et des supplications.",
                    answers: ["inqui√©tez", "pri√®res"],
                    ref: "Philippiens 4:6"
                },
                {
                    text: "Et la _____ de Dieu, qui surpasse toute _____, gardera vos c≈ìurs et vos pens√©es en J√©sus-Christ.",
                    answers: ["paix", "intelligence"],
                    ref: "Philippiens 4:7"
                },
                {
                    text: "J√©sus-Christ est le _____ hier, aujourd'hui, et √©ternellement.",
                    answers: ["m√™me"],
                    ref: "H√©breux 13:8"
                },
                {
                    text: "Car nous marchons par la _____, et non par la _____.",
                    answers: ["foi", "vue"],
                    ref: "2 Corinthiens 5:7"
                },
                {
                    text: "Tout ce que vous ferez, faites-le de bon _____, comme pour le _____, et non pour des hommes.",
                    answers: ["c≈ìur", "Seigneur"],
                    ref: "Colossiens 3:23"
                },
                {
                    text: "Car il n'y a sous le ciel aucun autre _____ qui ait √©t√© donn√© parmi les hommes, par lequel nous devions √™tre _____.",
                    answers: ["nom", "sauv√©s"],
                    ref: "Actes 4:12"
                },
                {
                    text: "Ainsi la _____ vient de ce qu'on entend, et ce qu'on entend vient de la _____ de Christ.",
                    answers: ["foi", "parole"],
                    ref: "Romains 10:17"
                },
                {
                    text: "Soyez dans la _____, mes fr√®res, perfectionnez-vous, consolez-vous, ayez un m√™me _____.",
                    answers: ["joie", "sentiment"],
                    ref: "2 Corinthiens 13:11"
                },
                {
                    text: "Car le salaire du _____ c'est la mort ; mais le don gratuit de Dieu, c'est la _____ √©ternelle en J√©sus-Christ.",
                    answers: ["p√©ch√©", "vie"],
                    ref: "Romains 6:23"
                },
                {
                    text: "Voici, je me tiens √† la _____ et je frappe. Si quelqu'un entend ma voix et ouvre la porte, j'_____ chez lui.",
                    answers: ["porte", "entrerai"],
                    ref: "Apocalypse 3:20"
                },
                {
                    text: "Heureux les _____ en esprit, car le _____ des cieux est √† eux !",
                    answers: ["pauvres", "royaume"],
                    ref: "Matthieu 5:3"
                },
                {
                    text: "Aimez vos _____, b√©nissez ceux qui vous _____, faites du bien √† ceux qui vous ha√Øssent.",
                    answers: ["ennemis", "maudissent"],
                    ref: "Matthieu 5:44"
                },
                {
                    text: "Car quiconque invoquera le _____ du Seigneur sera _____.",
                    answers: ["nom", "sauv√©"],
                    ref: "Romains 10:13"
                }
            ],
            currentVerse: 0
        };

        function goToPage(pageId) {
            // Cacher toutes les pages
            const pages = ['welcomePage', 'platformPage', 'usernamePage', 'profilePhotoPage', 'premiumPage', 'mainPage', 'settingsPage', 'inboxPage'];
            pages.forEach(page => {
                document.getElementById(page).classList.add('hidden');
            });
            
            // Afficher la page demand√©e
            document.getElementById(pageId).classList.remove('hidden');
            document.getElementById(pageId).classList.add('slide-in');
            
            currentPage = pageId;
            
            // Charger le contenu sp√©cifique √† la page
            if (pageId === 'inboxPage') {
                loadTodayVerses();
            }
            
            showNotification(`üì± Navigation vers ${pageId}`);
        }

        function selectPlatform(platform) {
            selectedPlatform = platform;
            showNotification(`${platform} s√©lectionn√© !`);
        }

        function setProfileEmoji(emoji) {
            profileEmoji = emoji;
            
            const profileDisplay = document.getElementById('profileEmoji');
            const mainProfile = document.getElementById('mainProfileEmoji');
            
            if (profileDisplay) {
                profileDisplay.textContent = emoji;
            }
            
            if (mainProfile) {
                mainProfile.textContent = emoji;
            }
            
            showNotification(`${emoji} Emoji s√©lectionn√© !`);
        }

        function selectProfilePhoto() {
            showNotification('üì∑ Fonctionnalit√© de photo √† venir !');
        }

        function showTab(tab) {
            // Reset all tabs
            document.getElementById('playTab').classList.remove('border-purple-600', 'text-purple-600');
            document.getElementById('playTab').classList.add('text-gray-500');
            document.getElementById('gamesTab').classList.remove('border-purple-600', 'text-purple-600');
            document.getElementById('gamesTab').classList.add('text-gray-500');
            document.getElementById('inboxTab').classList.remove('border-purple-600', 'text-purple-600');
            document.getElementById('inboxTab').classList.add('text-gray-500');
            
            // Hide all content
            document.getElementById('playContent').classList.add('hidden');
            document.getElementById('gamesContent').classList.add('hidden');
            document.getElementById('inboxContent').classList.add('hidden');
            
            // Show selected tab and content
            if (tab === 'play') {
                document.getElementById('playTab').classList.add('border-purple-600', 'text-purple-600');
                document.getElementById('playTab').classList.remove('text-gray-500');
                document.getElementById('playContent').classList.remove('hidden');
            } else if (tab === 'games') {
                document.getElementById('gamesTab').classList.add('border-purple-600', 'text-purple-600');
                document.getElementById('gamesTab').classList.remove('text-gray-500');
                document.getElementById('gamesContent').classList.remove('hidden');
            } else {
                document.getElementById('inboxTab').classList.add('border-purple-600', 'text-purple-600');
                document.getElementById('inboxTab').classList.remove('text-gray-500');
                document.getElementById('inboxContent').classList.remove('hidden');
                // Charger les messages quand on ouvre l'inbox
                loadInboxMessages();
            }
        }

        // Questions Modal Functions
        function openQuestionsModal() {
            document.getElementById('questionsModal').classList.remove('hidden');
            document.getElementById('questionsModal').classList.add('flex');
            updateQuestionDisplay();
        }

        function closeQuestionsModal() {
            document.getElementById('questionsModal').classList.add('hidden');
            document.getElementById('questionsModal').classList.remove('flex');
        }

        function updateQuestionDisplay() {
            // G√©n√©rer plus de questions si n√©cessaire
            if (currentQuestionIndex >= allQuestions.length - 10) {
                for (let i = 0; i < 50; i++) {
                    allQuestions.push(generateInfiniteQuestion());
                    totalQuestionsGenerated++;
                }
            }
            
            const currentQuestion = allQuestions[currentQuestionIndex];
            const questionText = document.getElementById('questionText');
            const questionEmoji = document.getElementById('questionEmoji');
            const questionNumber = document.getElementById('currentQuestionNumber');
            const questionCard = document.getElementById('questionCard');
            
            if (questionText) {
                questionText.textContent = currentQuestion.text;
            }
            if (questionEmoji) {
                questionEmoji.textContent = currentQuestion.emoji;
            }
            if (questionNumber) {
                questionNumber.textContent = currentQuestionIndex + 1;
            }
            if (questionCard) {
                questionCard.className = `p-6 bg-gradient-to-br ${currentQuestion.color} text-white rounded-2xl mb-4`;
            }
            
            // Mettre √† jour la cat√©gorie
            const questionCategory = document.getElementById('questionCategory');
            if (questionCategory && currentQuestion.category) {
                const categoryNames = {
                    versets: 'Versets',
                    foi: 'Foi',
                    priere: 'Pri√®re',
                    personnages: 'Personnages',
                    vie: 'Vie quotidienne',
                    espoir: 'Espoir'
                };
                questionCategory.textContent = categoryNames[currentQuestion.category] || 'Question';
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            updateQuestionDisplay();
            showNotification('‚û°Ô∏è Question suivante');
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                updateQuestionDisplay();
                showNotification('‚¨ÖÔ∏è Question pr√©c√©dente');
            }
        }

        function randomQuestion() {
            // G√©n√©rer une nouvelle question al√©atoire
            const newQuestion = generateInfiniteQuestion();
            allQuestions.push(newQuestion);
            currentQuestionIndex = allQuestions.length - 1;
            totalQuestionsGenerated++;
            updateQuestionDisplay();
            showNotification('üé≤ Nouvelle question g√©n√©r√©e !');
        }

        function copyCurrentQuestion() {
            const link = `https://praylink.app/q/${currentQuestionIndex}`;
            showNotification('üìã Lien copi√© !');
        }

        function shareCurrentQuestion() {
            const currentQuestion = allQuestions[currentQuestionIndex];
            const shareLink = `https://praylink.app/q/${currentQuestionIndex}?u=${encodeURIComponent(username || 'PrayerWarrior')}`;
            
            // Cr√©er le contenu de partage
            const shareText = `${currentQuestion.text}\n\nR√©ponds-moi anonymement ici üëá\n${shareLink}`;
            
            // Ouvrir le modal de partage
            openShareModal(shareText, shareLink);
        }

        // Versets Modal Functions
        function openVersetsModal() {
            document.getElementById('versetsModal').classList.remove('hidden');
            document.getElementById('versetsModal').classList.add('flex');
            updateVersetDisplay();
        }

        function closeVersetsModal() {
            document.getElementById('versetsModal').classList.add('hidden');
            document.getElementById('versetsModal').classList.remove('flex');
        }

        function updateVersetDisplay() {
            const currentVerset = allVersets[currentVersetIndex];
            const versetText = document.getElementById('versetText');
            const versetRef = document.getElementById('versetRef');
            const versetNumber = document.getElementById('currentVersetNumber');
            
            if (versetText) {
                versetText.textContent = `"${currentVerset.text}"`;
            }
            if (versetRef) {
                versetRef.textContent = currentVerset.ref;
            }
            if (versetNumber) {
                versetNumber.textContent = currentVersetIndex + 1;
            }
        }

        function nextVerset() {
            if (currentVersetIndex < allVersets.length - 1) {
                currentVersetIndex++;
                updateVersetDisplay();
                showNotification('‚û°Ô∏è Verset suivant');
            }
        }

        function previousVerset() {
            if (currentVersetIndex > 0) {
                currentVersetIndex--;
                updateVersetDisplay();
                showNotification('‚¨ÖÔ∏è Verset pr√©c√©dent');
            }
        }

        function randomVerset() {
            currentVersetIndex = Math.floor(Math.random() * allVersets.length);
            updateVersetDisplay();
            showNotification('üé≤ Verset al√©atoire !');
        }

        function copyCurrentVerset() {
            const currentVerset = allVersets[currentVersetIndex];
            const versetText = `"${currentVerset.text}" - ${currentVerset.ref}`;
            showNotification('üìã Verset copi√© !');
        }

        function shareCurrentVerset() {
            const currentVerset = allVersets[currentVersetIndex];
            const shareLink = `https://praylink.app/v/${currentVersetIndex}?u=${encodeURIComponent(username || 'PrayerWarrior')}`;
            
            // Cr√©er le contenu de partage
            const shareText = `"${currentVerset.text}"\n${currentVerset.ref}\n\nPartag√© par ${username || '@PrayerWarrior'} sur PrayLink üôè\n${shareLink}`;
            
            // Ouvrir le modal de partage
            openShareModal(shareText, shareLink);
        }

        function openShareModal(text, link) {
            document.getElementById('shareText').textContent = text;
            document.getElementById('shareLink').value = link;
            
            document.getElementById('shareModal').classList.remove('hidden');
            document.getElementById('shareModal').classList.add('flex');
        }

        function closeShareModal() {
            document.getElementById('shareModal').classList.add('hidden');
            document.getElementById('shareModal').classList.remove('flex');
        }

        function copyShareLink() {
            const linkInput = document.getElementById('shareLink');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showNotification('üìã Lien copi√© dans le presse-papier !');
                
                // Animation de succ√®s
                const copyBtn = document.querySelector('[onclick="copyShareLink()"]');
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '‚úÖ Copi√© !';
                copyBtn.classList.add('bg-green-500');
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.classList.remove('bg-green-500');
                }, 2000);
            } catch (err) {
                showNotification('‚ùå Erreur lors de la copie');
            }
        }

        function shareToInstagram() {
            const text = document.getElementById('shareText').textContent;
            const instagramUrl = `https://www.instagram.com/create/story/?text=${encodeURIComponent(text)}`;
            window.open(instagramUrl, '_blank');
            showNotification('üì∑ Ouverture d\'Instagram...');
        }

        function shareToWhatsApp() {
            const text = document.getElementById('shareText').textContent;
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(text)}`;
            window.open(whatsappUrl, '_blank');
            showNotification('üí¨ Ouverture de WhatsApp...');
        }

        function shareToSnapchat() {
            const text = document.getElementById('shareText').textContent;
            const snapchatUrl = `https://www.snapchat.com/scan?attachmentUrl=${encodeURIComponent(document.getElementById('shareLink').value)}`;
            window.open(snapchatUrl, '_blank');
            showNotification('üëª Ouverture de Snapchat...');
        }

        function shareToTwitter() {
            const text = document.getElementById('shareText').textContent;
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
            window.open(twitterUrl, '_blank');
            showNotification('üê¶ Ouverture de Twitter...');
        }

        function generateRandomQuestion() {
            const randomQuestion = allQuestions[Math.floor(Math.random() * allQuestions.length)];
            showNotification('üé≤ Nouvelle question g√©n√©r√©e !');
        }

        // Quiz functions
        function startBibleQuiz() {
            quizData.currentQuestion = Math.floor(Math.random() * quizData.questions.length);
            quizData.score = 0;
            quizData.selectedAnswer = null;
            quizData.questionsAnswered = 0;
            
            document.getElementById('quizModal').classList.remove('hidden');
            document.getElementById('quizModal').classList.add('flex');
            
            loadQuizQuestion();
        }

        function loadQuizQuestion() {
            const current = quizData.questions[quizData.currentQuestion];
            
            document.getElementById('quizQuestion').textContent = current.question;
            document.getElementById('quizNumber').textContent = quizData.questionsAnswered + 1;
            document.getElementById('currentScore').textContent = quizData.score;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            current.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.onclick = () => selectQuizAnswer(index);
                button.className = 'w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn answer-option';
                button.setAttribute('data-index', index);
                button.innerHTML = `<span class="font-medium">${option}</span>`;
                optionsContainer.appendChild(button);
            });
            
            document.getElementById('nextQuizBtn').disabled = true;
            quizData.selectedAnswer = null;
        }

        function selectQuizAnswer(index) {
            quizData.selectedAnswer = index;
            
            document.querySelectorAll('.answer-option').forEach((btn, i) => {
                btn.classList.remove('border-purple-500', 'bg-purple-50', 'border-green-500', 'bg-green-50', 'border-red-500', 'bg-red-50');
                if (i === index) {
                    btn.classList.add('border-purple-500', 'bg-purple-50');
                }
            });
            
            document.getElementById('nextQuizBtn').disabled = false;
        }

        function nextQuizQuestion() {
            const current = quizData.questions[quizData.currentQuestion];
            
            // Montrer la bonne r√©ponse
            document.querySelectorAll('.answer-option').forEach((btn, i) => {
                btn.classList.remove('border-purple-500', 'bg-purple-50');
                if (i === current.correct) {
                    btn.classList.add('border-green-500', 'bg-green-50');
                } else if (i === quizData.selectedAnswer && i !== current.correct) {
                    btn.classList.add('border-red-500', 'bg-red-50');
                }
                btn.disabled = true;
            });
            
            if (quizData.selectedAnswer === current.correct) {
                quizData.score++;
                showNotification('‚úÖ Bonne r√©ponse !');
            } else {
                showNotification('‚ùå Mauvaise r√©ponse !');
            }
            
            quizData.questionsAnswered++;
            
            // Attendre 2 secondes puis charger une nouvelle question al√©atoire
            setTimeout(() => {
                // Choisir une nouvelle question al√©atoire diff√©rente de la pr√©c√©dente
                let newQuestionIndex;
                do {
                    newQuestionIndex = Math.floor(Math.random() * quizData.questions.length);
                } while (newQuestionIndex === quizData.currentQuestion && quizData.questions.length > 1);
                
                quizData.currentQuestion = newQuestionIndex;
                
                // R√©activer les boutons
                document.querySelectorAll('.answer-option').forEach(btn => {
                    btn.disabled = false;
                });
                
                loadQuizQuestion();
            }, 2000);
        }

        function showQuizResults() {
            document.getElementById('quizContent').classList.add('hidden');
            document.getElementById('quizResults').classList.remove('hidden');
            document.getElementById('finalScore').textContent = `${quizData.score}/${quizData.questionsAnswered}`;
        }

        function restartQuiz() {
            document.getElementById('quizContent').classList.remove('hidden');
            document.getElementById('quizResults').classList.add('hidden');
            startBibleQuiz();
        }

        function closeQuizModal() {
            document.getElementById('quizModal').classList.add('hidden');
            document.getElementById('quizModal').classList.remove('flex');
        }

        // Verse game functions
        function startVerseGame() {
            verseData.currentVerse = 0;
            
            document.getElementById('verseModal').classList.remove('hidden');
            document.getElementById('verseModal').classList.add('flex');
            
            loadCurrentVerse();
        }

        function loadCurrentVerse() {
            const current = verseData.verses[verseData.currentVerse];
            
            document.getElementById('verseText').textContent = current.text;
            document.getElementById('verseRef').textContent = current.ref;
            document.getElementById('verseInput1').value = '';
            document.getElementById('verseInput2').value = '';
            
            // G√©rer l'affichage des champs selon le nombre de mots manquants
            const input2Container = document.getElementById('verseInput2');
            if (current.answers.length === 1) {
                input2Container.style.display = 'none';
                document.getElementById('verseInput1').placeholder = 'Mot manquant';
            } else {
                input2Container.style.display = 'block';
                document.getElementById('verseInput1').placeholder = 'Premier mot manquant';
                document.getElementById('verseInput2').placeholder = 'Second mot manquant';
            }
            
            document.getElementById('verseContent').classList.remove('hidden');
            document.getElementById('verseResults').classList.add('hidden');
        }

        function checkVerseAnswer() {
            const current = verseData.verses[verseData.currentVerse];
            const input1 = document.getElementById('verseInput1').value.toLowerCase().trim();
            const input2 = document.getElementById('verseInput2').value.toLowerCase().trim();
            
            const correct1 = current.answers[0].toLowerCase();
            const correct2 = current.answers.length > 1 ? current.answers[1].toLowerCase() : '';
            
            let isCorrect;
            let correctAnswersText;
            
            if (current.answers.length === 1) {
                isCorrect = input1 === correct1;
                correctAnswersText = `"${current.answers[0]}"`;
            } else {
                isCorrect = input1 === correct1 && input2 === correct2;
                correctAnswersText = `"${current.answers[0]}" et "${current.answers[1]}"`;
            }
            
            document.getElementById('verseContent').classList.add('hidden');
            document.getElementById('verseResults').classList.remove('hidden');
            
            if (isCorrect) {
                document.getElementById('verseResultIcon').textContent = '‚úÖ';
                document.getElementById('verseResultText').textContent = 'Correct !';
                document.getElementById('verseResultMessage').textContent = 'Bien jou√© ! Tu connais bien tes versets.';
                showNotification('‚úÖ Bonne r√©ponse !');
            } else {
                document.getElementById('verseResultIcon').textContent = '‚ùå';
                document.getElementById('verseResultText').textContent = 'Pas tout √† fait...';
                document.getElementById('verseResultMessage').textContent = `Les bonnes r√©ponses √©taient : ${correctAnswersText}.`;
                showNotification('‚ùå Essaie encore !');
            }
        }

        function nextVerse() {
            // Choisir un verset al√©atoire diff√©rent du pr√©c√©dent
            let newVerseIndex;
            do {
                newVerseIndex = Math.floor(Math.random() * verseData.verses.length);
            } while (newVerseIndex === verseData.currentVerse && verseData.verses.length > 1);
            
            verseData.currentVerse = newVerseIndex;
            loadCurrentVerse();
        }

        function closeVerseModal() {
            document.getElementById('verseModal').classList.add('hidden');
            document.getElementById('verseModal').classList.remove('flex');
        }

        // Memory game functions
        function loadMemoryLevel() {
            const pairsCount = Math.min(6 + memoryData.currentLevel - 1, 12);
            const selectedCards = memoryData.cards.slice(0, pairsCount);
            const gameCards = [...selectedCards, ...selectedCards].map((card, index) => ({
                ...card,
                uniqueId: index,
                isFlipped: false,
                isMatched: false
            }));
            
            // M√©langer les cartes
            for (let i = gameCards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [gameCards[i], gameCards[j]] = [gameCards[j], gameCards[i]];
            }
            
            memoryData.gameCards = gameCards;
            memoryData.flippedCards = [];
            memoryData.matchedPairs = 0;
            memoryData.moves = 0;
            memoryData.timeLeft = 60 + (memoryData.currentLevel - 1) * 10;
            
            updateMemoryDisplay();
            renderMemoryGrid();
            startMemoryTimer();
        }

        function renderMemoryGrid() {
            const grid = document.getElementById('memoryGrid');
            const gridSize = memoryData.gameCards.length <= 12 ? 'grid-cols-4' : 'grid-cols-5';
            grid.className = `grid ${gridSize} gap-2 mb-4`;
            
            grid.innerHTML = memoryData.gameCards.map(card => `
                <div class="memory-card aspect-square bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center cursor-pointer transition-all duration-300 hover:scale-105 ${card.isFlipped || card.isMatched ? 'bg-gradient-to-br from-green-400 to-blue-500' : ''}" 
                     onclick="flipMemoryCard(${card.uniqueId})"
                     data-card-id="${card.uniqueId}">
                    <div class="text-center">
                        ${card.isFlipped || card.isMatched 
                            ? `<div class="text-2xl mb-1">${card.emoji}</div><div class="text-xs text-white font-medium">${card.name}</div>`
                            : '<div class="text-2xl text-white">üéØ</div>'
                        }
                    </div>
                </div>
            `).join('');
        }

        function flipMemoryCard(uniqueId) {
            const card = memoryData.gameCards.find(c => c.uniqueId === uniqueId);
            
            if (!card || card.isFlipped || card.isMatched || memoryData.flippedCards.length >= 2) {
                return;
            }
            
            card.isFlipped = true;
            memoryData.flippedCards.push(card);
            
            renderMemoryGrid();
            
            if (memoryData.flippedCards.length === 2) {
                memoryData.moves++;
                updateMemoryDisplay();
                
                setTimeout(() => {
                    checkMemoryMatch();
                }, 1000);
            }
        }

        function checkMemoryMatch() {
            const [card1, card2] = memoryData.flippedCards;
            
            if (card1.id === card2.id) {
                // Match trouv√©
                card1.isMatched = true;
                card2.isMatched = true;
                memoryData.matchedPairs++;
                memoryData.score += 100 + (memoryData.timeLeft * 2);
                
                showNotification('‚úÖ Paire trouv√©e !');
                
                // V√©rifier si le niveau est termin√©
                if (memoryData.matchedPairs === memoryData.gameCards.length / 2) {
                    setTimeout(() => {
                        completeMemoryLevel();
                    }, 500);
                }
            } else {
                // Pas de match
                card1.isFlipped = false;
                card2.isFlipped = false;
                showNotification('‚ùå Pas de match !');
            }
            
            memoryData.flippedCards = [];
            renderMemoryGrid();
            updateMemoryDisplay();
        }

        function completeMemoryLevel() {
            clearInterval(memoryData.timer);
            
            // Bonus de temps
            const timeBonus = memoryData.timeLeft * 5;
            memoryData.score += timeBonus;
            
            document.getElementById('memoryContent').classList.add('hidden');
            document.getElementById('memoryResults').classList.remove('hidden');
            
            document.getElementById('finalMemoryScore').textContent = memoryData.score;
            document.getElementById('finalMemoryMoves').textContent = memoryData.moves;
            
            if (memoryData.currentLevel >= 5) {
                document.getElementById('memoryResultText').textContent = 'Jeu termin√© !';
                document.getElementById('memoryResultIcon').textContent = 'üèÜ';
                document.getElementById('nextLevelBtn').style.display = 'none';
            } else {
                document.getElementById('memoryResultText').textContent = `Niveau ${memoryData.currentLevel} termin√© !`;
                document.getElementById('memoryResultIcon').textContent = 'üéâ';
                document.getElementById('nextLevelBtn').style.display = 'block';
            }
        }

        function nextMemoryLevel() {
            memoryData.currentLevel++;
            document.getElementById('memoryContent').classList.remove('hidden');
            document.getElementById('memoryResults').classList.add('hidden');
            loadMemoryLevel();
        }

        function restartMemoryGame() {
            clearInterval(memoryData.timer);
            memoryData.currentLevel = 1;
            memoryData.score = 0;
            document.getElementById('memoryContent').classList.remove('hidden');
            document.getElementById('memoryResults').classList.add('hidden');
            loadMemoryLevel();
        }

        function updateMemoryDisplay() {
            document.getElementById('memoryLevel').textContent = memoryData.currentLevel;
            document.getElementById('memoryScore').textContent = memoryData.score;
            document.getElementById('memoryTimer').textContent = memoryData.timeLeft + 's';
            document.getElementById('memoryMoves').textContent = memoryData.moves;
            document.getElementById('memoryPairs').textContent = memoryData.matchedPairs;
            document.getElementById('memoryTotal').textContent = memoryData.gameCards ? memoryData.gameCards.length / 2 : 6;
        }

        function startMemoryTimer() {
            clearInterval(memoryData.timer);
            
            memoryData.timer = setInterval(() => {
                memoryData.timeLeft--;
                updateMemoryDisplay();
                
                if (memoryData.timeLeft <= 0) {
                    clearInterval(memoryData.timer);
                    gameOverMemory();
                }
            }, 1000);
        }

        function gameOverMemory() {
            document.getElementById('memoryContent').classList.add('hidden');
            document.getElementById('memoryResults').classList.remove('hidden');
            
            document.getElementById('memoryResultText').textContent = 'Temps √©coul√© !';
            document.getElementById('memoryResultIcon').textContent = '‚è∞';
            document.getElementById('finalMemoryScore').textContent = memoryData.score;
            document.getElementById('finalMemoryMoves').textContent = memoryData.moves;
            document.getElementById('nextLevelBtn').style.display = 'none';
            
            showNotification('‚è∞ Temps √©coul√© ! Essaie encore.');
        }

        function closeMemoryModal() {
            clearInterval(memoryData.timer);
            document.getElementById('memoryModal').classList.add('hidden');
            document.getElementById('memoryModal').classList.remove('flex');
        }

        function startMemoryGame() {
            memoryData.currentLevel = 1;
            memoryData.score = 0;
            memoryData.flippedCards = [];
            memoryData.matchedPairs = 0;
            memoryData.moves = 0;
            
            document.getElementById('memoryModal').classList.remove('hidden');
            document.getElementById('memoryModal').classList.add('flex');
            
            loadMemoryLevel();
        }

        // Battle game functions
        function startBattleGame() {
            battleData.currentRound = 1;
            battleData.playerScore = 0;
            battleData.opponentScore = 0;
            battleData.selectedAnswer = null;
            battleData.currentQuestion = Math.floor(Math.random() * battleData.questions.length);
            
            document.getElementById('battleModal').classList.remove('hidden');
            document.getElementById('battleModal').classList.add('flex');
            
            loadBattleQuestion();
        }

        function loadBattleQuestion() {
            const current = battleData.questions[battleData.currentQuestion];
            
            document.getElementById('battleQuestion').textContent = current.question;
            document.getElementById('battleRound').textContent = battleData.currentRound;
            document.getElementById('battleScore').textContent = battleData.playerScore;
            
            // Mettre √† jour les scores dans l'interface
            const scoreElements = document.querySelectorAll('#battleContent .text-lg.font-bold');
            if (scoreElements.length >= 2) {
                scoreElements[0].textContent = battleData.playerScore;
                scoreElements[1].textContent = battleData.opponentScore;
            }
            
            const optionsContainer = document.getElementById('battleOptions');
            optionsContainer.innerHTML = '';
            
            current.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.onclick = () => selectBattleAnswer(index);
                button.className = 'w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn battle-option';
                button.setAttribute('data-index', index);
                button.innerHTML = `<span class="font-medium">${option}</span>`;
                optionsContainer.appendChild(button);
            });
            
            battleData.selectedAnswer = null;
            battleData.timeLeft = 10;
            startBattleTimer();
        }

        function selectBattleAnswer(index) {
            if (battleData.selectedAnswer !== null) return;
            
            battleData.selectedAnswer = index;
            clearInterval(battleData.timer);
            
            const current = battleData.questions[battleData.currentQuestion];
            
            // Montrer les r√©ponses
            document.querySelectorAll('.battle-option').forEach((btn, i) => {
                btn.disabled = true;
                btn.classList.remove('border-gray-200', 'hover:border-orange-500');
                
                if (i === current.correct) {
                    btn.classList.add('border-green-500', 'bg-green-50');
                } else if (i === index && i !== current.correct) {
                    btn.classList.add('border-red-500', 'bg-red-50');
                }
            });
            
            // Calculer les scores
            if (index === current.correct) {
                battleData.playerScore++;
                showNotification('‚úÖ Bonne r√©ponse !');
            } else {
                showNotification('‚ùå Mauvaise r√©ponse !');
            }
            
            // Simuler la r√©ponse de l'adversaire (50% de chance de r√©ussir)
            if (Math.random() > 0.5) {
                battleData.opponentScore++;
            }
            
            // Attendre 2 secondes puis passer √† la question suivante
            setTimeout(() => {
                if (battleData.currentRound >= battleData.maxRounds) {
                    endBattle();
                } else {
                    battleData.currentRound++;
                    // Choisir une nouvelle question al√©atoire
                    let newQuestionIndex;
                    do {
                        newQuestionIndex = Math.floor(Math.random() * battleData.questions.length);
                    } while (newQuestionIndex === battleData.currentQuestion && battleData.questions.length > 1);
                    
                    battleData.currentQuestion = newQuestionIndex;
                    
                    // R√©activer les boutons
                    document.querySelectorAll('.battle-option').forEach(btn => {
                        btn.disabled = false;
                    });
                    
                    loadBattleQuestion();
                }
            }, 2000);
        }

        function startBattleTimer() {
            clearInterval(battleData.timer);
            
            battleData.timer = setInterval(() => {
                battleData.timeLeft--;
                document.getElementById('battleTimer').textContent = battleData.timeLeft + 's';
                
                if (battleData.timeLeft <= 0) {
                    clearInterval(battleData.timer);
                    // Temps √©coul√©, consid√©rer comme mauvaise r√©ponse
                    if (battleData.selectedAnswer === null) {
                        selectBattleAnswer(-1); // R√©ponse invalide
                    }
                }
            }, 1000);
        }

        function endBattle() {
            document.getElementById('battleContent').classList.add('hidden');
            document.getElementById('battleResults').classList.remove('hidden');
            
            document.getElementById('finalBattleScore').textContent = battleData.playerScore;
            document.getElementById('opponentScore').textContent = battleData.opponentScore;
            
            if (battleData.playerScore > battleData.opponentScore) {
                document.getElementById('battleResultIcon').textContent = 'üèÜ';
                document.getElementById('battleResultText').textContent = 'Victoire !';
                showNotification('üèÜ Tu as gagn√© la bataille !');
            } else if (battleData.playerScore < battleData.opponentScore) {
                document.getElementById('battleResultIcon').textContent = 'üòî';
                document.getElementById('battleResultText').textContent = 'D√©faite...';
                showNotification('üòî Tu as perdu cette fois...');
            } else {
                document.getElementById('battleResultIcon').textContent = 'ü§ù';
                document.getElementById('battleResultText').textContent = '√âgalit√© !';
                showNotification('ü§ù Match nul !');
            }
        }

        function restartBattle() {
            document.getElementById('battleContent').classList.remove('hidden');
            document.getElementById('battleResults').classList.add('hidden');
            startBattleGame();
        }

        function findNewOpponent() {
            const opponents = ['Marie_2024', 'Paul_Espoir', 'Sarah_Lumi√®re', 'Emma_Grace', 'Luc_Foi', 'Anna_Pri√®re'];
            battleData.opponentName = opponents[Math.floor(Math.random() * opponents.length)];
            
            // Mettre √† jour le nom de l'adversaire dans l'interface
            const opponentNameElement = document.querySelector('#battleContent strong');
            if (opponentNameElement) {
                opponentNameElement.textContent = battleData.opponentName;
            }
            
            showNotification(`üîç Nouvel adversaire trouv√© : ${battleData.opponentName}`);
            restartBattle();
        }

        function closeBattleModal() {
            clearInterval(battleData.timer);
            document.getElementById('battleModal').classList.add('hidden');
            document.getElementById('battleModal').classList.remove('flex');
        }

        // Premium functions
        function upgradeToPremium() {
            document.getElementById('premiumUpgradeModal').classList.remove('hidden');
            document.getElementById('premiumUpgradeModal').classList.add('flex');
        }

        function showPremiumRequired() {
            showNotification('üëë Fonctionnalit√© Premium requise ! Passe Premium pour d√©bloquer ce jeu.');
            setTimeout(() => {
                upgradeToPremium();
            }, 1000);
        }

        function closePremiumModal() {
            document.getElementById('premiumUpgradeModal').classList.add('hidden');
            document.getElementById('premiumUpgradeModal').classList.remove('flex');
        }

        function purchasePremium() {
            showNotification('üéâ F√©licitations ! Tu es maintenant Premium !');
            closePremiumModal();
            // Ici on pourrait d√©bloquer les jeux premium
        }

        // Settings functions
        function showHowToShare() {
            document.getElementById('howToShareModal').classList.remove('hidden');
            document.getElementById('howToShareModal').classList.add('flex');
        }

        function closeHowToShare() {
            document.getElementById('howToShareModal').classList.add('hidden');
            document.getElementById('howToShareModal').classList.remove('flex');
        }

        function deleteAccount() {
            if (confirm('Es-tu s√ªr de vouloir supprimer ton compte ? Cette action est irr√©versible.')) {
                showNotification('üóëÔ∏è Compte supprim√© avec succ√®s !');
                goToPage('welcomePage');
            }
        }

        // Notification system
        function showNotification(message) {
            // Simple console log instead of visual notification
            console.log(message);
        }

        // Fonction pour charger les versets d'aujourd'hui
        function loadTodayVerses() {
            const feed = document.getElementById('versesNewsFeed');
            if (!feed) return;
            
            let filteredVerses = todayVerses;
            
            if (currentFilter === 'recent') {
                filteredVerses = todayVerses.slice(0, 3);
            } else if (currentFilter === 'popular') {
                filteredVerses = todayVerses.filter(v => v.likes > 10);
            }
            
            feed.innerHTML = filteredVerses.map(verse => `
                <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-100 mb-4">
                    <!-- Header utilisateur -->
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-lg mr-3">
                                ${verse.avatar}
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-sm">${verse.user}</h4>
                                <p class="text-xs text-gray-500">${verse.time}</p>
                            </div>
                        </div>
                        <button onclick="copyVerseLink('${verse.link}')" class="text-gray-400 hover:text-purple-500 interactive-btn">
                            <span class="text-lg">üîó</span>
                        </button>
                    </div>
                    
                    <!-- Message personnel -->
                    <p class="text-sm text-gray-700 mb-3">${verse.message}</p>
                    
                    <!-- Verset -->
                    <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-100 mb-3">
                        <p class="text-sm text-gray-800 italic mb-2">"${verse.verse}"</p>
                        <p class="text-xs text-purple-600 font-medium">${verse.reference}</p>
                    </div>
                    
                    <!-- Actions -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <button onclick="toggleLike(${verse.id})" class="flex items-center space-x-1 interactive-btn ${verse.isLiked ? 'text-red-500' : 'text-gray-500'}">
                                <span class="text-lg">${verse.isLiked ? '‚ù§Ô∏è' : 'ü§ç'}</span>
                                <span class="text-sm font-medium">${verse.likes}</span>
                            </button>
                            
                            <button onclick="startConversation('${verse.user}')" class="flex items-center space-x-1 text-gray-500 hover:text-purple-500 interactive-btn">
                                <span class="text-lg">üí¨</span>
                                <span class="text-sm font-medium">${verse.comments}</span>
                            </button>
                            
                            <button onclick="shareVerse(${verse.id})" class="flex items-center space-x-1 text-gray-500 hover:text-blue-500 interactive-btn">
                                <span class="text-lg">üì§</span>
                                <span class="text-sm font-medium">${verse.shares}</span>
                            </button>
                        </div>
                        
                        <button onclick="startConversation('${verse.user}')" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-2 rounded-full text-xs font-medium interactive-btn">
                            üí¨ Discuter
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Fonction pour filtrer les versets
        function filterVerses(filter) {
            currentFilter = filter;
            
            // Mettre √† jour les boutons de filtre
            document.getElementById('filterAll').className = filter === 'all' 
                ? 'px-4 py-2 bg-purple-600 text-white rounded-full text-sm mr-3 interactive-btn'
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm mr-3 interactive-btn';
                
            document.getElementById('filterRecent').className = filter === 'recent' 
                ? 'px-4 py-2 bg-purple-600 text-white rounded-full text-sm mr-3 interactive-btn'
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm mr-3 interactive-btn';
                
            document.getElementById('filterPopular').className = filter === 'popular' 
                ? 'px-4 py-2 bg-purple-600 text-white rounded-full text-sm interactive-btn'
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm interactive-btn';
            
            loadTodayVerses();
            showNotification(`üìä Filtre "${filter}" appliqu√©`);
        }

        // Fonction pour liker un verset
        function toggleLike(verseId) {
            const verse = todayVerses.find(v => v.id === verseId);
            if (verse) {
                verse.isLiked = !verse.isLiked;
                verse.likes += verse.isLiked ? 1 : -1;
                loadTodayVerses();
                showNotification(verse.isLiked ? '‚ù§Ô∏è Verset aim√© !' : 'ü§ç Like retir√©');
            }
        }

        // Fonction pour copier le lien d'un verset
        function copyVerseLink(link) {
            showNotification('üîó Lien copi√© dans le presse-papier !');
        }

        // Fonction pour d√©marrer une conversation
        function startConversation(username) {
            currentConversation = username;
            
            document.getElementById('conversationUserName').textContent = username;
            document.getElementById('conversationUserAvatar').textContent = conversationData[username]?.avatar || 'üë§';
            document.getElementById('conversationStatus').textContent = conversationData[username]?.status || 'Hors ligne';
            
            loadConversationMessages();
            
            document.getElementById('conversationModal').classList.remove('hidden');
            document.getElementById('conversationModal').classList.add('flex');
        }

        // Fonction pour charger les messages de conversation
        function loadConversationMessages() {
            const messagesContainer = document.getElementById('conversationMessages');
            const messages = conversationData[currentConversation]?.messages || [];
            
            messagesContainer.innerHTML = messages.map(msg => `
                <div class="flex ${msg.type === 'sent' ? 'justify-end' : 'justify-start'}">
                    <div class="max-w-[70%] ${msg.type === 'sent' 
                        ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white' 
                        : 'bg-gray-100 text-gray-800'} rounded-2xl px-4 py-3">
                        <p class="text-sm">${msg.text}</p>
                        <p class="text-xs opacity-75 mt-1">${msg.time}</p>
                    </div>
                </div>
            `).join('');
            
            // Scroll vers le bas
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Fonction pour fermer la conversation
        function closeConversation() {
            document.getElementById('conversationModal').classList.add('hidden');
            document.getElementById('conversationModal').classList.remove('flex');
            currentConversation = null;
        }

        // Fonction pour envoyer un message
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message && currentConversation) {
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                // Ajouter le message √† la conversation
                if (!conversationData[currentConversation]) {
                    conversationData[currentConversation] = { messages: [] };
                }
                
                conversationData[currentConversation].messages.push({
                    type: 'sent',
                    text: message,
                    time: time
                });
                
                input.value = '';
                loadConversationMessages();
                showNotification('üì§ Message envoy√© !');
                
                // Simuler une r√©ponse automatique apr√®s 2 secondes
                setTimeout(() => {
                    const responses = [
                        'Merci pour ton message ! üôè',
                        'Amen ! Ce verset me touche aussi ‚ù§Ô∏è',
                        'Que Dieu te b√©nisse ! ‚ú®',
                        'Prions ensemble pour cela üïäÔ∏è'
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    const responseTime = new Date();
                    const responseTimeStr = responseTime.getHours().toString().padStart(2, '0') + ':' + responseTime.getMinutes().toString().padStart(2, '0');
                    
                    conversationData[currentConversation].messages.push({
                        type: 'received',
                        text: randomResponse,
                        time: responseTimeStr
                    });
                    
                    loadConversationMessages();
                }, 2000);
            }
        }

        // Fonction pour g√©rer l'appui sur Entr√©e
        function handleMessageKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Fonction pour ajouter un emoji
        function addEmoji(emoji) {
            const input = document.getElementById('messageInput');
            input.value += emoji;
            input.focus();
        }

        // Fonction pour partager un verset dans la conversation
        function shareVerse() {
            const randomVerse = allVersets[Math.floor(Math.random() * allVersets.length)];
            const input = document.getElementById('messageInput');
            input.value = `üìñ "${randomVerse.text}" - ${randomVerse.ref}`;
        }

        // Fonction pour bloquer un utilisateur
        function blockUser() {
            if (confirm(`√ätes-vous s√ªr de vouloir bloquer ${currentConversation} ?`)) {
                showNotification('üö´ Utilisateur bloqu√©');
                closeConversation();
            }
        }

        // Donn√©es des messages re√ßus
        const inboxMessages = [
            {
                id: 1,
                type: 'üôè Pri√®re',
                typeColor: 'bg-purple-100 text-purple-700',
                bgGradient: 'from-purple-500 to-pink-600',
                time: '14:32',
                message: 'Peux-tu prier pour mon examen demain ? J\'ai besoin de force üôè',
                sender: 'Anonyme #1',
                avatar: 'üë§',
                hasLink: false,
                link: null
            },
            {
                id: 2,
                type: 'üìñ Verset',
                typeColor: 'bg-blue-100 text-blue-700',
                bgGradient: 'from-blue-500 to-indigo-600',
                time: '12:15',
                message: 'Comment tu vis ce verset : Je puis tout par celui qui me fortifie ?',
                sender: 'Anonyme #2',
                avatar: 'üë§',
                hasLink: true,
                link: 'https://praylink.app/u/marie2024'
            },
            {
                id: 3,
                type: '‚ú® Question',
                typeColor: 'bg-green-100 text-green-700',
                bgGradient: 'from-green-500 to-emerald-600',
                time: 'Hier',
                message: 'Peux-tu prier pour ma famille ? Nous traversons une p√©riode difficile üò¢',
                sender: 'Anonyme #3',
                avatar: 'üë§',
                hasLink: true,
                link: 'https://praylink.app/u/david_foi'
            },
            {
                id: 4,
                type: 'üíù T√©moignage',
                typeColor: 'bg-pink-100 text-pink-700',
                bgGradient: 'from-pink-500 to-rose-600',
                time: 'Hier',
                message: 'Merci pour tes pri√®res ! Mon entretien s\'est super bien pass√© ! Dieu est fid√®le üôå',
                sender: 'Anonyme #4',
                avatar: 'üë§',
                hasLink: false,
                link: null
            },
            {
                id: 5,
                type: 'ü§ù Encouragement',
                typeColor: 'bg-yellow-100 text-yellow-700',
                bgGradient: 'from-yellow-500 to-orange-600',
                time: '2 jours',
                message: 'Ton message m\'a vraiment encourag√©. Continue √† partager l\'amour de Dieu ! ‚ú®',
                sender: 'Anonyme #5',
                avatar: 'üë§',
                hasLink: true,
                link: 'https://praylink.app/u/sarah_lumiere'
            }
        ];

        // Fonction pour charger les messages dans l'inbox du tab principal
        function loadInboxMessages() {
            const messagesList = document.getElementById('messagesList');
            if (!messagesList) return;
            
            messagesList.innerHTML = inboxMessages.map(msg => `
                <div class="bg-gradient-to-br ${msg.bgGradient} text-white p-4 rounded-xl">
                    <div class="flex items-center justify-between mb-2">
                        <span class="bg-white bg-opacity-20 px-2 py-1 rounded-full text-xs">${msg.type}</span>
                        <span class="text-xs opacity-75">${msg.time}</span>
                    </div>
                    <p class="text-sm mb-3">"${msg.message}"</p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-sm mr-2">${msg.avatar}</div>
                            <span class="text-xs">${msg.sender}</span>
                            ${msg.hasLink ? '<span class="text-xs opacity-75 ml-2">‚Ä¢ A un profil</span>' : ''}
                        </div>
                        <button onclick="openReplyModal(${msg.id})" class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-xs interactive-btn hover:bg-opacity-30">üí¨ R√©pondre</button>
                    </div>
                </div>
            `).join('');
        }

        // Fonctions pour les indices d'activit√©
        function showQuestionInsights() {
            loadInsightsData('question');
            document.getElementById('insightsModal').classList.remove('hidden');
            document.getElementById('insightsModal').classList.add('flex');
        }

        function showVersetInsights() {
            loadInsightsData('verset');
            document.getElementById('insightsModal').classList.remove('hidden');
            document.getElementById('insightsModal').classList.add('flex');
        }

        function closeInsightsModal() {
            document.getElementById('insightsModal').classList.add('hidden');
            document.getElementById('insightsModal').classList.remove('flex');
        }

        function loadInsightsData(type) {
            // Charger les visiteurs
            const visitorsContainer = document.getElementById('visitorsInsights');
            visitorsContainer.innerHTML = insightsData.visitors.map(visitor => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-xl">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center text-lg mr-3">
                            ${visitor.avatar}
                        </div>
                        <div>
                            <p class="font-medium text-gray-800 text-sm">${visitor.hint}</p>
                            <div class="flex items-center text-xs text-gray-500">
                                <span class="mr-2">üìç ${visitor.location}</span>
                                <span class="mr-2">üì± ${visitor.device}</span>
                                <span>${visitor.time}</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        ${visitor.hasResponded 
                            ? '<span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium">üí¨ A r√©pondu</span>'
                            : '<span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">üëÄ Vu seulement</span>'
                        }
                    </div>
                </div>
            `).join('');

            // Charger les r√©pondants
            const respondersContainer = document.getElementById('respondersInsights');
            respondersContainer.innerHTML = insightsData.responders.map(responder => `
                <div class="p-3 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100">
                    <div class="flex items-center mb-2">
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-400 to-indigo-400 rounded-full flex items-center justify-center text-sm mr-3">
                            ${responder.avatar}
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-gray-800 text-sm">${responder.hint}</p>
                            <p class="text-xs text-gray-500">${responder.time}</p>
                        </div>
                        <div class="text-lg">
                            ${responder.sentiment === 'positive' ? 'üòä' : responder.sentiment === 'negative' ? 'üòî' : 'üòê'}
                        </div>
                    </div>
                    <p class="text-sm text-gray-700 italic bg-white bg-opacity-50 rounded-lg p-2">
                        "${responder.message}"
                    </p>
                </div>
            `).join('');

            // Mettre √† jour les statistiques
            document.getElementById('insightViews').textContent = insightsData.visitors.length * 2 + Math.floor(Math.random() * 10);
            document.getElementById('insightClicks').textContent = insightsData.visitors.length;
            document.getElementById('insightResponses').textContent = insightsData.responders.length;
        }

        // Mystery game data
        let mysteryData = {
            currentMystery: 0,
            score: 0,
            hintsUsed: 0,
            maxHints: 3,
            startTime: null,
            mysteries: [
                {
                    question: "Je suis celui qui a √©t√© vendu par ses fr√®res pour 20 pi√®ces d'argent. Mes r√™ves ont pr√©dit l'avenir et j'ai sauv√© l'√âgypte de la famine. Qui suis-je ?",
                    answer: ["joseph"],
                    hints: [
                        "üåà J'avais un manteau de plusieurs couleurs",
                        "üëë Je suis devenu vice-roi d'√âgypte",
                        "üåæ J'ai interpr√©t√© les r√™ves de Pharaon sur les vaches grasses et maigres"
                    ],
                    explanation: "Joseph √©tait le fils de Jacob, vendu par ses fr√®res jaloux. Ses dons d'interpr√©tation des r√™ves l'ont men√© √† devenir vice-roi d'√âgypte."
                },
                {
                    question: "Je suis le roi qui a demand√© la sagesse √† Dieu et qui a construit le premier temple. Mes jugements √©taient c√©l√®bres dans tout le royaume. Qui suis-je ?",
                    answer: ["salomon"],
                    hints: [
                        "‚öñÔ∏è J'ai propos√© de couper un b√©b√© en deux pour trouver sa vraie m√®re",
                        "üèõÔ∏è J'ai construit un temple magnifique √† J√©rusalem",
                        "üëë Mon p√®re √©tait le roi David"
                    ],
                    explanation: "Salomon √©tait le fils de David, connu pour sa sagesse extraordinaire et pour avoir construit le premier temple de J√©rusalem."
                },
                {
                    question: "Je suis celui qui a √©t√© aval√© par un grand poisson apr√®s avoir fui ma mission. Dieu m'avait envoy√© pr√™cher √† une grande ville. Qui suis-je ?",
                    answer: ["jonas"],
                    hints: [
                        "üêã J'ai pass√© trois jours dans le ventre d'un poisson",
                        "üèÉ‚Äç‚ôÇÔ∏è J'ai essay√© de fuir vers Tarsis au lieu d'ob√©ir √† Dieu",
                        "üèôÔ∏è Dieu m'avait envoy√© pr√™cher √† Ninive"
                    ],
                    explanation: "Jonas √©tait un proph√®te qui a tent√© de fuir sa mission divine mais a √©t√© ramen√© √† la raison apr√®s son s√©jour dans le ventre du poisson."
                },
                {
                    question: "Je suis le berger qui est devenu roi et qui a vaincu un g√©ant avec une fronde. J'ai √©crit de nombreux psaumes. Qui suis-je ?",
                    answer: ["david"],
                    hints: [
                        "üéµ J'ai √©crit de nombreux psaumes et je jouais de la harpe",
                        "‚öîÔ∏è J'ai vaincu Goliath avec une pierre et une fronde",
                        "üëë J'ai √©t√© oint roi par le proph√®te Samuel"
                    ],
                    explanation: "David √©tait un berger devenu roi d'Isra√´l, c√©l√®bre pour avoir vaincu Goliath et pour ses psaumes inspir√©s."
                },
                {
                    question: "Je suis celui qui a conduit le peuple d'Isra√´l hors d'√âgypte et qui a re√ßu les Dix Commandements sur le mont Sina√Ø. Qui suis-je ?",
                    answer: ["moise", "mo√Øse"],
                    hints: [
                        "üåä J'ai s√©par√© les eaux de la mer Rouge",
                        "üìú J'ai re√ßu les Dix Commandements de Dieu",
                        "üî• J'ai vu Dieu dans un buisson ardent"
                    ],
                    explanation: "Mo√Øse √©tait le grand lib√©rateur d'Isra√´l, qui a conduit le peuple hors de l'esclavage √©gyptien et re√ßu la Loi de Dieu."
                },
                {
                    question: "Je suis la femme qui a cach√© les espions isra√©lites √† J√©richo et qui a √©t√© sauv√©e lors de la prise de la ville. Qui suis-je ?",
                    answer: ["rahab"],
                    hints: [
                        "üè† J'habitais dans les murailles de J√©richo",
                        "üî¥ J'ai attach√© un cordon rouge √† ma fen√™tre",
                        "üïµÔ∏è J'ai cach√© les espions envoy√©s par Josu√©"
                    ],
                    explanation: "Rahab √©tait une femme de J√©richo qui a aid√© les espions isra√©lites et a √©t√© √©pargn√©e lors de la conqu√™te de la ville."
                },
                {
                    question: "Je suis le proph√®te qui a √©t√© nourri par des corbeaux et qui a d√©fi√© les proph√®tes de Baal sur le mont Carmel. Qui suis-je ?",
                    answer: ["elie", "√©lie"],
                    hints: [
                        "üî• J'ai fait descendre le feu du ciel sur l'autel",
                        "üê¶ Des corbeaux m'apportaient de la nourriture",
                        "‚õ∞Ô∏è J'ai d√©fi√© 450 proph√®tes de Baal sur le mont Carmel"
                    ],
                    explanation: "√âlie √©tait un puissant proph√®te qui a d√©montr√© la puissance de Dieu face aux proph√®tes de Baal et a √©t√© nourri miraculeusement."
                },
                {
                    question: "Je suis celui qui a interpr√©t√© les r√™ves du roi Nebucadnetsar et qui a surv√©cu dans la fosse aux lions. Qui suis-je ?",
                    answer: ["daniel"],
                    hints: [
                        "ü¶Å J'ai pass√© une nuit dans la fosse aux lions",
                        "üëë J'ai interpr√©t√© les r√™ves de Nebucadnetsar",
                        "üôè Je priais trois fois par jour malgr√© l'interdiction"
                    ],
                    explanation: "Daniel √©tait un proph√®te fid√®le qui a servi dans la cour babylonienne et a √©t√© prot√©g√© par Dieu dans la fosse aux lions."
                },
                {
                    question: "Je suis la femme qui a remplac√© Vashti comme reine et qui ai sauv√© mon peuple d'un g√©nocide. Qui suis-je ?",
                    answer: ["esther"],
                    hints: [
                        "üëë Je suis devenue reine de Perse",
                        "üé≠ J'ai cach√© mon identit√© juive au d√©but",
                        "‚öîÔ∏è J'ai d√©jou√© le plan d'Haman contre les Juifs"
                    ],
                    explanation: "Esther √©tait une jeune juive devenue reine de Perse qui a courageusement sauv√© son peuple du massacre planifi√© par Haman."
                },
                {
                    question: "Je suis celui qui a construit une arche pour sauver ma famille et les animaux du d√©luge. Qui suis-je ?",
                    answer: ["noe", "no√©"],
                    hints: [
                        "üö¢ J'ai construit une grande arche en bois",
                        "üåßÔ∏è J'ai surv√©cu au d√©luge de 40 jours",
                        "üïäÔ∏è Une colombe m'a apport√© un rameau d'olivier"
                    ],
                    explanation: "No√© √©tait un homme juste qui a ob√©i √† Dieu en construisant l'arche et a sauv√© l'humanit√© et les animaux du d√©luge."
                },
                {
                    question: "Je suis la femme moabite qui a suivi ma belle-m√®re et qui suis devenue l'arri√®re-grand-m√®re du roi David. Qui suis-je ?",
                    answer: ["ruth"],
                    hints: [
                        "üíï J'ai dit : 'Ton peuple sera mon peuple, ton Dieu sera mon Dieu'",
                        "üåæ J'ai glan√© dans les champs de Boaz",
                        "üëµ Ma belle-m√®re s'appelait Naomi"
                    ],
                    explanation: "Ruth √©tait une femme moabite qui a montr√© une fid√©lit√© remarquable envers sa belle-m√®re et est devenue anc√™tre de David."
                },
                {
                    question: "Je suis le juge qui a vaincu les Madianites avec seulement 300 hommes et des cruches. Qui suis-je ?",
                    answer: ["gedeon", "g√©d√©on"],
                    hints: [
                        "üè∫ J'ai utilis√© des cruches et des torches pour effrayer l'ennemi",
                        "üë• J'ai r√©duit mon arm√©e de 32 000 √† 300 hommes",
                        "üåæ J'ai demand√© un signe avec une toison"
                    ],
                    explanation: "G√©d√©on √©tait un juge d'Isra√´l qui a remport√© une victoire miraculeuse contre les Madianites avec une petite arm√©e."
                },
                {
                    question: "Je suis le disciple qui a dout√© de la r√©surrection jusqu'√† ce que je voie les plaies de J√©sus. Qui suis-je ?",
                    answer: ["thomas"],
                    hints: [
                        "ü§ö J'ai voulu toucher les plaies de J√©sus",
                        "‚ùì J'ai dit : 'Si je ne vois pas, je ne croirai pas'",
                        "‚úùÔ∏è J'ai proclam√© : 'Mon Seigneur et mon Dieu' apr√®s avoir vu"
                    ],
                    explanation: "Thomas √©tait l'un des douze ap√¥tres, surnomm√© 'l'incr√©dule' car il a dout√© de la r√©surrection avant de voir J√©sus."
                },
                {
                    question: "Je suis celui qui a baptis√© J√©sus dans le Jourdain et qui ai pr√©par√© le chemin du Seigneur. Qui suis-je ?",
                    answer: ["jean-baptiste", "jean baptiste"],
                    hints: [
                        "üåä J'ai baptis√© J√©sus dans le fleuve Jourdain",
                        "ü¶ó Je me nourrissais de sauterelles et de miel sauvage",
                        "üó£Ô∏è J'ai dit : 'Il faut qu'il croisse et que je diminue'"
                    ],
                    explanation: "Jean-Baptiste √©tait le pr√©curseur de J√©sus, qui a pr√©par√© le chemin du Seigneur et l'a baptis√© dans le Jourdain."
                },
                {
                    question: "Je suis l'ap√¥tre qui a reni√© J√©sus trois fois mais qui suis devenu le chef de l'√âglise primitive. Qui suis-je ?",
                    answer: ["pierre"],
                    hints: [
                        "üêì J'ai reni√© J√©sus trois fois avant le chant du coq",
                        "üóùÔ∏è J√©sus m'a donn√© les cl√©s du royaume des cieux",
                        "üé£ J'√©tais p√™cheur avant de suivre J√©sus"
                    ],
                    explanation: "Pierre √©tait l'ap√¥tre impulsif qui, malgr√© son reniement, est devenu le leader de l'√âglise primitive apr√®s la r√©surrection."
                },
                {
                    question: "Je suis celui qui a pers√©cut√© les chr√©tiens avant de devenir ap√¥tre sur le chemin de Damas. Qui suis-je ?",
                    answer: ["paul", "saul"],
                    hints: [
                        "‚ö° J'ai √©t√© aveugl√© par une lumi√®re sur le chemin de Damas",
                        "‚úâÔ∏è J'ai √©crit de nombreuses lettres aux √âglises",
                        "üë• Mon nom √©tait Saul avant ma conversion"
                    ],
                    explanation: "Paul (anciennement Saul) √©tait un pers√©cuteur des chr√©tiens qui est devenu le plus grand missionnaire apr√®s sa conversion miraculeuse."
                },
                {
                    question: "Je suis la femme qui a vers√© un parfum pr√©cieux sur les pieds de J√©sus et les a essuy√©s avec ses cheveux. Qui suis-je ?",
                    answer: ["marie-madeleine", "marie madeleine"],
                    hints: [
                        "üíê J'ai vers√© un parfum tr√®s co√ªteux sur J√©sus",
                        "üë©‚Äçü¶± J'ai essuy√© ses pieds avec mes cheveux",
                        "‚úùÔ∏è J'ai √©t√© la premi√®re √† voir J√©sus ressuscit√©"
                    ],
                    explanation: "Marie-Madeleine √©tait une disciple d√©vou√©e de J√©sus, connue pour son geste d'amour avec le parfum et pour avoir √©t√© t√©moin de la r√©surrection."
                },
                {
                    question: "Je suis le roi qui a √©crit : 'L'√âternel est mon berger, je ne manquerai de rien'. Qui suis-je ?",
                    answer: ["david"],
                    hints: [
                        "üêë J'√©tais berger avant d'√™tre roi",
                        "üéµ J'ai √©crit le Psaume 23",
                        "üëë J'ai √©t√© le deuxi√®me roi d'Isra√´l"
                    ],
                    explanation: "David, le roi-berger, a √©crit le c√©l√®bre Psaume 23 qui commence par 'L'√âternel est mon berger'."
                },
                {
                    question: "Je suis celui qui a √©t√© jet√© dans une citerne par ses fr√®res mais qui ai fini par leur pardonner. Qui suis-je ?",
                    answer: ["joseph"],
                    hints: [
                        "üï≥Ô∏è Mes fr√®res m'ont jet√© dans une citerne",
                        "üçû J'ai nourri mes fr√®res pendant la famine",
                        "üò¢ J'ai pleur√© quand je me suis fait reconna√Ætre"
                    ],
                    explanation: "Joseph a pardonn√© √† ses fr√®res qui l'avaient vendu, d√©montrant un c≈ìur plein de gr√¢ce et de mis√©ricorde."
                },
                {
                    question: "Je suis la femme st√©rile qui a pri√© avec ferveur et qui ai donn√© naissance au proph√®te Samuel. Qui suis-je ?",
                    answer: ["anne"],
                    hints: [
                        "üôè J'ai pri√© avec tant de ferveur qu'on m'a crue ivre",
                        "üë∂ J'ai consacr√© mon fils au service de Dieu",
                        "üèõÔ∏è J'ai amen√© Samuel au temple quand il √©tait petit"
                    ],
                    explanation: "Anne √©tait une femme de foi qui a pri√© avec pers√©v√©rance pour avoir un enfant et a consacr√© Samuel √† Dieu."
                },
                {
                    question: "Je suis le disciple bien-aim√© qui ai √©crit l'√âvangile de l'amour et l'Apocalypse. Qui suis-je ?",
                    answer: ["jean"],
                    hints: [
                        "‚ù§Ô∏è J'√©tais le disciple que J√©sus aimait",
                        "üìñ J'ai √©crit : 'Dieu est amour'",
                        "üèùÔ∏è J'ai re√ßu la r√©v√©lation sur l'√Æle de Patmos"
                    ],
                    explanation: "Jean √©tait le disciple bien-aim√©, auteur de l'√âvangile qui met l'accent sur l'amour et du livre de l'Apocalypse."
                },
                {
                    question: "Je suis celui qui ai lutt√© avec l'ange toute une nuit et dont le nom a √©t√© chang√© en Isra√´l. Qui suis-je ?",
                    answer: ["jacob"],
                    hints: [
                        "ü§º‚Äç‚ôÇÔ∏è J'ai lutt√© avec un ange jusqu'√† l'aube",
                        "ü¶µ Ma hanche a √©t√© d√©bo√Æt√©e pendant le combat",
                        "üë• J'ai eu douze fils qui sont devenus les tribus d'Isra√´l"
                    ],
                    explanation: "Jacob a lutt√© avec l'ange et son nom a √©t√© chang√© en Isra√´l, devenant le p√®re des douze tribus."
                },
                {
                    question: "Je suis la femme qui ai cach√© les espions sur le toit et qui ai √©t√© sauv√©e par un cordon rouge. Qui suis-je ?",
                    answer: ["rahab"],
                    hints: [
                        "üè† J'habitais dans les murailles de J√©richo",
                        "üî¥ Un cordon rouge a marqu√© ma maison",
                        "üë• J'ai aid√© les espions isra√©lites √† s'√©chapper"
                    ],
                    explanation: "Rahab a fait preuve de foi en aidant les espions d'Isra√´l et a √©t√© r√©compens√©e par le salut de sa famille."
                },
                {
                    question: "Je suis celui qui ai √©t√© appel√© 'ami de Dieu' et qui ai √©t√© pr√™t √† sacrifier mon fils unique. Qui suis-je ?",
                    answer: ["abraham"],
                    hints: [
                        "üë¥ J'ai quitt√© ma terre natale sur l'ordre de Dieu",
                        "üî™ J'ai √©t√© pr√™t √† sacrifier Isaac sur le mont Morija",
                        "‚≠ê Dieu m'a promis une descendance nombreuse comme les √©toiles"
                    ],
                    explanation: "Abraham √©tait l'ami de Dieu, le p√®re de la foi, qui a ob√©i m√™me quand Dieu lui a demand√© de sacrifier Isaac."
                },
                {
                    question: "Je suis le proph√®te qui ai √©t√© emmen√© au ciel dans un char de feu sans passer par la mort. Qui suis-je ?",
                    answer: ["elie", "√©lie"],
                    hints: [
                        "üî• Un char de feu m'a emmen√© au ciel",
                        "üå™Ô∏è Un tourbillon m'a enlev√©",
                        "üë®‚Äçüéì √âlis√©e √©tait mon disciple et successeur"
                    ],
                    explanation: "√âlie a √©t√© enlev√© au ciel dans un char de feu, √©tant l'un des rares √† ne pas avoir connu la mort."
                }
            ]
        };

        // Tournament data
        let tournamentData = {
            currentRound: 1,
            maxRounds: 10,
            score: 0,
            timeLeft: 15,
            timer: null,
            selectedAnswer: null,
            currentQuestion: 0,
            playerRank: 156,
            questions: [
                {
                    question: "Qui √©tait le plus jeune des fils de Jacob ?",
                    options: ["A) Joseph", "B) Benjamin", "C) Dan", "D) Nephtali"],
                    correct: 1
                },
                {
                    question: "Quel proph√®te a √©t√© nourri par des corbeaux ?",
                    options: ["A) √âlie", "B) √âlis√©e", "C) √âz√©chiel", "D) J√©r√©mie"],
                    correct: 0
                },
                {
                    question: "Combien de temps Daniel a-t-il pri√© malgr√© l'interdiction ?",
                    options: ["A) 7 jours", "B) 21 jours", "C) 30 jours", "D) Il n'a jamais arr√™t√©"],
                    correct: 3
                },
                {
                    question: "Qui √©tait la femme de Mo√Øse ?",
                    options: ["A) S√©phora", "B) Miriam", "C) D√©bora", "D) Ruth"],
                    correct: 0
                },
                {
                    question: "Quel roi a construit le premier temple ?",
                    options: ["A) David", "B) Salomon", "C) √âz√©chias", "D) Josias"],
                    correct: 1
                },
                {
                    question: "Combien de plaies Dieu a-t-il envoy√©es sur l'√âgypte ?",
                    options: ["A) 7", "B) 10", "C) 12", "D) 40"],
                    correct: 1
                },
                {
                    question: "Qui a interpr√©t√© le r√™ve de Nebucadnetsar ?",
                    options: ["A) Joseph", "B) Daniel", "C) √âz√©chiel", "D) J√©r√©mie"],
                    correct: 1
                },
                {
                    question: "Quel √©tait le nom du g√©ant vaincu par David ?",
                    options: ["A) Og", "B) Goliath", "C) Sihon", "D) Anak"],
                    correct: 1
                },
                {
                    question: "Combien d'ann√©es les Isra√©lites ont-ils err√© dans le d√©sert ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 70"],
                    correct: 1
                },
                {
                    question: "Qui √©tait le p√®re de Jean-Baptiste ?",
                    options: ["A) Zacharie", "B) Sim√©on", "C) Joseph", "D) H√©rode"],
                    correct: 0
                }
            ]
        };

        // Tournament functions
        function startTournament() {
            tournamentData.currentRound = 1;
            tournamentData.score = 0;
            tournamentData.selectedAnswer = null;
            tournamentData.currentQuestion = Math.floor(Math.random() * tournamentData.questions.length);
            tournamentData.playerRank = Math.floor(Math.random() * 200) + 50;
            
            document.getElementById('tournamentModal').classList.remove('hidden');
            document.getElementById('tournamentModal').classList.add('flex');
            
            loadTournamentQuestion();
        }

        function loadTournamentQuestion() {
            const current = tournamentData.questions[tournamentData.currentQuestion];
            
            document.getElementById('tournamentQuestion').textContent = current.question;
            document.getElementById('tournamentRound').textContent = tournamentData.currentRound;
            document.getElementById('tournamentScore').textContent = tournamentData.score;
            document.getElementById('playerRank').textContent = tournamentData.playerRank;
            
            const optionsContainer = document.getElementById('tournamentOptions');
            optionsContainer.innerHTML = '';
            
            current.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.onclick = () => selectTournamentAnswer(index);
                button.className = 'w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option';
                button.setAttribute('data-index', index);
                button.innerHTML = `<span class="font-medium">${option}</span>`;
                optionsContainer.appendChild(button);
            });
            
            tournamentData.selectedAnswer = null;
            tournamentData.timeLeft = 15;
            startTournamentTimer();
            updateLeaderboard();
        }

        function selectTournamentAnswer(index) {
            if (tournamentData.selectedAnswer !== null) return;
            
            tournamentData.selectedAnswer = index;
            clearInterval(tournamentData.timer);
            
            const current = tournamentData.questions[tournamentData.currentQuestion];
            
            // Montrer les r√©ponses
            document.querySelectorAll('.tournament-option').forEach((btn, i) => {
                btn.disabled = true;
                btn.classList.remove('border-gray-200', 'hover:border-purple-500');
                
                if (i === current.correct) {
                    btn.classList.add('border-green-500', 'bg-green-50');
                } else if (i === index && i !== current.correct) {
                    btn.classList.add('border-red-500', 'bg-red-50');
                }
            });
            
            // Calculer le score
            if (index === current.correct) {
                const timeBonus = Math.max(0, tournamentData.timeLeft * 10);
                const basePoints = 100;
                const roundBonus = tournamentData.currentRound * 5;
                const totalPoints = basePoints + timeBonus + roundBonus;
                
                tournamentData.score += totalPoints;
                tournamentData.playerRank = Math.max(1, tournamentData.playerRank - Math.floor(Math.random() * 10));
                showNotification(`‚úÖ +${totalPoints} points ! Classement: ${tournamentData.playerRank}`);
            } else {
                tournamentData.playerRank = Math.min(2847, tournamentData.playerRank + Math.floor(Math.random() * 5));
                showNotification('‚ùå Mauvaise r√©ponse !');
            }
            
            // Attendre 2 secondes puis passer √† la question suivante
            setTimeout(() => {
                if (tournamentData.currentRound >= tournamentData.maxRounds) {
                    endTournament();
                } else {
                    tournamentData.currentRound++;
                    // Choisir une nouvelle question al√©atoire
                    let newQuestionIndex;
                    do {
                        newQuestionIndex = Math.floor(Math.random() * tournamentData.questions.length);
                    } while (newQuestionIndex === tournamentData.currentQuestion && tournamentData.questions.length > 1);
                    
                    tournamentData.currentQuestion = newQuestionIndex;
                    
                    // R√©activer les boutons
                    document.querySelectorAll('.tournament-option').forEach(btn => {
                        btn.disabled = false;
                    });
                    
                    loadTournamentQuestion();
                }
            }, 2000);
        }

        function startTournamentTimer() {
            clearInterval(tournamentData.timer);
            
            tournamentData.timer = setInterval(() => {
                tournamentData.timeLeft--;
                document.getElementById('tournamentTimer').textContent = tournamentData.timeLeft + 's';
                
                if (tournamentData.timeLeft <= 0) {
                    clearInterval(tournamentData.timer);
                    // Temps √©coul√©, consid√©rer comme mauvaise r√©ponse
                    if (tournamentData.selectedAnswer === null) {
                        selectTournamentAnswer(-1); // R√©ponse invalide
                    }
                }
            }, 1000);
        }

        function updateLeaderboard() {
            // Simuler des changements dans le classement
            const leaderboard = [
                { name: 'David_Proph√®te', score: 2450 + Math.floor(Math.random() * 100) },
                { name: 'Marie_Sagesse', score: 2380 + Math.floor(Math.random() * 100) },
                { name: 'Paul_V√©rit√©', score: 2290 + Math.floor(Math.random() * 100) },
                { name: 'Sarah_Foi', score: 2180 + Math.floor(Math.random() * 100) },
                { name: 'Luc_Espoir', score: 2120 + Math.floor(Math.random() * 100) }
            ];
            
            // Trier par score
            leaderboard.sort((a, b) => b.score - a.score);
            
            const leaderboardContainer = document.getElementById('tournamentLeaderboard');
            const medals = ['ü•á', 'ü•à', 'ü•â', '4.', '5.'];
            const colors = ['text-yellow-500', 'text-gray-400', 'text-orange-500', 'text-gray-600', 'text-gray-600'];
            
            leaderboardContainer.innerHTML = leaderboard.map((player, index) => `
                <div class="flex items-center justify-between text-sm">
                    <div class="flex items-center">
                        <span class="${colors[index]} mr-2">${medals[index]}</span>
                        <span class="font-medium">${player.name}</span>
                    </div>
                    <span class="font-bold text-purple-600">${player.score.toLocaleString()} pts</span>
                </div>
            `).join('');
        }

        function endTournament() {
            document.getElementById('tournamentContent').classList.add('hidden');
            document.getElementById('tournamentResults').classList.remove('hidden');
            
            document.getElementById('finalTournamentScore').textContent = tournamentData.score.toLocaleString();
            document.getElementById('finalTournamentRank').textContent = tournamentData.playerRank;
            
            // Calculer la r√©compense
            let reward = 50;
            if (tournamentData.playerRank <= 10) {
                reward = 500;
                document.getElementById('tournamentResultIcon').textContent = 'üèÜ';
                document.getElementById('tournamentResultText').textContent = 'Top 10 mondial !';
            } else if (tournamentData.playerRank <= 50) {
                reward = 300;
                document.getElementById('tournamentResultIcon').textContent = 'ü•á';
                document.getElementById('tournamentResultText').textContent = 'Excellent classement !';
            } else if (tournamentData.playerRank <= 100) {
                reward = 200;
                document.getElementById('tournamentResultIcon').textContent = 'üéâ';
                document.getElementById('tournamentResultText').textContent = 'Bon tournoi !';
            } else {
                document.getElementById('tournamentResultIcon').textContent = 'üëè';
                document.getElementById('tournamentResultText').textContent = 'Tournoi termin√© !';
            }
            
            document.getElementById('tournamentReward').textContent = `+${reward} XP`;
            
            showNotification(`üèÜ Tournoi termin√© ! Classement: ${tournamentData.playerRank}/2,847`);
        }

        function restartTournament() {
            document.getElementById('tournamentContent').classList.remove('hidden');
            document.getElementById('tournamentResults').classList.add('hidden');
            startTournament();
        }

        function joinNewTournament() {
            showNotification('üéØ Recherche d\'un nouveau tournoi...');
            setTimeout(() => {
                restartTournament();
            }, 1000);
        }

        function closeTournamentModal() {
            clearInterval(tournamentData.timer);
            document.getElementById('tournamentModal').classList.add('hidden');
            document.getElementById('tournamentModal').classList.remove('flex');
        }

        // Mystery game functions
        function startMysteryGame() {
            mysteryData.currentMystery = 0;
            mysteryData.score = 0;
            mysteryData.hintsUsed = 0;
            mysteryData.startTime = Date.now();
            
            document.getElementById('mysteryModal').classList.remove('hidden');
            document.getElementById('mysteryModal').classList.add('flex');
            
            loadCurrentMystery();
        }

        function loadCurrentMystery() {
            const current = mysteryData.mysteries[mysteryData.currentMystery];
            
            document.getElementById('mysteryQuestion').textContent = current.question;
            document.getElementById('mysteryNumber').textContent = mysteryData.currentMystery + 1;
            document.getElementById('mysteryScore').textContent = mysteryData.score;
            document.getElementById('mysteryHints').textContent = mysteryData.maxHints - mysteryData.hintsUsed;
            document.getElementById('mysteryAnswer').value = '';
            
            // R√©initialiser l'interface
            document.getElementById('mysteryContent').classList.remove('hidden');
            document.getElementById('mysteryResults').classList.add('hidden');
            document.getElementById('hintsContainer').classList.add('hidden');
            document.getElementById('hintsList').innerHTML = '';
            
            // Mettre √† jour le bouton d'indice
            const hintBtn = document.getElementById('hintBtn');
            const hintsLeft = mysteryData.maxHints - mysteryData.hintsUsed;
            if (hintsLeft > 0) {
                hintBtn.textContent = `üí° Demander un indice (${hintsLeft} restants)`;
                hintBtn.disabled = false;
                hintBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                hintBtn.textContent = 'üí° Plus d\'indices disponibles';
                hintBtn.disabled = true;
                hintBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
            
            mysteryData.startTime = Date.now();
        }

        function checkMysteryAnswer() {
            const userAnswer = document.getElementById('mysteryAnswer').value.toLowerCase().trim();
            const current = mysteryData.mysteries[mysteryData.currentMystery];
            
            if (!userAnswer) {
                showNotification('‚ùì √âcris ta r√©ponse d\'abord !');
                return;
            }
            
            const isCorrect = current.answer.some(answer => 
                userAnswer === answer.toLowerCase() || 
                userAnswer.includes(answer.toLowerCase())
            );
            
            const timeTaken = Math.floor((Date.now() - mysteryData.startTime) / 1000);
            
            document.getElementById('mysteryContent').classList.add('hidden');
            document.getElementById('mysteryResults').classList.remove('hidden');
            
            if (isCorrect) {
                // Calculer le score
                let points = 100;
                const timeBonus = Math.max(0, 60 - timeTaken) * 2; // Bonus de temps
                const hintPenalty = mysteryData.hintsUsed * 10; // P√©nalit√© pour les indices
                const totalPoints = Math.max(10, points + timeBonus - hintPenalty);
                
                mysteryData.score += totalPoints;
                
                document.getElementById('mysteryResultIcon').textContent = 'üéâ';
                document.getElementById('mysteryResultText').textContent = 'Myst√®re r√©solu !';
                document.getElementById('finalMysteryScore').textContent = `+${totalPoints}`;
                
                showNotification(`üéâ Correct ! +${totalPoints} points`);
            } else {
                document.getElementById('mysteryResultIcon').textContent = '‚ùå';
                document.getElementById('mysteryResultText').textContent = 'Pas tout √† fait...';
                document.getElementById('finalMysteryScore').textContent = '0';
                
                showNotification(`‚ùå La r√©ponse √©tait : ${current.answer[0]}`);
            }
            
            document.getElementById('mysteryTime').textContent = timeTaken + 's';
            document.getElementById('mysteryExplanation').textContent = current.explanation;
        }

        function getMysteryHint() {
            if (mysteryData.hintsUsed >= mysteryData.maxHints) {
                showNotification('üí° Plus d\'indices disponibles !');
                return;
            }
            
            const current = mysteryData.mysteries[mysteryData.currentMystery];
            const hint = current.hints[mysteryData.hintsUsed];
            
            // Afficher le conteneur des indices
            document.getElementById('hintsContainer').classList.remove('hidden');
            
            // Ajouter le nouvel indice
            const hintsList = document.getElementById('hintsList');
            const hintElement = document.createElement('div');
            hintElement.className = 'text-sm text-yellow-700';
            hintElement.textContent = `${mysteryData.hintsUsed + 1}. ${hint}`;
            hintsList.appendChild(hintElement);
            
            mysteryData.hintsUsed++;
            
            // Mettre √† jour l'affichage
            document.getElementById('mysteryHints').textContent = mysteryData.maxHints - mysteryData.hintsUsed;
            
            // Mettre √† jour le bouton d'indice
            const hintBtn = document.getElementById('hintBtn');
            const hintsLeft = mysteryData.maxHints - mysteryData.hintsUsed;
            if (hintsLeft > 0) {
                hintBtn.textContent = `üí° Demander un indice (${hintsLeft} restants)`;
            } else {
                hintBtn.textContent = 'üí° Plus d\'indices disponibles';
                hintBtn.disabled = true;
                hintBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
            
            showNotification(`üí° Indice r√©v√©l√© ! ${hintsLeft} restants`);
        }

        function handleMysteryKeyPress(event) {
            if (event.key === 'Enter') {
                checkMysteryAnswer();
            }
        }

        function nextMystery() {
            if (mysteryData.currentMystery < mysteryData.mysteries.length - 1) {
                mysteryData.currentMystery++;
                mysteryData.hintsUsed = 0; // R√©initialiser les indices pour le nouveau myst√®re
                loadCurrentMystery();
            } else {
                // Fin du jeu
                showFinalMysteryResults();
            }
        }

        function skipMystery() {
            if (confirm('Es-tu s√ªr de vouloir passer ce myst√®re ? Tu ne gagneras aucun point.')) {
                nextMystery();
                showNotification('‚è≠Ô∏è Myst√®re pass√©');
            }
        }

        function showFinalMysteryResults() {
            document.getElementById('mysteryContent').classList.add('hidden');
            document.getElementById('mysteryResults').classList.remove('hidden');
            
            document.getElementById('mysteryResultIcon').textContent = 'üèÜ';
            document.getElementById('mysteryResultText').textContent = 'Tous les myst√®res termin√©s !';
            document.getElementById('finalMysteryScore').textContent = mysteryData.score;
            document.getElementById('mysteryTime').textContent = 'Fini !';
            document.getElementById('mysteryExplanation').textContent = `F√©licitations ! Tu as termin√© tous les myst√®res bibliques avec un score de ${mysteryData.score} points. Tu es un vrai d√©tective de la Bible ! üïµÔ∏è‚Äç‚ôÇÔ∏è`;
            
            // Cacher le bouton "Myst√®re suivant"
            const nextBtn = document.querySelector('[onclick="nextMystery()"]');
            if (nextBtn) {
                nextBtn.style.display = 'none';
            }
        }

        function restartMysteryGame() {
            mysteryData.currentMystery = 0;
            mysteryData.score = 0;
            mysteryData.hintsUsed = 0;
            
            // R√©afficher le bouton "Myst√®re suivant"
            const nextBtn = document.querySelector('[onclick="nextMystery()"]');
            if (nextBtn) {
                nextBtn.style.display = 'block';
            }
            
            loadCurrentMystery();
        }

        function closeMysteryModal() {
            document.getElementById('mysteryModal').classList.add('hidden');
            document.getElementById('mysteryModal').classList.remove('flex');
        }

        // Spiritual Journey data
        let journeyData = {
            currentJourney: 1, // 1 = Fondations, 2 = Vie de J√©sus, 3 = Vie de Joseph, etc.
            currentDay: 1,
            totalDays: 40,
            completedSteps: 0,
            totalSteps: 5,
            xp: 0,
            level: 1,
            badges: [],
            streak: 0,
            completedJourneys: [],
            steps: [
                { id: 1, title: 'üìñ Lire Jean 3:16', description: 'M√©dite sur l\'amour de Dieu', completed: false },
                { id: 2, title: 'üôè Prier 5 minutes', description: 'Parle √† Dieu de ton c≈ìur', completed: false },
                { id: 3, title: '‚úçÔ∏è √âcrire une gratitude', description: 'Note une chose pour laquelle tu es reconnaissant', completed: false },
                { id: 4, title: 'üíù Acte de bont√©', description: 'Fais quelque chose de gentil pour quelqu\'un', completed: false },
                { id: 5, title: 'üéØ R√©flexion du jour', description: 'R√©ponds √† la question de r√©flexion', completed: false }
            ],
            journeys: {
                1: {
                    title: 'üå± Les Fondations',
                    subtitle: 'Parcours spirituel de base',
                    description: 'D√©couvre les piliers essentiels de la foi chr√©tienne en 40 jours',
                    color: 'from-emerald-500 to-teal-600',
                    totalDays: 40,
                    dailyThemes: [
                        { day: 1, title: 'üå± Les Fondations', description: 'Pose les bases de ton parcours spirituel. D√©couvre les piliers de la foi chr√©tienne.' },
                        { day: 2, title: 'üôè La Pri√®re', description: 'Apprends √† communiquer avec Dieu et √† d√©velopper une vie de pri√®re authentique.' },
                        { day: 3, title: 'üìñ La Parole', description: 'D√©couvre comment la Bible peut transformer ta vie quotidienne et te guider.' },
                        { day: 4, title: '‚ù§Ô∏è L\'Amour', description: 'Explore l\'amour de Dieu et comment l\'exprimer envers les autres.' },
                        { day: 5, title: 'üïäÔ∏è La Paix', description: 'Trouve la paix int√©rieure qui vient de Dieu, m√™me dans les temp√™tes.' },
                        { day: 6, title: 'üí™ La Force', description: 'D√©couvre la force qui vient de Dieu pour surmonter les d√©fis.' },
                        { day: 7, title: 'üåü L\'Espoir', description: 'Cultive l\'espoir qui ne d√©√ßoit jamais, ancr√© en Christ.' },
                        { day: 8, title: 'üéµ La Louange', description: 'Apprends √† louer Dieu dans toutes les circonstances.' },
                        { day: 9, title: 'ü§ù La Communion', description: 'D√©couvre l\'importance de la communaut√© chr√©tienne.' },
                        { day: 10, title: 'üî• La Passion', description: 'D√©veloppe une passion ardente pour Dieu et sa mission.' },
                        { day: 11, title: 'üõ°Ô∏è La Foi', description: 'Renforce ta foi et apprends √† faire confiance √† Dieu.' },
                        { day: 12, title: 'üéÅ La Gr√¢ce', description: 'Comprends la gr√¢ce immense de Dieu envers toi.' },
                        { day: 13, title: 'üîÑ Le Pardon', description: 'Apprends √† pardonner comme Dieu te pardonne.' },
                        { day: 14, title: 'üåà L\'Alliance', description: 'D√©couvre les promesses de Dieu pour ta vie.' },
                        { day: 15, title: '‚öñÔ∏è La Justice', description: 'Comprends la justice et la mis√©ricorde de Dieu.' },
                        { day: 16, title: 'üïØÔ∏è La Lumi√®re', description: 'Sois une lumi√®re dans ce monde.' },
                        { day: 17, title: 'üß≠ La Direction', description: 'Laisse Dieu guider tes pas.' },
                        { day: 18, title: 'üéØ Le But', description: 'D√©couvre le plan de Dieu pour ta vie.' },
                        { day: 19, title: 'üåä Le Bapt√™me', description: 'Comprends la signification du bapt√™me.' },
                        { day: 20, title: 'üçû La Communion', description: 'M√©dite sur le sacrifice de J√©sus.' },
                        { day: 21, title: 'üëë La Royaut√©', description: 'Tu es enfant du Roi des rois.' },
                        { day: 22, title: 'üé™ La Joie', description: 'Trouve la joie parfaite en Dieu.' },
                        { day: 23, title: 'üåø La Croissance', description: 'Grandis spirituellement chaque jour.' },
                        { day: 24, title: 'üî• L\'Esprit Saint', description: 'D√©couvre le r√¥le de l\'Esprit Saint.' },
                        { day: 25, title: 'üìØ Le T√©moignage', description: 'Partage ta foi avec les autres.' },
                        { day: 26, title: 'üèîÔ∏è Les D√©fis', description: 'Surmonte les obstacles avec Dieu.' },
                        { day: 27, title: 'üåÖ Le Renouveau', description: 'Chaque jour est un nouveau commencement.' },
                        { day: 28, title: 'üé≠ L\'Identit√©', description: 'D√©couvre qui tu es en Christ.' },
                        { day: 29, title: 'üåç La Mission', description: 'Trouve ta mission dans le monde.' },
                        { day: 30, title: '‚≠ê La Gloire', description: 'Rends gloire √† Dieu en toutes choses.' },
                        { day: 31, title: 'üîó L\'Unit√©', description: 'Vis l\'unit√© avec tes fr√®res et s≈ìurs.' },
                        { day: 32, title: 'üé® La Cr√©ativit√©', description: 'Utilise tes talents pour Dieu.' },
                        { day: 33, title: 'üèÉ‚Äç‚ôÇÔ∏è La Pers√©v√©rance', description: 'Continue malgr√© les difficult√©s.' },
                        { day: 34, title: 'üé™ La C√©l√©bration', description: 'C√©l√®bre les victoires de Dieu.' },
                        { day: 35, title: 'üå± Les Fruits', description: 'Porte du fruit dans ta vie.' },
                        { day: 36, title: 'üè† La Famille', description: 'D√©couvre la famille de Dieu.' },
                        { day: 37, title: 'üíé La Valeur', description: 'Tu as une valeur inestimable aux yeux de Dieu.' },
                        { day: 38, title: 'üåü La Transformation', description: 'Laisse Dieu te transformer.' },
                        { day: 39, title: 'üéØ L\'H√©ritage', description: 'Pr√©pare l\'h√©ritage que tu laisseras.' },
                        { day: 40, title: 'üëë La Victoire', description: 'C√©l√®bre la victoire finale en Christ.' }
                    ]
                },
                2: {
                    title: '‚úùÔ∏è La Vie de J√©sus',
                    subtitle: 'Suivre les pas du Sauveur',
                    description: 'D√©couvre la vie, les enseignements et l\'≈ìuvre de J√©sus-Christ en 40 jours',
                    color: 'from-blue-500 to-purple-600',
                    totalDays: 40,
                    dailyThemes: [
                        { day: 1, title: 'üåü L\'Annonciation', description: 'L\'ange Gabriel annonce √† Marie qu\'elle portera le Sauveur.' },
                        { day: 2, title: 'üë∂ La Naissance', description: 'J√©sus na√Æt √† Bethl√©em, accomplissant les proph√©ties.' },
                        { day: 3, title: '‚≠ê Les Mages', description: 'Les mages d\'Orient viennent adorer le nouveau-n√©.' },
                        { day: 4, title: 'üèÉ‚Äç‚ôÇÔ∏è La Fuite en √âgypte', description: 'Joseph et Marie fuient en √âgypte pour prot√©ger J√©sus.' },
                        { day: 5, title: 'üèõÔ∏è J√©sus au Temple', description: '√Ä 12 ans, J√©sus √©tonne les docteurs au temple.' },
                        { day: 6, title: 'üî® Le Charpentier', description: 'J√©sus grandit et apprend le m√©tier de charpentier.' },
                        { day: 7, title: 'üåä Le Bapt√™me', description: 'Jean-Baptiste baptise J√©sus dans le Jourdain.' },
                        { day: 8, title: 'üèúÔ∏è La Tentation', description: 'J√©sus je√ªne 40 jours et r√©siste aux tentations de Satan.' },
                        { day: 9, title: 'üë• Les Premiers Disciples', description: 'J√©sus appelle ses premiers disciples.' },
                        { day: 10, title: 'üíí Les Noces de Cana', description: 'Premier miracle : J√©sus change l\'eau en vin.' },
                        { day: 11, title: 'üèõÔ∏è Purification du Temple', description: 'J√©sus chasse les marchands du temple.' },
                        { day: 12, title: 'üåô Nicod√®me', description: 'J√©sus explique la nouvelle naissance √† Nicod√®me.' },
                        { day: 13, title: 'üíß La Samaritaine', description: 'J√©sus r√©v√®le qu\'il est l\'eau vive.' },
                        { day: 14, title: 'üçû Multiplication des Pains', description: 'J√©sus nourrit 5000 personnes avec 5 pains.' },
                        { day: 15, title: 'üåä Marche sur l\'Eau', description: 'J√©sus marche sur les eaux du lac.' },
                        { day: 16, title: 'üëÅÔ∏è Gu√©rison de l\'Aveugle', description: 'J√©sus redonne la vue √† un aveugle-n√©.' },
                        { day: 17, title: 'üêë Le Bon Berger', description: 'J√©sus se r√©v√®le comme le bon berger.' },
                        { day: 18, title: 'üíÄ R√©surrection de Lazare', description: 'J√©sus ressuscite son ami Lazare.' },
                        { day: 19, title: 'üë∂ J√©sus et les Enfants', description: 'Laissez venir √† moi les petits enfants.' },
                        { day: 20, title: 'üí∞ Le Jeune Homme Riche', description: 'J√©sus parle des richesses et du royaume.' },
                        { day: 21, title: 'üå¥ Entr√©e Triomphale', description: 'J√©sus entre √† J√©rusalem sur un √¢non.' },
                        { day: 22, title: 'üèõÔ∏è Enseignement au Temple', description: 'J√©sus enseigne dans le temple.' },
                        { day: 23, title: 'üïØÔ∏è Les Vierges Sages', description: 'Parabole sur la vigilance.' },
                        { day: 24, title: 'üí∞ Les Talents', description: 'Parabole sur la fid√©lit√©.' },
                        { day: 25, title: 'üêë Le Jugement Final', description: 'J√©sus parle du jugement des nations.' },
                        { day: 26, title: 'üí∏ La Trahison', description: 'Judas trahit J√©sus pour 30 pi√®ces d\'argent.' },
                        { day: 27, title: 'üçû La C√®ne', description: 'Le dernier repas de J√©sus avec ses disciples.' },
                        { day: 28, title: 'ü´í Geths√©man√©', description: 'J√©sus prie avec angoisse au jardin.' },
                        { day: 29, title: '‚õìÔ∏è L\'Arrestation', description: 'J√©sus est arr√™t√© et abandonn√©.' },
                        { day: 30, title: '‚öñÔ∏è Le Proc√®s', description: 'J√©sus compara√Æt devant Pilate.' },
                        { day: 31, title: 'üëë La Couronne d\'√âpines', description: 'J√©sus est moqu√© et couronn√© d\'√©pines.' },
                        { day: 32, title: '‚úùÔ∏è Le Chemin de Croix', description: 'J√©sus porte sa croix vers le Golgotha.' },
                        { day: 33, title: '‚ö∞Ô∏è La Crucifixion', description: 'J√©sus meurt sur la croix pour nos p√©ch√©s.' },
                        { day: 34, title: 'ü™¶ La Mise au Tombeau', description: 'Le corps de J√©sus est enseveli.' },
                        { day: 35, title: 'üåÖ La R√©surrection', description: 'J√©sus ressuscite le troisi√®me jour !' },
                        { day: 36, title: 'üë© Marie-Madeleine', description: 'Premi√®re t√©moin de la r√©surrection.' },
                        { day: 37, title: 'üö∂‚Äç‚ôÇÔ∏è Emma√ºs', description: 'J√©sus appara√Æt aux disciples d\'Emma√ºs.' },
                        { day: 38, title: 'üêü P√™che Miraculeuse', description: 'J√©sus appara√Æt aux disciples p√™cheurs.' },
                        { day: 39, title: '‚òÅÔ∏è L\'Ascension', description: 'J√©sus monte au ciel devant ses disciples.' },
                        { day: 40, title: 'üî• La Pentec√¥te', description: 'L\'Esprit Saint descend sur les disciples.' }
                    ]
                },
                3: {
                    title: 'üåà La Vie de Joseph',
                    subtitle: 'De l\'√©preuve √† la gloire',
                    description: 'D√©couvre l\'histoire inspirante de Joseph, de ses r√™ves √† son r√®gne en √âgypte',
                    color: 'from-yellow-500 to-orange-600',
                    totalDays: 40,
                    dailyThemes: [
                        { day: 1, title: 'üë∂ La Naissance de Joseph', description: 'Joseph na√Æt, fils bien-aim√© de Jacob et Rachel.' },
                        { day: 2, title: 'üåà Le Manteau Multicolore', description: 'Jacob offre √† Joseph un manteau sp√©cial.' },
                        { day: 3, title: 'üí≠ Les Premiers R√™ves', description: 'Joseph r√™ve que ses fr√®res se prosternent devant lui.' },
                        { day: 4, title: 'üò† La Jalousie des Fr√®res', description: 'Les fr√®res de Joseph deviennent jaloux.' },
                        { day: 5, title: 'üêë Gardien de Troupeaux', description: 'Joseph aide son p√®re √† surveiller les troupeaux.' },
                        { day: 6, title: 'üì∞ Le Rapport', description: 'Joseph rapporte les mauvaises actions de ses fr√®res.' },
                        { day: 7, title: 'üåæ Le R√™ve des Gerbes', description: 'Joseph r√™ve de gerbes qui se prosternent.' },
                        { day: 8, title: '‚≠ê Le R√™ve des Astres', description: 'Le soleil, la lune et les √©toiles se prosternent.' },
                        { day: 9, title: 'üó£Ô∏è Joseph Raconte ses R√™ves', description: 'Joseph partage ses r√™ves avec sa famille.' },
                        { day: 10, title: 'üò§ La Col√®re de Jacob', description: 'M√™me Jacob r√©primande Joseph pour ses r√™ves.' },
                        { day: 11, title: 'üö∂‚Äç‚ôÇÔ∏è Mission √† Sichem', description: 'Jacob envoie Joseph chercher ses fr√®res.' },
                        { day: 12, title: 'üîç La Recherche', description: 'Joseph cherche ses fr√®res dans les p√¢turages.' },
                        { day: 13, title: 'üëÅÔ∏è "Voici le Faiseur de R√™ves"', description: 'Les fr√®res voient Joseph arriver de loin.' },
                        { day: 14, title: 'üíÄ Le Complot', description: 'Les fr√®res complotent pour tuer Joseph.' },
                        { day: 15, title: 'üï≥Ô∏è La Citerne', description: 'Ruben sauve Joseph en le jetant dans une citerne.' },
                        { day: 16, title: 'üçû Le Repas Cruel', description: 'Les fr√®res mangent pendant que Joseph crie.' },
                        { day: 17, title: 'üê™ Les Marchands', description: 'Une caravane d\'Isma√©lites passe par l√†.' },
                        { day: 18, title: 'üí∞ La Vente', description: 'Joseph est vendu pour 20 pi√®ces d\'argent.' },
                        { day: 19, title: 'ü©∏ Le Mensonge', description: 'Les fr√®res trempent le manteau dans le sang.' },
                        { day: 20, title: 'üò≠ La Douleur de Jacob', description: 'Jacob pleure son fils qu\'il croit mort.' },
                        { day: 21, title: 'üè∫ Chez Potiphar', description: 'Joseph devient serviteur chez Potiphar.' },
                        { day: 22, title: 'üìà La B√©n√©diction', description: 'Dieu b√©nit tout ce que fait Joseph.' },
                        { day: 23, title: 'üëë Intendant de la Maison', description: 'Potiphar confie tout √† Joseph.' },
                        { day: 24, title: 'üë© La Tentation', description: 'La femme de Potiphar tente de s√©duire Joseph.' },
                        { day: 25, title: 'üèÉ‚Äç‚ôÇÔ∏è La Fuite', description: 'Joseph fuit la tentation et reste pur.' },
                        { day: 26, title: 'ü§• L\'Accusation', description: 'La femme accuse faussement Joseph.' },
                        { day: 27, title: '‚õìÔ∏è La Prison', description: 'Joseph est injustement emprisonn√©.' },
                        { day: 28, title: 'üîë Chef des Prisonniers', description: 'Dieu donne faveur √† Joseph en prison.' },
                        { day: 29, title: 'üç∑ L\'√âchanson et le Panetier', description: 'Joseph interpr√®te leurs r√™ves.' },
                        { day: 30, title: 'üòî L\'Oubli', description: 'L\'√©chanson oublie Joseph pendant 2 ans.' },
                        { day: 31, title: 'üëë Les R√™ves de Pharaon', description: 'Pharaon fait des r√™ves troublants.' },
                        { day: 32, title: 'üí° Le Souvenir', description: 'L\'√©chanson se souvient enfin de Joseph.' },
                        { day: 33, title: 'üèÉ‚Äç‚ôÇÔ∏è L\'Appel du Palais', description: 'Joseph est amen√© devant Pharaon.' },
                        { day: 34, title: 'üêÑ Interpr√©tation des R√™ves', description: 'Joseph r√©v√®le le sens des r√™ves.' },
                        { day: 35, title: 'üåæ 7 Ann√©es d\'Abondance', description: 'Joseph pr√©dit 7 ann√©es de prosp√©rit√©.' },
                        { day: 36, title: 'üíÄ 7 Ann√©es de Famine', description: 'Puis 7 ann√©es de famine terrible.' },
                        { day: 37, title: 'üëë Vice-Roi d\'√âgypte', description: 'Pharaon √©l√®ve Joseph au plus haut rang.' },
                        { day: 38, title: 'üíç L\'Anneau Royal', description: 'Joseph re√ßoit l\'anneau et les insignes.' },
                        { day: 39, title: 'üë∞ Mariage et Famille', description: 'Joseph √©pouse Asnath et a deux fils.' },
                        { day: 40, title: 'üåç Sauveur de l\'√âgypte', description: 'Joseph sauve l\'√âgypte et les nations.' }
                    ]
                }
            }
        };

        // Spiritual Journey functions
        function startSpiritualJourney() {
            document.getElementById('spiritualJourneyModal').classList.remove('hidden');
            document.getElementById('spiritualJourneyModal').classList.add('flex');
            
            updateJourneyDisplay();
        }

        function updateJourneyDisplay() {
            const currentJourney = journeyData.journeys[journeyData.currentJourney];
            const currentTheme = currentJourney.dailyThemes[journeyData.currentDay - 1] || currentJourney.dailyThemes[0];
            
            // Mettre √† jour les informations du parcours actuel
            document.getElementById('currentJourneyTitle').textContent = currentJourney.title;
            document.getElementById('currentJourneySubtitle').textContent = currentJourney.subtitle;
            document.getElementById('currentJourneyProgress').textContent = `${journeyData.currentDay}/${currentJourney.totalDays}`;
            
            // Mettre √† jour la carte du parcours avec la bonne couleur
            const currentJourneyCard = document.getElementById('currentJourneyCard');
            currentJourneyCard.className = `bg-gradient-to-r ${currentJourney.color} text-white rounded-xl p-3 mb-2`;
            
            // Mettre √† jour la carte du th√®me quotidien
            const dailyThemeCard = document.getElementById('dailyThemeCard');
            dailyThemeCard.className = `bg-gradient-to-r ${currentJourney.color} text-white rounded-xl p-4 mb-4`;
            
            document.getElementById('journeyDay').textContent = journeyData.currentDay;
            document.getElementById('journeySteps').textContent = journeyData.completedSteps;
            document.getElementById('journeyXP').textContent = journeyData.xp;
            document.getElementById('journeyTitle').textContent = currentTheme.title;
            document.getElementById('journeyDescription').textContent = currentTheme.description;
            
            // Mettre √† jour la barre de progression
            const progress = (journeyData.completedSteps / journeyData.totalSteps) * 100;
            document.getElementById('journeyProgress').textContent = Math.round(progress) + '%';
            document.getElementById('journeyProgressBar').style.width = progress + '%';
            
            updateJourneySteps();
        }

        // Fonctions pour le s√©lecteur de parcours
        function showJourneySelector() {
            document.getElementById('journeySelectorModal').classList.remove('hidden');
            document.getElementById('journeySelectorModal').classList.add('flex');
            updateJourneySelectorDisplay();
        }

        function closeJourneySelector() {
            document.getElementById('journeySelectorModal').classList.add('hidden');
            document.getElementById('journeySelectorModal').classList.remove('flex');
        }

        function selectJourney(journeyId) {
            // V√©rifier si le parcours est d√©bloqu√©
            if (journeyId === 1) {
                // Parcours 1 toujours disponible
                switchToJourney(journeyId);
            } else if (journeyId === 2 && journeyData.completedJourneys.includes(1)) {
                // Parcours 2 d√©bloqu√© apr√®s avoir termin√© le parcours 1
                switchToJourney(journeyId);
            } else if (journeyId === 3 && journeyData.completedJourneys.includes(2)) {
                // Parcours 3 d√©bloqu√© apr√®s avoir termin√© le parcours 2
                switchToJourney(journeyId);
            } else {
                // Parcours verrouill√©
                showNotification('üîí Ce parcours sera d√©bloqu√© apr√®s avoir termin√© le pr√©c√©dent !');
                return;
            }
            
            closeJourneySelector();
        }

        function switchToJourney(journeyId) {
            journeyData.currentJourney = journeyId;
            journeyData.currentDay = 1;
            journeyData.completedSteps = 0;
            
            // R√©initialiser les √©tapes
            journeyData.steps.forEach(step => {
                step.completed = false;
            });
            
            // Mettre √† jour les √©tapes pour le nouveau parcours
            updateDailyStepsForJourney();
            updateJourneyDisplay();
            
            const currentJourney = journeyData.journeys[journeyId];
            showNotification(`üéØ Parcours "${currentJourney.title}" s√©lectionn√© !`);
        }

        function updateJourneySelectorDisplay() {
            // Mettre √† jour l'√©tat des parcours dans le s√©lecteur
            const journey1 = document.querySelector('[onclick="selectJourney(1)"]');
            const journey2 = document.querySelector('[onclick="selectJourney(2)"]');
            const journey3 = document.querySelector('[onclick="selectJourney(3)"]');
            
            // Parcours 1 - toujours disponible
            if (journeyData.currentJourney === 1) {
                journey1.querySelector('.bg-emerald-100').textContent = 'En cours';
                journey1.querySelector('.bg-emerald-100').className = 'bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-xs font-bold';
            } else if (journeyData.completedJourneys.includes(1)) {
                journey1.querySelector('.bg-emerald-100').textContent = '‚úÖ Termin√©';
                journey1.querySelector('.bg-emerald-100').className = 'bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold';
            }
            
            // Parcours 2 - d√©bloqu√© apr√®s le parcours 1
            if (journeyData.completedJourneys.includes(1)) {
                if (journeyData.currentJourney === 2) {
                    journey2.querySelector('.bg-gray-100').textContent = 'En cours';
                    journey2.querySelector('.bg-gray-100').className = 'bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold';
                } else if (journeyData.completedJourneys.includes(2)) {
                    journey2.querySelector('.bg-gray-100').textContent = '‚úÖ Termin√©';
                    journey2.querySelector('.bg-gray-100').className = 'bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold';
                } else {
                    journey2.querySelector('.bg-gray-100').textContent = 'üîì Disponible';
                    journey2.querySelector('.bg-gray-100').className = 'bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold';
                }
                journey2.classList.remove('opacity-60');
                journey2.style.pointerEvents = 'auto';
            }
            
            // Parcours 3 - d√©bloqu√© apr√®s le parcours 2
            if (journeyData.completedJourneys.includes(2)) {
                if (journeyData.currentJourney === 3) {
                    journey3.querySelector('.bg-gray-100').textContent = 'En cours';
                    journey3.querySelector('.bg-gray-100').className = 'bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-xs font-bold';
                } else if (journeyData.completedJourneys.includes(3)) {
                    journey3.querySelector('.bg-gray-100').textContent = '‚úÖ Termin√©';
                    journey3.querySelector('.bg-gray-100').className = 'bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold';
                } else {
                    journey3.querySelector('.bg-gray-100').textContent = 'üîì Disponible';
                    journey3.querySelector('.bg-gray-100').className = 'bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-xs font-bold';
                }
                journey3.classList.remove('opacity-60');
                journey3.style.pointerEvents = 'auto';
            }
        }

        function updateJourneySteps() {
            const stepsContainer = document.getElementById('journeyStepsContainer');
            
            stepsContainer.innerHTML = journeyData.steps.map((step, index) => {
                const isCompleted = step.completed;
                const isAvailable = index === 0 || journeyData.steps[index - 1].completed;
                const isLocked = !isAvailable && !isCompleted;
                
                let bgClass, borderClass, textClass, iconBg, statusIcon, opacity;
                
                if (isCompleted) {
                    bgClass = 'bg-green-50';
                    borderClass = 'border-green-200';
                    textClass = 'text-green-800';
                    iconBg = 'bg-green-500';
                    statusIcon = '‚úÖ';
                    opacity = '';
                } else if (isAvailable) {
                    bgClass = 'bg-emerald-50';
                    borderClass = 'border-emerald-200';
                    textClass = 'text-emerald-800';
                    iconBg = 'bg-emerald-500';
                    statusIcon = '‚è≥';
                    opacity = '';
                } else {
                    bgClass = 'bg-gray-50';
                    borderClass = 'border-gray-200';
                    textClass = 'text-gray-600';
                    iconBg = 'bg-gray-400';
                    statusIcon = 'üîí';
                    opacity = 'opacity-50';
                }
                
                const clickHandler = isAvailable && !isCompleted ? `onclick="completeJourneyStep(${step.id})"` : '';
                const cursor = isAvailable && !isCompleted ? 'cursor-pointer hover:bg-emerald-100' : '';
                
                return `
                    <div class="flex items-center p-3 ${bgClass} rounded-xl border ${borderClass} ${cursor} transition-all ${opacity}" ${clickHandler}>
                        <div class="w-8 h-8 ${iconBg} rounded-full flex items-center justify-center text-white text-sm mr-3">
                            <span>${isCompleted ? '‚úì' : step.id}</span>
                        </div>
                        <div class="flex-1">
                            <p class="font-semibold ${textClass} text-sm">${step.title}</p>
                            <p class="text-xs ${textClass.replace('800', '600')}">${step.description}</p>
                        </div>
                        <div class="${textClass.replace('800', '600')}">${statusIcon}</div>
                    </div>
                `;
            }).join('');
        }

        function completeJourneyStep(stepId) {
            const step = journeyData.steps.find(s => s.id === stepId);
            if (!step || step.completed) return;
            
            // V√©rifier si l'√©tape est disponible
            const stepIndex = journeyData.steps.findIndex(s => s.id === stepId);
            const isAvailable = stepIndex === 0 || journeyData.steps[stepIndex - 1].completed;
            
            if (!isAvailable) {
                showNotification('üîí Compl√®te d\'abord l\'√©tape pr√©c√©dente !');
                return;
            }
            
            step.completed = true;
            journeyData.completedSteps++;
            journeyData.xp += 10;
            
            showNotification(`‚úÖ √âtape "${step.title}" compl√©t√©e ! +10 XP`);
            
            // V√©rifier si le jour est termin√©
            if (journeyData.completedSteps === journeyData.totalSteps) {
                setTimeout(() => {
                    completeDailyJourney();
                }, 1000);
            }
            
            updateJourneyDisplay();
        }

        function completeDailyJourney() {
            // Bonus de fin de jour
            journeyData.xp += 50;
            journeyData.streak++;
            
            const currentJourney = journeyData.journeys[journeyData.currentJourney];
            
            // Ajouter un badge selon le jour et le parcours
            const badges = {
                1: { // Parcours Fondations
                    1: 'üå± Fondation', 5: 'üïäÔ∏è Paix', 10: 'üî• Passion', 15: '‚öñÔ∏è Justice', 
                    20: 'üçû Communion', 25: 'üìØ T√©moignage', 30: '‚≠ê Gloire', 35: 'üå± Fruits', 40: 'üëë Victoire'
                },
                2: { // Parcours Vie de J√©sus
                    1: 'üåü Annonciation', 7: 'üåä Bapt√™me', 14: 'üçû Multiplication', 21: 'üå¥ Triomphe', 
                    27: 'üçû C√®ne', 33: '‚úùÔ∏è Crucifixion', 35: 'üåÖ R√©surrection', 39: '‚òÅÔ∏è Ascension', 40: 'üî• Pentec√¥te'
                },
                3: { // Parcours Vie de Joseph
                    2: 'üåà Manteau', 8: '‚≠ê R√™ves', 15: 'üï≥Ô∏è Citerne', 18: 'üí∞ Vente', 
                    25: 'üèÉ‚Äç‚ôÇÔ∏è Fuite', 27: '‚õìÔ∏è Prison', 34: 'üêÑ Interpr√©tation', 37: 'üëë Vice-Roi', 40: 'üåç Sauveur'
                }
            };
            
            const journeyBadges = badges[journeyData.currentJourney] || {};
            if (journeyBadges[journeyData.currentDay]) {
                journeyData.badges.push(journeyBadges[journeyData.currentDay]);
            }
            
            showNotification('üéâ Jour termin√© ! +50 XP bonus + Badge gagn√© !');
            
            // Pr√©parer le jour suivant automatiquement
            if (journeyData.currentDay < currentJourney.totalDays) {
                setTimeout(() => {
                    showNotification(`üåü Jour ${journeyData.currentDay} termin√© ! Passage automatique au jour suivant...`);
                    setTimeout(() => {
                        nextJourneyDay();
                    }, 1500);
                }, 2000);
            } else {
                // Parcours termin√©
                journeyData.completedJourneys.push(journeyData.currentJourney);
                showNotification(`üèÜ Parcours "${currentJourney.title}" termin√© ! Tu es un champion de la foi !`);
                
                // D√©bloquer le parcours suivant
                const nextJourneyId = journeyData.currentJourney + 1;
                if (journeyData.journeys[nextJourneyId]) {
                    setTimeout(() => {
                        showNotification(`üîì Nouveau parcours d√©bloqu√© : "${journeyData.journeys[nextJourneyId].title}" !`);
                    }, 2000);
                }
            }
        }

        function nextJourneyDay() {
            journeyData.currentDay++;
            journeyData.completedSteps = 0;
            
            // R√©initialiser les √©tapes
            journeyData.steps.forEach(step => {
                step.completed = false;
            });
            
            // Mettre √† jour les √©tapes pour le nouveau jour
            updateDailyStepsForJourney();
            updateJourneyDisplay();
            
            showNotification(`üåÖ Bienvenue au jour ${journeyData.currentDay} !`);
        }

        function updateDailyStepsForJourney() {
            const currentJourney = journeyData.journeys[journeyData.currentJourney];
            const currentDay = journeyData.currentDay;
            
            // √âtapes personnalis√©es selon le parcours et le jour
            if (journeyData.currentJourney === 1) {
                // Parcours Fondations - √©tapes g√©n√©riques spirituelles
                updateFoundationSteps(currentDay);
            } else if (journeyData.currentJourney === 2) {
                // Parcours Vie de J√©sus - √©tapes bas√©es sur les √©v√©nements
                updateJesusLifeSteps(currentDay);
            } else if (journeyData.currentJourney === 3) {
                // Parcours Vie de Joseph - √©tapes bas√©es sur l'histoire
                updateJosephLifeSteps(currentDay);
            }
        }

        function updateFoundationSteps(day) {
            const foundationSteps = {
                1: [
                    { id: 1, title: 'üìñ Lire Jean 3:16', description: 'M√©dite sur l\'amour de Dieu', completed: false },
                    { id: 2, title: 'üôè Prier 5 minutes', description: 'Parle √† Dieu de ton c≈ìur', completed: false },
                    { id: 3, title: '‚úçÔ∏è √âcrire une gratitude', description: 'Note une chose pour laquelle tu es reconnaissant', completed: false },
                    { id: 4, title: 'üíù Acte de bont√©', description: 'Fais quelque chose de gentil pour quelqu\'un', completed: false },
                    { id: 5, title: 'üéØ R√©flexion du jour', description: 'R√©ponds √† la question de r√©flexion', completed: false }
                ],
                2: [
                    { id: 1, title: 'üìñ Lire Matthieu 6:9-13', description: 'Apprends le Notre P√®re', completed: false },
                    { id: 2, title: 'üôè Prier 10 minutes', description: 'Utilise le Notre P√®re comme guide', completed: false },
                    { id: 3, title: '‚úçÔ∏è √âcrire une pri√®re', description: '√âcris ta propre pri√®re √† Dieu', completed: false },
                    { id: 4, title: 'üíù Prier pour quelqu\'un', description: 'Interc√®de pour une personne', completed: false },
                    { id: 5, title: 'üéØ R√©flexion sur la pri√®re', description: 'Comment la pri√®re change-t-elle ta vie ?', completed: false }
                ]
            };
            
            journeyData.steps = foundationSteps[day] || foundationSteps[1];
        }

        function updateJesusLifeSteps(day) {
            const jesusSteps = {
                1: [ // L'Annonciation
                    { id: 1, title: 'üìñ Lire Luc 1:26-38', description: 'L\'annonce de l\'ange Gabriel √† Marie', completed: false },
                    { id: 2, title: 'üôè Prier pour l\'ob√©issance', description: 'Comme Marie, dis "Qu\'il me soit fait selon ta parole"', completed: false },
                    { id: 3, title: '‚úçÔ∏è R√©flexion sur l\'appel', description: 'Quel est l\'appel de Dieu dans ta vie ?', completed: false },
                    { id: 4, title: 'üíù Encourager quelqu\'un', description: 'Partage une parole d\'encouragement', completed: false },
                    { id: 5, title: 'üéØ M√©ditation', description: 'M√©dite sur la foi de Marie', completed: false }
                ],
                2: [ // La Naissance
                    { id: 1, title: 'üìñ Lire Luc 2:1-20', description: 'La naissance de J√©sus √† Bethl√©em', completed: false },
                    { id: 2, title: 'üôè Remercier pour J√©sus', description: 'Remercie Dieu pour le don de son Fils', completed: false },
                    { id: 3, title: '‚úçÔ∏è Lettre √† J√©sus', description: '√âcris une lettre de bienvenue √† J√©sus', completed: false },
                    { id: 4, title: 'üíù Partager la joie', description: 'Partage la joie de No√´l avec quelqu\'un', completed: false },
                    { id: 5, title: 'üéØ Adoration', description: 'Adore J√©sus comme les bergers', completed: false }
                ],
                7: [ // Le Bapt√™me
                    { id: 1, title: 'üìñ Lire Matthieu 3:13-17', description: 'Le bapt√™me de J√©sus par Jean', completed: false },
                    { id: 2, title: 'üôè Prier pour ton bapt√™me', description: 'Si tu n\'es pas baptis√©, prie pour cette √©tape', completed: false },
                    { id: 3, title: '‚úçÔ∏è T√©moignage', description: '√âcris ton t√©moignage de foi', completed: false },
                    { id: 4, title: 'üíù Encourager un nouveau croyant', description: 'Aide quelqu\'un dans sa foi', completed: false },
                    { id: 5, title: 'üéØ Engagement', description: 'Renouvelle ton engagement envers J√©sus', completed: false }
                ]
            };
            
            journeyData.steps = jesusSteps[day] || jesusSteps[1];
        }

        function updateJosephLifeSteps(day) {
            const josephSteps = {
                1: [ // La Naissance de Joseph
                    { id: 1, title: 'üìñ Lire Gen√®se 30:22-24', description: 'La naissance de Joseph', completed: false },
                    { id: 2, title: 'üôè Remercier pour ta famille', description: 'Prie pour tes parents et proches', completed: false },
                    { id: 3, title: '‚úçÔ∏è Histoire familiale', description: '√âcris sur l\'amour dans ta famille', completed: false },
                    { id: 4, title: 'üíù Honorer tes parents', description: 'Fais quelque chose de sp√©cial pour eux', completed: false },
                    { id: 5, title: 'üéØ R√©flexion sur l\'identit√©', description: 'Qui es-tu aux yeux de Dieu ?', completed: false }
                ],
                2: [ // Le Manteau Multicolore
                    { id: 1, title: 'üìñ Lire Gen√®se 37:3-4', description: 'Le manteau sp√©cial de Joseph', completed: false },
                    { id: 2, title: 'üôè Prier contre la jalousie', description: 'Demande √† Dieu de garder ton c≈ìur pur', completed: false },
                    { id: 3, title: '‚úçÔ∏è Dons et talents', description: 'Liste tes dons uniques de Dieu', completed: false },
                    { id: 4, title: 'üíù C√©l√©brer les autres', description: 'F√©licite quelqu\'un pour ses r√©ussites', completed: false },
                    { id: 5, title: 'üéØ Humilit√©', description: 'Comment rester humble malgr√© les b√©n√©dictions ?', completed: false }
                ],
                18: [ // La Vente
                    { id: 1, title: 'üìñ Lire Gen√®se 37:25-28', description: 'Joseph vendu par ses fr√®res', completed: false },
                    { id: 2, title: 'üôè Prier pour tes ennemis', description: 'Prie pour ceux qui t\'ont fait du mal', completed: false },
                    { id: 3, title: '‚úçÔ∏è Pardon difficile', description: '√âcris sur une situation o√π tu dois pardonner', completed: false },
                    { id: 4, title: 'üíù Acte de pardon', description: 'Pardonne concr√®tement √† quelqu\'un', completed: false },
                    { id: 5, title: 'üéØ Confiance en Dieu', description: 'Comment faire confiance quand tout va mal ?', completed: false }
                ],
                37: [ // Vice-Roi d'√âgypte
                    { id: 1, title: 'üìñ Lire Gen√®se 41:37-44', description: 'Joseph devient vice-roi', completed: false },
                    { id: 2, title: 'üôè Remercier pour les victoires', description: 'Remercie Dieu pour ses b√©n√©dictions', completed: false },
                    { id: 3, title: '‚úçÔ∏è Plan de Dieu', description: 'Comment vois-tu le plan de Dieu dans ta vie ?', completed: false },
                    { id: 4, title: 'üíù Servir avec tes dons', description: 'Utilise tes talents pour aider les autres', completed: false },
                    { id: 5, title: 'üéØ Responsabilit√©', description: 'Comment bien g√©rer ce que Dieu te confie ?', completed: false }
                ]
            };
            
            journeyData.steps = josephSteps[day] || josephSteps[1];
        }

        function updateDailySteps() {
            // √âtapes diff√©rentes selon le jour
            const daySteps = {
                1: [
                    { id: 1, title: 'üìñ Lire Jean 3:16', description: 'M√©dite sur l\'amour de Dieu', completed: false },
                    { id: 2, title: 'üôè Prier 5 minutes', description: 'Parle √† Dieu de ton c≈ìur', completed: false },
                    { id: 3, title: '‚úçÔ∏è √âcrire une gratitude', description: 'Note une chose pour laquelle tu es reconnaissant', completed: false },
                    { id: 4, title: 'üíù Acte de bont√©', description: 'Fais quelque chose de gentil pour quelqu\'un', completed: false },
                    { id: 5, title: 'üéØ R√©flexion du jour', description: 'R√©ponds √† la question de r√©flexion', completed: false }
                ],
                2: [
                    { id: 1, title: 'üìñ Lire Matthieu 6:9-13', description: 'Apprends le Notre P√®re', completed: false },
                    { id: 2, title: 'üôè Prier 10 minutes', description: 'Utilise le Notre P√®re comme guide', completed: false },
                    { id: 3, title: '‚úçÔ∏è √âcrire une pri√®re', description: '√âcris ta propre pri√®re √† Dieu', completed: false },
                    { id: 4, title: 'üíù Prier pour quelqu\'un', description: 'Interc√®de pour une personne', completed: false },
                    { id: 5, title: 'üéØ R√©flexion sur la pri√®re', description: 'Comment la pri√®re change-t-elle ta vie ?', completed: false }
                ],
                3: [
                    { id: 1, title: 'üìñ Lire Psaume 119:105', description: 'La Parole comme lumi√®re', completed: false },
                    { id: 2, title: 'üôè Prier avec un verset', description: 'Utilise un verset dans ta pri√®re', completed: false },
                    { id: 3, title: '‚úçÔ∏è M√©moriser un verset', description: 'Apprends un verset par c≈ìur', completed: false },
                    { id: 4, title: 'üíù Partager la Parole', description: 'Partage un verset avec quelqu\'un', completed: false },
                    { id: 5, title: 'üéØ M√©ditation biblique', description: 'M√©dite 10 minutes sur un passage', completed: false }
                ],
                4: [
                    { id: 1, title: 'üìñ Lire 1 Corinthiens 13', description: 'Le chapitre de l\'amour', completed: false },
                    { id: 2, title: 'üôè Prier pour tes ennemis', description: 'Demande √† Dieu de b√©nir ceux qui te font du mal', completed: false },
                    { id: 3, title: '‚úçÔ∏è Lettre d\'amour', description: '√âcris une lettre d\'encouragement', completed: false },
                    { id: 4, title: 'üíù Pardonner quelqu\'un', description: 'Pardonne √† quelqu\'un qui t\'a bless√©', completed: false },
                    { id: 5, title: 'üéØ Acte d\'amour', description: 'Fais un geste d\'amour d√©sint√©ress√©', completed: false }
                ],
                5: [
                    { id: 1, title: 'üìñ Lire Philippiens 4:6-7', description: 'La paix qui surpasse tout', completed: false },
                    { id: 2, title: 'üôè Pri√®re de paix', description: 'Prie pour la paix dans ton c≈ìur', completed: false },
                    { id: 3, title: '‚úçÔ∏è Journal de paix', description: '√âcris ce qui trouble ta paix', completed: false },
                    { id: 4, title: 'üíù R√©conciliation', description: 'R√©concilie-toi avec quelqu\'un', completed: false },
                    { id: 5, title: 'üéØ M√©ditation de paix', description: 'M√©dite en silence 15 minutes', completed: false }
                ]
            };
            
            journeyData.steps = daySteps[journeyData.currentDay] || daySteps[1];
        }

        function viewJourneyCalendar() {
            document.getElementById('journeyContent').classList.add('hidden');
            document.getElementById('journeyStats').classList.add('hidden');
            document.getElementById('journeyCalendar').classList.remove('hidden');
        }

        function viewJourneyStats() {
            document.getElementById('journeyContent').classList.add('hidden');
            document.getElementById('journeyCalendar').classList.add('hidden');
            document.getElementById('journeyStats').classList.remove('hidden');
        }

        function backToJourney() {
            document.getElementById('journeyCalendar').classList.add('hidden');
            document.getElementById('journeyStats').classList.add('hidden');
            document.getElementById('journeyContent').classList.remove('hidden');
        }

        function closeSpiritualJourneyModal() {
            document.getElementById('spiritualJourneyModal').classList.add('hidden');
            document.getElementById('spiritualJourneyModal').classList.remove('flex');
        }

        // Variables pour le syst√®me de r√©ponse
        let currentReplyMessage = null;
        let privateChats = {}; // Stockage des discussions priv√©es

        // Fonctions pour le modal de r√©ponse
        function openReplyModal(messageId) {
            const message = inboxMessages.find(msg => msg.id === messageId);
            if (!message) return;
            
            currentReplyMessage = message;
            
            // Remplir les informations du modal
            document.getElementById('replyUserName').textContent = message.sender;
            document.getElementById('replyUserAvatar').textContent = message.avatar;
            document.getElementById('replyMessageType').textContent = message.type;
            document.getElementById('replyMessageType').className = `${message.typeColor} px-2 py-1 rounded-full text-xs font-medium`;
            document.getElementById('replyMessageTime').textContent = message.time;
            document.getElementById('replyOriginalMessage').textContent = `"${message.message}"`;
            
            // R√©initialiser le textarea
            document.getElementById('replyTextarea').value = '';
            document.getElementById('replyCharCount').textContent = '0';
            
            // Ouvrir le modal
            document.getElementById('replyModal').classList.remove('hidden');
            document.getElementById('replyModal').classList.add('flex');
            
            showNotification(`üí¨ R√©ponse √† ${message.sender}`);
        }

        function closeReplyModal() {
            document.getElementById('replyModal').classList.add('hidden');
            document.getElementById('replyModal').classList.remove('flex');
            currentReplyMessage = null;
        }

        function addReplyEmoji(emoji) {
            const textarea = document.getElementById('replyTextarea');
            const currentText = textarea.value;
            const newText = currentText + emoji;
            
            if (newText.length <= 500) {
                textarea.value = newText;
                updateReplyCharCount();
                textarea.focus();
            }
        }

        function setQuickReply(text) {
            const textarea = document.getElementById('replyTextarea');
            textarea.value = text;
            updateReplyCharCount();
            textarea.focus();
        }

        function updateReplyCharCount() {
            const textarea = document.getElementById('replyTextarea');
            const charCount = document.getElementById('replyCharCount');
            charCount.textContent = textarea.value.length;
            
            // Changer la couleur selon la limite
            if (textarea.value.length > 450) {
                charCount.className = 'text-red-500 font-medium';
            } else if (textarea.value.length > 400) {
                charCount.className = 'text-orange-500';
            } else {
                charCount.className = '';
            }
        }

        function sendReply() {
            const replyText = document.getElementById('replyTextarea').value.trim();
            
            if (!replyText) {
                showNotification('‚ùå √âcris d\'abord ta r√©ponse !');
                return;
            }
            
            if (!currentReplyMessage) {
                showNotification('‚ùå Erreur : message introuvable');
                return;
            }
            
            // G√©n√©rer l'image template avec la r√©ponse
            generateReplyTemplate(currentReplyMessage, replyText);
            
            // Simuler l'envoi de la r√©ponse
            showNotification('üì§ R√©ponse envoy√©e avec succ√®s !');
            
            // Si la personne a un lien/profil, proposer de commencer une discussion
            if (currentReplyMessage.hasLink) {
                setTimeout(() => {
                    if (confirm(`üí¨ ${currentReplyMessage.sender} a un profil PrayLink ! Veux-tu commencer une discussion priv√©e avec cette personne ?`)) {
                        startPrivateChatFromReply();
                    } else {
                        closeReplyModal();
                    }
                }, 1000);
            } else {
                // Fermer le modal apr√®s 2 secondes
                setTimeout(() => {
                    closeReplyModal();
                }, 2000);
            }
            
            // Ajouter une animation de succ√®s
            const sendBtn = document.querySelector('[onclick="sendReply()"]');
            const originalText = sendBtn.innerHTML;
            sendBtn.innerHTML = '‚úÖ Envoy√© !';
            sendBtn.classList.add('bg-green-500');
            sendBtn.disabled = true;
            
            setTimeout(() => {
                sendBtn.innerHTML = originalText;
                sendBtn.classList.remove('bg-green-500');
                sendBtn.disabled = false;
            }, 2000);
        }

        function startPrivateChat() {
            if (!currentReplyMessage) {
                showNotification('‚ùå Erreur : message introuvable');
                return;
            }
            
            if (!currentReplyMessage.hasLink) {
                showNotification('‚ùå Cette personne n\'a pas de profil PrayLink pour une discussion priv√©e');
                return;
            }
            
            startPrivateChatFromReply();
        }

        function startPrivateChatFromReply() {
            const message = currentReplyMessage;
            
            // Cr√©er un nom d'utilisateur bas√© sur le lien
            let chatUsername = message.sender;
            if (message.link) {
                const linkParts = message.link.split('/');
                const userFromLink = linkParts[linkParts.length - 1];
                chatUsername = userFromLink.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
            }
            
            // Cr√©er ou r√©cup√©rer la discussion priv√©e
            if (!privateChats[chatUsername]) {
                privateChats[chatUsername] = {
                    avatar: 'üí¨',
                    status: 'En ligne',
                    messages: [
                        {
                            type: 'received',
                            text: `Salut ! J'ai vu que tu as r√©pondu √† mon message "${message.message.substring(0, 50)}..." üòä`,
                            time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })
                        },
                        {
                            type: 'received',
                            text: 'Merci pour ta r√©ponse ! √áa me fait vraiment plaisir üôè',
                            time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })
                        }
                    ]
                };
            }
            
            // Ajouter la r√©ponse √† la discussion si elle existe
            const replyText = document.getElementById('replyTextarea').value.trim();
            if (replyText) {
                privateChats[chatUsername].messages.push({
                    type: 'sent',
                    text: replyText,
                    time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })
                });
            }
            
            // Fermer le modal de r√©ponse
            closeReplyModal();
            
            // Ouvrir la discussion priv√©e
            setTimeout(() => {
                startConversation(chatUsername);
                showNotification(`üí¨ Discussion priv√©e avec ${chatUsername} ouverte !`);
            }, 500);
        }

        // Mettre √† jour la fonction startConversation pour utiliser les discussions priv√©es
        function startConversation(username) {
            currentConversation = username;
            
            // Utiliser les donn√©es des discussions priv√©es si disponibles
            const chatData = privateChats[username] || conversationData[username];
            
            document.getElementById('conversationUserName').textContent = username;
            document.getElementById('conversationUserAvatar').textContent = chatData?.avatar || 'üë§';
            document.getElementById('conversationStatus').textContent = chatData?.status || 'Hors ligne';
            
            loadConversationMessages();
            
            document.getElementById('conversationModal').classList.remove('hidden');
            document.getElementById('conversationModal').classList.add('flex');
        }

        // Mettre √† jour loadConversationMessages pour utiliser les discussions priv√©es
        function loadConversationMessages() {
            const messagesContainer = document.getElementById('conversationMessages');
            const messages = privateChats[currentConversation]?.messages || conversationData[currentConversation]?.messages || [];
            
            messagesContainer.innerHTML = messages.map(msg => `
                <div class="flex ${msg.type === 'sent' ? 'justify-end' : 'justify-start'}">
                    <div class="max-w-[70%] ${msg.type === 'sent' 
                        ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white' 
                        : 'bg-gray-100 text-gray-800'} rounded-2xl px-4 py-3">
                        <p class="text-sm">${msg.text}</p>
                        <p class="text-xs opacity-75 mt-1">${msg.time}</p>
                    </div>
                </div>
            `).join('');
            
            // Scroll vers le bas
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Mettre √† jour sendMessage pour utiliser les discussions priv√©es
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message && currentConversation) {
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                // Cr√©er la discussion priv√©e si elle n'existe pas
                if (!privateChats[currentConversation]) {
                    privateChats[currentConversation] = { messages: [] };
                }
                
                // Ajouter le message √† la discussion priv√©e
                privateChats[currentConversation].messages.push({
                    type: 'sent',
                    text: message,
                    time: time
                });
                
                input.value = '';
                loadConversationMessages();
                showNotification('üì§ Message envoy√© !');
                
                // Simuler une r√©ponse automatique apr√®s 2 secondes
                setTimeout(() => {
                    const responses = [
                        'Merci pour ton message ! üôè',
                        'Amen ! Ce verset me touche aussi ‚ù§Ô∏è',
                        'Que Dieu te b√©nisse ! ‚ú®',
                        'Prions ensemble pour cela üïäÔ∏è',
                        'Tu as raison, Dieu est fid√®le ! üåü',
                        'Merci pour tes encouragements üíù',
                        'C\'est exactement ce dont j\'avais besoin d\'entendre üéØ'
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    const responseTime = new Date();
                    const responseTimeStr = responseTime.getHours().toString().padStart(2, '0') + ':' + responseTime.getMinutes().toString().padStart(2, '0');
                    
                    privateChats[currentConversation].messages.push({
                        type: 'received',
                        text: randomResponse,
                        time: responseTimeStr
                    });
                    
                    loadConversationMessages();
                }, 2000);
            }
        }

        // Fonctions pour le syst√®me de template
        function generateReplyTemplate(originalMessage, replyText) {
            // Cr√©er le template HTML
            const templateHTML = createTemplateHTML(originalMessage, replyText);
            
            // Afficher dans le modal
            document.getElementById('templatePreview').innerHTML = templateHTML;
            
            // G√©n√©rer le lien personnel
            const personalLink = `https://praylink.app/u/${username || 'prayerwarrior'}`;
            document.getElementById('personalLink').value = personalLink;
            
            // Ouvrir le modal de template
            document.getElementById('templateModal').classList.remove('hidden');
            document.getElementById('templateModal').classList.add('flex');
            
            showNotification('üì∏ Template g√©n√©r√© ! Pr√™t √† partager sur ton statut');
        }

        function createTemplateHTML(originalMessage, replyText) {
            const userDisplayName = username || 'PrayerWarrior';
            const personalLink = `https://praylink.app/u/${username || 'prayerwarrior'}`;
            
            return `
                <div class="w-full bg-gradient-to-br from-purple-500 to-pink-600 text-white p-6 relative overflow-hidden" style="min-height: 400px;">
                    <!-- Motifs d√©coratifs -->
                    <div class="absolute top-0 right-0 w-32 h-32 bg-white bg-opacity-10 rounded-full -translate-y-16 translate-x-16"></div>
                    <div class="absolute bottom-0 left-0 w-24 h-24 bg-white bg-opacity-10 rounded-full translate-y-12 -translate-x-12"></div>
                    
                    <!-- Header -->
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-white bg-opacity-20 rounded-full mx-auto mb-3 flex items-center justify-center text-2xl">
                            üôè
                        </div>
                        <h1 class="text-xl font-bold mb-1">PrayLink</h1>
                        <p class="text-sm opacity-90">Messages anonymes bibliques</p>
                    </div>
                    
                    <!-- Message original -->
                    <div class="bg-white bg-opacity-15 rounded-2xl p-4 mb-4 backdrop-blur-sm">
                        <div class="flex items-center mb-2">
                            <span class="bg-white bg-opacity-30 px-2 py-1 rounded-full text-xs font-medium">${originalMessage.type}</span>
                            <span class="text-xs opacity-75 ml-2">${originalMessage.time}</span>
                        </div>
                        <p class="text-sm font-medium italic">"${originalMessage.message}"</p>
                        <p class="text-xs opacity-75 mt-2">- ${originalMessage.sender}</p>
                    </div>
                    
                    <!-- R√©ponse -->
                    <div class="bg-white text-gray-800 rounded-2xl p-4 mb-4 shadow-lg">
                        <div class="flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                ${profileEmoji}
                            </div>
                            <div>
                                <p class="font-semibold text-sm">${userDisplayName}</p>
                                <p class="text-xs text-gray-500">Ma r√©ponse</p>
                            </div>
                        </div>
                        <p class="text-sm leading-relaxed">${replyText}</p>
                    </div>
                    
                    <!-- Call to action -->
                    <div class="text-center">
                        <div class="bg-white bg-opacity-20 rounded-2xl p-3 backdrop-blur-sm">
                            <p class="text-sm font-medium mb-2">üí¨ Envoie-moi tes messages anonymes</p>
                            <div class="bg-white bg-opacity-30 rounded-lg px-3 py-2">
                                <p class="text-xs font-mono">${personalLink}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Footer -->
                    <div class="text-center mt-4">
                        <p class="text-xs opacity-75">Partage ta foi ‚Ä¢ Re√ßois des pri√®res ‚Ä¢ Encourage les autres</p>
                    </div>
                </div>
            `;
        }

        function closeTemplateModal() {
            document.getElementById('templateModal').classList.add('hidden');
            document.getElementById('templateModal').classList.remove('flex');
        }

        function copyPersonalLink() {
            const linkInput = document.getElementById('personalLink');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showNotification('üîó Lien personnel copi√© !');
                
                // Animation de succ√®s
                const copyBtn = document.querySelector('[onclick="copyPersonalLink()"]');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '‚úÖ Copi√© !';
                copyBtn.classList.add('text-green-600');
                
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.classList.remove('text-green-600');
                }, 2000);
            } catch (err) {
                showNotification('‚ùå Erreur lors de la copie');
            }
        }

        function downloadTemplate() {
            // Cr√©er un canvas pour g√©n√©rer l'image
            const templateElement = document.getElementById('templatePreview');
            
            // Utiliser html2canvas si disponible, sinon simuler le t√©l√©chargement
            if (typeof html2canvas !== 'undefined') {
                html2canvas(templateElement, {
                    width: 400,
                    height: 600,
                    scale: 2,
                    backgroundColor: null
                }).then(canvas => {
                    // Cr√©er un lien de t√©l√©chargement
                    const link = document.createElement('a');
                    link.download = `praylink-reponse-${Date.now()}.png`;
                    link.href = canvas.toDataURL();
                    link.click();
                    
                    showNotification('üì± Image t√©l√©charg√©e avec succ√®s !');
                });
            } else {
                // Simulation du t√©l√©chargement
                showNotification('üì± Fonctionnalit√© de t√©l√©chargement simul√©e ! En production, l\'image serait t√©l√©charg√©e.');
                
                // Cr√©er un blob simul√© et d√©clencher le t√©l√©chargement
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 600;
                const ctx = canvas.getContext('2d');
                
                // Fond d√©grad√©
                const gradient = ctx.createLinearGradient(0, 0, 400, 600);
                gradient.addColorStop(0, '#8b5cf6');
                gradient.addColorStop(1, '#ec4899');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, 400, 600);
                
                // Texte de d√©monstration
                ctx.fillStyle = 'white';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('PrayLink', 200, 100);
                
                ctx.font = '16px Arial';
                ctx.fillText('Template de r√©ponse g√©n√©r√© !', 200, 300);
                
                // T√©l√©charger
                const link = document.createElement('a');
                link.download = `praylink-reponse-${Date.now()}.png`;
                link.href = canvas.toDataURL();
                link.click();
            }
        }

        function shareToWhatsAppStatus() {
            // Simuler le partage sur WhatsApp Status
            showNotification('üì± Ouverture de WhatsApp pour partager sur ton statut...');
            
            // En production, cela ouvrirait WhatsApp avec l'image
            const message = "Nouvelle r√©ponse PrayLink ! üôè D√©couvre mes messages anonymes sur mon profil.";
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
            }, 1000);
        }

        function shareToInstagramStory() {
            // Simuler le partage sur Instagram Story
            showNotification('üì∑ Ouverture d\'Instagram pour partager en story...');
            
            // En production, cela ouvrirait Instagram avec l'image
            setTimeout(() => {
                // Simuler l'ouverture d'Instagram
                showNotification('üì∑ Instagram ouvert ! Ajoute l\'image t√©l√©charg√©e √† ta story.');
            }, 1000);
        }

        function generateReplyTemplateFromModal() {
            const replyText = document.getElementById('replyTextarea').value.trim();
            
            if (!replyText) {
                showNotification('‚ùå √âcris d\'abord ta r√©ponse !');
                return;
            }
            
            if (!currentReplyMessage) {
                showNotification('‚ùå Erreur : message introuvable');
                return;
            }
            
            // Fermer le modal de r√©ponse
            closeReplyModal();
            
            // G√©n√©rer le template apr√®s un court d√©lai
            setTimeout(() => {
                generateReplyTemplate(currentReplyMessage, replyText);
            }, 300);
        }

        // Variables pour l'envoi de versets
        let selectedVersetStyle = 'classic';

        // Fonctions pour envoyer un verset
        function sendVersetToSomeone() {
            const currentVerset = allVersets[currentVersetIndex];
            
            // Remplir les informations du modal
            document.getElementById('sendVersetText').textContent = `"${currentVerset.text}"`;
            document.getElementById('sendVersetRef').textContent = currentVerset.ref;
            
            // R√©initialiser le formulaire
            document.getElementById('recipientContact').value = '';
            document.getElementById('personalMessage').value = '';
            document.getElementById('messageCharCount').textContent = '0';
            
            // R√©initialiser le style s√©lectionn√©
            selectVersetStyle('classic');
            
            // Fermer le modal des versets
            closeVersetsModal();
            
            // Ouvrir le modal d'envoi
            document.getElementById('sendVersetModal').classList.remove('hidden');
            document.getElementById('sendVersetModal').classList.add('flex');
            
            showNotification('üíå Pr√™t √† envoyer ce verset √† quelqu\'un !');
        }

        function closeSendVersetModal() {
            document.getElementById('sendVersetModal').classList.add('hidden');
            document.getElementById('sendVersetModal').classList.remove('flex');
        }

        function selectVersetStyle(style) {
            selectedVersetStyle = style;
            
            // R√©initialiser tous les styles
            document.getElementById('styleClassic').classList.remove('border-blue-500', 'bg-blue-50');
            document.getElementById('styleModern').classList.remove('border-blue-500', 'bg-blue-50');
            document.getElementById('styleElegant').classList.remove('border-blue-500', 'bg-blue-50');
            
            document.getElementById('styleClassic').classList.add('border-gray-200');
            document.getElementById('styleModern').classList.add('border-gray-200');
            document.getElementById('styleElegant').classList.add('border-gray-200');
            
            // Appliquer le style s√©lectionn√©
            const selectedElement = document.getElementById(`style${style.charAt(0).toUpperCase() + style.slice(1)}`);
            selectedElement.classList.remove('border-gray-200');
            selectedElement.classList.add('border-blue-500', 'bg-blue-50');
            
            showNotification(`üé® Style "${style}" s√©lectionn√©`);
        }

        function selectSuggestedContact(name, contact) {
            document.getElementById('recipientContact').value = contact;
            showNotification(`üë• Contact "${name}" s√©lectionn√©`);
        }

        function updateMessageCharCount() {
            const textarea = document.getElementById('personalMessage');
            const charCount = document.getElementById('messageCharCount');
            charCount.textContent = textarea.value.length;
            
            // Changer la couleur selon la limite
            if (textarea.value.length > 180) {
                charCount.className = 'text-red-500 font-medium';
            } else if (textarea.value.length > 150) {
                charCount.className = 'text-orange-500';
            } else {
                charCount.className = '';
            }
        }

        function previewVersetMessage() {
            const currentVerset = allVersets[currentVersetIndex];
            const personalMsg = document.getElementById('personalMessage').value;
            const contact = document.getElementById('recipientContact').value;
            
            if (!contact) {
                showNotification('‚ùå Ajoute d\'abord un contact !');
                return;
            }
            
            let previewText = `Aper√ßu du message pour ${contact} :\n\n`;
            
            if (personalMsg) {
                previewText += `${personalMsg}\n\n`;
            }
            
            previewText += `"${currentVerset.text}"\n- ${currentVerset.ref}\n\n`;
            previewText += `Envoy√© avec PrayLink üôè`;
            
            alert(previewText);
        }

        function saveVersetDraft() {
            const currentVerset = allVersets[currentVersetIndex];
            const personalMsg = document.getElementById('personalMessage').value;
            const contact = document.getElementById('recipientContact').value;
            
            // Simuler la sauvegarde
            showNotification('üíæ Brouillon sauvegard√© ! Tu pourras le retrouver dans tes brouillons.');
        }

        function sendVersetNow() {
            const contact = document.getElementById('recipientContact').value.trim();
            const personalMsg = document.getElementById('personalMessage').value.trim();
            
            if (!contact) {
                showNotification('‚ùå Ajoute un num√©ro de t√©l√©phone ou email !');
                return;
            }
            
            // Simuler l'envoi
            showNotification('üì§ Verset envoy√© avec succ√®s ! üôè');
            
            // Animation de succ√®s
            const sendBtn = document.querySelector('[onclick="sendVersetNow()"]');
            const originalText = sendBtn.innerHTML;
            sendBtn.innerHTML = '‚úÖ Envoy√© !';
            sendBtn.classList.add('bg-green-600');
            sendBtn.disabled = true;
            
            setTimeout(() => {
                sendBtn.innerHTML = originalText;
                sendBtn.classList.remove('bg-green-600');
                sendBtn.disabled = false;
                closeSendVersetModal();
            }, 2000);
            
            // Ajouter aux statistiques
            showNotification('üìä Statistiques mises √† jour : +1 verset partag√©');
        }

        // Ajouter l'√©v√©nement pour le compteur de caract√®res
        document.addEventListener('DOMContentLoaded', function() {
            const replyTextarea = document.getElementById('replyTextarea');
            if (replyTextarea) {
                replyTextarea.addEventListener('input', updateReplyCharCount);
            }
            
            const personalMessageTextarea = document.getElementById('personalMessage');
            if (personalMessageTextarea) {
                personalMessageTextarea.addEventListener('input', updateMessageCharCount);
            }
        });

        // --- Nouveau flux d'inscription et de connexion ---

        async function createAccount() {
            const usernameInput = document.getElementById('usernameInput').value.trim();
            if (!usernameInput) {
                showNotification('‚ùå Veuillez entrer un nom d\'utilisateur.');
                return;
            }

            username = usernameInput;
            showLoader();

            try {
                // 1. V√©rifier si le nom d'utilisateur est disponible
                let response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'checkUser', username: username })
                });
                let result = await response.json();

                if (result.success && result.exists) {
                    showNotification('‚ùå Ce nom d\'utilisateur est d√©j√† pris. Veuillez en choisir un autre.');
                    hideLoader();
                    return;
                }

                // 2. Si disponible, cr√©er l'utilisateur
                const userData = {
                    username: username,
                    platform: selectedPlatform || 'instagram',
                    profileEmoji: 'üôè' // Emoji par d√©faut
                };

                response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'createUser', ...userData })
                });
                result = await response.json();

                if (result.success) {
                    localStorage.setItem('praylink_user', JSON.stringify(userData));
                    showNotification('‚úÖ Profil cr√©√© avec succ√®s !');
                    showLinksPage(userData.username);
                } else {
                    showNotification(`‚ùå Erreur lors de la cr√©ation : ${result.error}`);
                }

            } catch (error) {
                showNotification('‚ùå Erreur r√©seau. Veuillez r√©essayer.');
            } finally {
                hideLoader();
            }
        }

        function showLinksPage(username) {
            const baseUrl = 'https://praylink-beta.vercel.app';
            document.getElementById('sharingLink').value = `${baseUrl}/u/${username}`;
            document.getElementById('loginLink').value = `${baseUrl}/profile/${username}`;
            goToPage('linksPage');
        }

        function copyLink(inputId) {
            const linkInput = document.getElementById(inputId);
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            try {
                document.execCommand('copy');
                showNotification('‚úÖ Lien copi√© !');
            } catch (err) {
                showNotification('‚ùå Erreur lors de la copie');
            }
        }

        function onContinueFromLinksPage() {
            const savedUser = localStorage.getItem('praylink_user');
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                username = userData.username;
                profileEmoji = userData.profileEmoji;
                document.getElementById('mainUsername').textContent = '@' + username;
                setProfileEmoji(profileEmoji);
            }
            goToPage('mainPage');
        }

        async function handleLoginFromUrl() {
            const path = window.location.pathname;
            const loginPath = '/profile/';

            if (path.startsWith(loginPath)) {
                const loginUsername = path.substring(loginPath.length).split('/')[0];
                if (loginUsername) {
                    showLoader();
                    try {
                        const response = await fetch(SCRIPT_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ action: 'checkUser', username: loginUsername })
                        });
                        const result = await response.json();

                        if (result.success && result.exists) {
                            const user = result.user;
                            localStorage.setItem('praylink_user', JSON.stringify(user));
                            username = user.username;
                            selectedPlatform = user.platform;
                            profileEmoji = user.profileEmoji;

                            document.getElementById('mainUsername').textContent = '@' + user.username;
                            setProfileEmoji(user.profileEmoji);
                            
                            showNotification(`üëã Bienvenue, ${user.username} !`);
                            goToPage('mainPage');
                            window.history.replaceState({}, document.title, '/');
                        } else {
                            showNotification('‚ùå Profil non trouv√©. Veuillez v√©rifier votre lien.');
                            window.history.replaceState({}, document.title, '/');
                            goToPage('welcomePage');
                        }
                    } catch (error) {
                        showNotification('‚ùå Erreur r√©seau. Impossible de se connecter.');
                        goToPage('welcomePage');
                    } finally {
                        hideLoader();
                    }
                    return true; // Indique qu'une tentative de connexion a eu lieu
                }
            }
            return false; // Pas de tentative de connexion par URL
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', async function() {
            const usernameInput = document.getElementById('usernameInput');
            if (usernameInput) {
                usernameInput.addEventListener('input', function() {
                    username = this.value.trim();
                });
            }

            const loggedInViaUrl = await handleLoginFromUrl();
            if (loggedInViaUrl) return;

            // Si pas de connexion par URL, v√©rifier le localStorage
            const savedUser = localStorage.getItem('praylink_user');
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                username = userData.username;
                profileEmoji = userData.profileEmoji;
                document.getElementById('mainUsername').textContent = '@' + username;
                setProfileEmoji(profileEmoji);
                goToPage('mainPage');
            }
            // Sinon, la page d'accueil est d√©j√† affich√©e par d√©faut
        });

    </script>
</body>
</html>
