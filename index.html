<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrayLink - Messages Anonymes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
        }
        
        .app-container {
            max-width: 375px;
            margin: 0 auto;
            min-height: 100vh;
            background: white;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 768px) {
            .app-container {
                max-width: 100%;
                box-shadow: none;
            }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .premium-glow {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }
        
        .question-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .game-card {
            transition: all 0.3s ease;
        }
        
        .game-card:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .simple-btn {
            transition: background-color 0.2s ease;
            cursor: pointer;
        }
        
        .simple-btn:hover {
            opacity: 0.9;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #667eea;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="app-container">
        
        <!-- Page 1: Accueil -->
        <div id="welcomePage" class="gradient-bg h-screen flex flex-col justify-center items-center text-white p-8">
            <div class="text-center mb-12">
                <div class="w-32 h-32 bg-white rounded-full mx-auto mb-6 flex items-center justify-center text-6xl">
                    ğŸ™
                </div>
                <h1 class="text-4xl font-bold mb-4">PrayLink</h1>
                <p class="text-lg opacity-90">Messages anonymes bibliques</p>
            </div>
            
            <div class="w-full max-w-sm">
                <button onclick="goToPage('platformPage')" class="w-full bg-white text-gray-900 font-bold py-4 px-6 rounded-2xl text-lg mb-6 shadow-lg simple-btn">
                    ğŸš€ DÃ©marrer
                </button>
                
                <div class="text-center text-sm opacity-75">
                    <p class="mb-2">En continuant, vous acceptez les</p>
                    <a href="#" class="underline">Conditions d'utilisation</a>
                </div>
            </div>
        </div>

        <!-- Page 2: Choix de plateforme -->
        <div id="platformPage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center mb-8">
                <button onclick="goToPage('welcomePage')" class="text-2xl simple-btn">â†</button>
                <h2 class="text-xl font-semibold ml-4">Choisir une plateforme</h2>
            </div>
            
            <div class="flex-1 flex flex-col justify-center">
                <p class="text-center text-gray-600 mb-8">Sous quel nom veux-tu utiliser PrayLink ?</p>
                
                <div class="space-y-4 mb-8">
                    <button onclick="selectPlatform('instagram')" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-xl simple-btn">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-xl flex items-center justify-center text-white text-xl mr-4">
                                ğŸ“·
                            </div>
                            <span class="font-medium">Instagram</span>
                        </div>
                        <span class="text-gray-400 text-2xl">â†’</span>
                    </button>
                    
                    <button onclick="selectPlatform('whatsapp')" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-xl simple-btn">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center text-white text-xl mr-4">
                                ğŸ“±
                            </div>
                            <span class="font-medium">WhatsApp</span>
                        </div>
                        <span class="text-gray-400 text-2xl">â†’</span>
                    </button>
                    
                    <button onclick="selectPlatform('snapchat')" class="w-full flex items-center justify-between p-4 border-2 border-gray-200 rounded-xl simple-btn">
                        <div class="flex items-center">
                            <div class="w-12 h-12 bg-yellow-400 rounded-xl flex items-center justify-center text-gray-800 text-xl mr-4">
                                ğŸ‘»
                            </div>
                            <span class="font-medium">Snapchat</span>
                        </div>
                        <span class="text-gray-400 text-2xl">â†’</span>
                    </button>
                </div>
                
                <button onclick="goToPage('usernamePage')" class="w-full bg-gray-900 text-white font-semibold py-4 rounded-xl simple-btn">
                    Continuer
                </button>
            </div>
        </div>

        <!-- Page 3: Nom d'utilisateur -->
        <div id="usernamePage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center mb-8">
                <button onclick="goToPage('platformPage')" class="text-2xl interactive-btn">â†</button>
                <h2 class="text-xl font-semibold ml-4">Nom d'utilisateur</h2>
            </div>
            
            <div class="flex-1 flex flex-col justify-center">
                <p class="text-center text-gray-600 mb-8">Choisis ton nom d'utilisateur</p>
                
                <div class="mb-6">
                    <input type="text" id="usernameInput" placeholder="@tonnom" 
                           class="w-full px-4 py-4 border-2 border-gray-200 rounded-xl text-lg focus:border-gray-900 focus:outline-none">
                </div>
                
                <button onclick="goToPage('profilePhotoPage')" class="w-full bg-gray-900 text-white font-semibold py-4 rounded-xl mb-4 interactive-btn hover:glow">
                    Continuer
                </button>
            </div>
        </div>

        <!-- Page 4: Photo de profil -->
        <div id="profilePhotoPage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center mb-8">
                <button onclick="goToPage('usernamePage')" class="text-2xl interactive-btn">â†</button>
                <h2 class="text-xl font-semibold ml-4">Photo de profil</h2>
            </div>
            
            <div class="flex-1 flex flex-col justify-center items-center">
                <p class="text-center text-gray-600 mb-8">Choisis une photo pour ton profil</p>
                
                <div class="w-32 h-32 bg-gray-200 rounded-full mb-8 flex items-center justify-center text-4xl cursor-pointer simple-btn" onclick="selectProfilePhoto()">
                    <span id="profileEmoji">ğŸ“·</span>
                </div>
                
                <div class="grid grid-cols-4 gap-4 mb-8">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('ğŸ™')">ğŸ™</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('âœ¨')">âœ¨</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('ğŸ’«')">ğŸ’«</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('ğŸŒŸ')">ğŸŒŸ</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('ğŸ’')">ğŸ’</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('ğŸ•Šï¸')">ğŸ•Šï¸</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('ğŸ‘¼')">ğŸ‘¼</div>
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center text-2xl cursor-pointer simple-btn" onclick="setProfileEmoji('ğŸ¯')">ğŸ¯</div>
                </div>
                
                <div class="w-full space-y-3">
                    <button onclick="registerUser()" class="w-full bg-gray-900 text-white font-semibold py-4 rounded-xl interactive-btn hover:glow">
                        Continuer
                    </button>
                    <button onclick="goToPage('premiumPage')" class="w-full text-gray-500 py-2 interactive-btn">
                        Ignorer
                    </button>
                </div>
            </div>
        </div>

        <!-- Page 5: AccÃ¨s illimitÃ© -->
        <div id="premiumPage" class="hidden h-screen bg-white p-6 flex flex-col">
            <div class="flex items-center justify-between mb-8">
                <button onclick="goToPage('profilePhotoPage')" class="text-2xl interactive-btn">â†</button>
                <button onclick="goToPage('mainPage')" class="text-purple-600 font-medium interactive-btn">Passer</button>
            </div>
            
            <div class="flex-1 flex flex-col justify-center">
                <div class="text-center mb-8">
                    <div class="w-24 h-24 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center text-4xl premium-glow pulse-effect">
                        ğŸ‘‘
                    </div>
                    <h2 class="text-2xl font-bold mb-2">AccÃ¨s illimitÃ©</h2>
                    <p class="text-gray-600">DÃ©bloquez toutes les fonctionnalitÃ©s premium</p>
                </div>
                
                <div class="space-y-4 mb-8">
                    <div class="flex items-center p-4 bg-yellow-50 rounded-xl">
                        <span class="text-2xl mr-4">ğŸ®</span>
                        <span class="font-medium">100 jeux bibliques exclusifs</span>
                    </div>
                    <div class="flex items-center p-4 bg-blue-50 rounded-xl">
                        <span class="text-2xl mr-4">ğŸ†</span>
                        <span class="font-medium">3 niveaux de difficultÃ©</span>
                    </div>
                    <div class="flex items-center p-4 bg-purple-50 rounded-xl">
                        <span class="text-2xl mr-4">ğŸ“Š</span>
                        <span class="font-medium">Suivi de progression</span>
                    </div>
                </div>
                
                <button onclick="goToPage('mainPage')" class="w-full bg-gray-900 text-white font-bold py-4 rounded-xl mb-4 interactive-btn hover:glow">
                    Continuer
                </button>
            </div>
        </div>

        <!-- Page 6: Page principale -->
        <div id="mainPage" class="hidden h-screen bg-white flex flex-col">
            <!-- Header -->
            <div class="flex items-center justify-between p-4 border-b">
                <h1 class="text-xl font-bold">PrayLink</h1>
                <div class="flex items-center space-x-4">
                    <button onclick="goToPage('inboxPage')" class="relative interactive-btn">
                        <span class="text-2xl">ğŸ“¬</span>
                        <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center pulse-effect">3</span>
                    </button>
                    <button onclick="goToPage('settingsPage')" class="text-2xl interactive-btn">âš™ï¸</button>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="flex border-b">
                <button onclick="showTab('play')" class="flex-1 py-4 text-center font-medium border-b-2 border-gray-900 text-gray-900 interactive-btn" id="playTab">
                    Play
                </button>
                <button onclick="showTab('games')" class="flex-1 py-4 text-center font-medium text-gray-500 interactive-btn" id="gamesTab">
                    Jeux
                </button>
                <button onclick="showTab('inbox')" class="flex-1 py-4 text-center font-medium text-gray-500 interactive-btn" id="inboxTab">
                    Inbox
                </button>
            </div>
            
            <!-- Play Content -->
            <div id="playContent" class="flex-1 flex flex-col overflow-y-auto">
                <!-- Profil principal -->
                <div class="p-6 border-b bg-white">
                    <div class="flex items-center mb-4">
                        <div class="w-20 h-20 bg-gradient-to-br from-gray-700 to-gray-900 rounded-full flex items-center justify-center text-3xl shadow-lg mr-4 pulse-effect">
                            <span id="mainProfileEmoji">ğŸ™</span>
                        </div>
                        <div class="flex-1">
                            <h2 class="text-xl font-bold mb-1" id="mainUsername">@PrayerWarrior</h2>
                            <p class="text-gray-600 text-sm">Messages anonymes bibliques ğŸ“–</p>
                        </div>
                    </div>
                    
                    <div class="flex space-x-6">
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">42</div>
                            <div class="text-xs text-gray-500">Messages</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">15</div>
                            <div class="text-xs text-gray-500">PriÃ¨res</div>
                        </div>
                        <div class="text-center">
                            <div class="text-lg font-bold text-gray-900">8</div>
                            <div class="text-xs text-gray-500">TÃ©moignages</div>
                        </div>
                    </div>
                </div>
                
                <!-- Choix Questions ou Versets -->
                <div class="p-6 bg-white">
                    <h3 class="text-lg font-semibold text-center mb-6">Que veux-tu partager ?</h3>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Bouton Questions -->
                        <button onclick="openQuestionsModal()" class="bg-gradient-to-br from-purple-500 to-pink-600 text-white p-6 rounded-2xl text-center hover:shadow-lg transition-all interactive-btn">
                            <div class="text-4xl mb-3">â“</div>
                            <h4 class="font-bold text-lg mb-2">Questions</h4>
                            <p class="text-sm opacity-90">100 questions bibliques Ã  partager</p>
                        </button>
                        
                        <!-- Bouton Versets -->
                        <button onclick="openVersetsModal()" class="bg-gradient-to-br from-blue-500 to-indigo-600 text-white p-6 rounded-2xl text-center hover:shadow-lg transition-all interactive-btn">
                            <div class="text-4xl mb-3">ğŸ“–</div>
                            <h4 class="font-bold text-lg mb-2">Versets</h4>
                            <p class="text-sm opacity-90">Versets inspirants Ã  partager</p>
                        </button>
                    </div>
                </div>
                
                <!-- Section Statistiques -->
                <div class="p-6 bg-gray-50">
                    <h3 class="text-lg font-semibold mb-4">Tes partages</h3>
                    <div class="grid grid-cols-3 gap-4">
                        <div class="bg-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold text-purple-600">12</div>
                            <div class="text-xs text-gray-500">Questions partagÃ©es</div>
                        </div>
                        <div class="bg-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold text-blue-600">8</div>
                            <div class="text-xs text-gray-500">Versets partagÃ©s</div>
                        </div>
                        <div class="bg-white p-4 rounded-xl text-center">
                            <div class="text-2xl font-bold text-green-600">25</div>
                            <div class="text-xs text-gray-500">RÃ©ponses reÃ§ues</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Games Content -->
            <div id="gamesContent" class="hidden flex-1 p-4 overflow-y-auto">
                <div class="text-center mb-6">
                    <h3 class="text-lg font-semibold mb-2">Jeux Bibliques</h3>
                    <p class="text-gray-600 text-sm">DÃ©couvre la Bible en t'amusant !</p>
                </div>
                
                <!-- Jeux Gratuits -->
                <div class="mb-6">
                    <h4 class="text-md font-semibold text-gray-700 mb-3 flex items-center">
                        <span class="text-green-600 mr-2">ğŸ†“</span>
                        Jeux Gratuits
                    </h4>
                    
                    <div class="space-y-4">
                        <div class="bg-gradient-to-r from-gray-700 to-gray-900 rounded-2xl p-6 text-white">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">ğŸ“– Quiz Biblique</h4>
                                    <p class="text-sm opacity-90">Teste tes connaissances</p>
                                </div>
                                <div class="text-3xl pulse-effect">ğŸ§ </div>
                            </div>
                            <button onclick="startBibleQuiz()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                ğŸ® Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-gray-600 to-gray-800 rounded-2xl p-6 text-white">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">ğŸ” Trouve le Verset</h4>
                                    <p class="text-sm opacity-90">ComplÃ¨te les versets manquants</p>
                                </div>
                                <div class="text-3xl pulse-effect">ğŸ“œ</div>
                            </div>
                            <button onclick="startVerseGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                ğŸ® Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-gray-500 to-gray-700 rounded-2xl p-6 text-white">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">ğŸ§© MÃ©moire Biblique</h4>
                                    <p class="text-sm opacity-90">MÃ©morise les personnages</p>
                                </div>
                                <div class="text-3xl pulse-effect">ğŸ¯</div>
                            </div>
                            <button onclick="startMemoryGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                ğŸ® Jouer maintenant
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Jeux Premium -->
                <div class="mb-6">
                    <div class="flex items-center justify-between mb-3">
                        <h4 class="text-md font-semibold text-gray-700 flex items-center">
                            <span class="text-yellow-500 mr-2">ğŸ‘‘</span>
                            Jeux Premium
                        </h4>
                        <button onclick="upgradeToPremium()" class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white px-3 py-1 rounded-full text-xs font-bold premium-glow">
                            DÃ‰BLOQUER
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <div class="bg-gradient-to-r from-yellow-400 to-orange-500 rounded-2xl p-6 text-white relative overflow-hidden">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                âœ… DÃ‰BLOQUÃ‰
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">âš”ï¸ Bataille Biblique</h4>
                                    <p class="text-sm opacity-90">DÃ©fie tes amis en temps rÃ©el</p>
                                </div>
                                <div class="text-3xl pulse-effect">âš”ï¸</div>
                            </div>
                            <button onclick="startBattleGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                ğŸ® Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-500 to-pink-600 rounded-2xl p-6 text-white relative overflow-hidden premium-glow">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                âœ… DÃ‰BLOQUÃ‰
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">ğŸ† Tournoi des ProphÃ¨tes</h4>
                                    <p class="text-sm opacity-90">CompÃ©tition mondiale â€¢ 2,847 participants</p>
                                </div>
                                <div class="text-3xl pulse-effect">ğŸ†</div>
                            </div>
                            <button onclick="startTournament()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                ğŸ® Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-2xl p-6 text-white relative overflow-hidden premium-glow">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                âœ… DÃ‰BLOQUÃ‰
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">ğŸ­ MystÃ¨res Bibliques</h4>
                                    <p class="text-sm opacity-90">RÃ©sous des Ã©nigmes sacrÃ©es â€¢ âˆ mystÃ¨res infinis â€¢ MystÃ¨re ultime : La RÃ©surrection</p>
                                </div>
                                <div class="text-3xl pulse-effect">ğŸ”</div>
                            </div>
                            <button onclick="startMysteryGame()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                ğŸ® Jouer maintenant
                            </button>
                        </div>
                        
                        <div class="bg-gradient-to-r from-emerald-500 to-teal-600 rounded-2xl p-6 text-white relative overflow-hidden premium-glow">
                            <div class="absolute top-2 right-2 bg-green-500 px-2 py-1 rounded-full text-xs font-bold">
                                âœ… DÃ‰BLOQUÃ‰
                            </div>
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="text-lg font-bold">ğŸŒŸ Parcours Spirituel</h4>
                                    <p class="text-sm opacity-90">Aventure interactive de 40 jours â€¢ Jour 1/40 â€¢ Croissance personnelle</p>
                                </div>
                                <div class="text-3xl pulse-effect">ğŸ—ºï¸</div>
                            </div>
                            <button onclick="startSpiritualJourney()" class="w-full bg-white bg-opacity-20 text-white font-semibold py-3 rounded-xl hover:bg-opacity-30 transition-all interactive-btn bounce-in">
                                ğŸ® Commencer le parcours
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Avantages Premium -->
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-2xl p-4">
                    <div class="text-center mb-4">
                        <div class="text-3xl mb-2">ğŸ‘‘</div>
                        <h4 class="font-bold text-gray-800 mb-1">Passe Premium !</h4>
                        <p class="text-sm text-gray-600">DÃ©bloquer tous les jeux exclusifs</p>
                    </div>
                    
                    <div class="space-y-2 mb-4">
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">âœ…</span>
                            <span>4 jeux premium exclusifs</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">âœ…</span>
                            <span>Mode multijoueur en temps rÃ©el</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">âœ…</span>
                            <span>Classements et rÃ©compenses</span>
                        </div>
                        <div class="flex items-center text-sm text-gray-700">
                            <span class="text-green-500 mr-2">âœ…</span>
                            <span>Parcours spirituel personnalisÃ©</span>
                        </div>
                    </div>
                    
                    <button onclick="upgradeToPremium()" class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold py-3 rounded-xl premium-glow interactive-btn">
                        ğŸ‘‘ Passer Premium - 4,99â‚¬/mois
                    </button>
                </div>
            </div>
            
            <!-- Inbox Content -->
            <div id="inboxContent" class="hidden flex-1 p-4">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold">Messages reÃ§us</h3>
                    <button onclick="generateRandomQuestion()" class="bg-gray-100 text-gray-900 px-3 py-1 rounded-full text-sm interactive-btn hover:glow">
                        ğŸ² Question alÃ©atoire
                    </button>
                </div>
                
                <div class="space-y-4" id="messagesList">
                    <!-- Les messages seront chargÃ©s dynamiquement -->
                </div>
            </div>
        </div>

        <!-- Page 9: ActualitÃ©s des versets -->
        <div id="inboxPage" class="hidden h-screen bg-white flex flex-col">
            <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white">
                <button onclick="goToPage('mainPage')" class="text-2xl mr-4 interactive-btn text-white">â†</button>
                <div class="flex-1">
                    <h2 class="text-xl font-semibold">ğŸ“¬ ActualitÃ©s</h2>
                    <p class="text-sm opacity-90">Versets partagÃ©s aujourd'hui</p>
                </div>
                <div class="text-right">
                    <div class="text-lg font-bold">24</div>
                    <div class="text-xs opacity-75">nouveaux</div>
                </div>
            </div>
            
            <!-- Filtres -->
            <div class="flex items-center p-4 border-b bg-gray-50">
                <button onclick="filterVerses('all')" class="px-4 py-2 bg-purple-600 text-white rounded-full text-sm mr-3 interactive-btn" id="filterAll">
                    Tous
                </button>
                <button onclick="filterVerses('recent')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm mr-3 interactive-btn" id="filterRecent">
                    RÃ©cents
                </button>
                <button onclick="filterVerses('popular')" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm interactive-btn" id="filterPopular">
                    Populaires
                </button>
            </div>
            
            <!-- Liste des versets -->
            <div class="flex-1 overflow-y-auto p-4 custom-scrollbar" id="versesNewsFeed" style="max-height: calc(100vh - 200px);">
                <!-- Le contenu sera chargÃ© dynamiquement -->
            </div>
        </div>

        <!-- Page 10: ParamÃ¨tres -->
        <div id="settingsPage" class="hidden h-screen bg-white flex flex-col">
            <div class="flex items-center p-4 border-b">
                <button onclick="goToPage('mainPage')" class="text-2xl mr-4 interactive-btn">â†</button>
                <h2 class="text-xl font-semibold">ParamÃ¨tres</h2>
            </div>
            
            <div class="flex-1 overflow-y-auto">
                <div class="p-4 border-b">
                    <button onclick="showHowToShare()" class="w-full flex items-center justify-between interactive-btn">
                        <div class="flex items-center">
                            <span class="text-2xl mr-4">ğŸ“±</span>
                            <span class="font-medium">Comment partager le lien</span>
                        </div>
                        <span class="text-gray-400">â†’</span>
                    </button>
                </div>
                
                <div class="p-4 border-b">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <span class="text-2xl mr-4">ğŸ””</span>
                            <span class="font-medium">Notifications</span>
                        </div>
                        <label class="switch">
                            <input type="checkbox" checked>
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="p-4">
                    <button onclick="deleteAccount()" class="w-full flex items-center justify-between text-red-600 interactive-btn">
                        <div class="flex items-center">
                            <span class="text-2xl mr-4">ğŸ—‘ï¸</span>
                            <span class="font-medium">Supprimer le compte</span>
                        </div>
                        <span class="text-gray-400">â†’</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Questions -->
        <div id="questionsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">â“ Questions Bibliques</h3>
                    <button onclick="closeQuestionsModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="questionCard" class="p-6 bg-gradient-to-br from-purple-500 to-pink-600 text-white rounded-2xl mb-4">
                    <div class="text-center">
                        <div id="questionEmoji" class="text-4xl mb-3">â“</div>
                        <h4 id="questionText" class="text-lg font-bold mb-2">Quel verset biblique te parle aujourd'hui ?</h4>
                        <p class="text-sm opacity-75">Question <span id="currentQuestionNumber">1</span> â€¢ <span id="totalQuestionsCount">âˆ</span> questions disponibles</p>
                        <div class="mt-2">
                            <span class="bg-white bg-opacity-20 px-2 py-1 rounded-full text-xs" id="questionCategory">Versets</span>
                        </div>
                    </div>
                </div>
                
                <div class="flex items-center justify-center space-x-4 mb-4">
                    <button onclick="previousQuestion()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        â†
                    </button>
                    <button onclick="randomQuestion()" class="bg-gray-100 text-gray-900 px-4 py-2 rounded-full text-sm font-medium interactive-btn">
                        ğŸ² AlÃ©atoire
                    </button>
                    <button onclick="nextQuestion()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        â†’
                    </button>
                </div>
                
                <div class="space-y-3">
                    <button onclick="shareCurrentQuestion()" class="w-full bg-purple-600 text-white font-bold py-3 rounded-xl interactive-btn">
                        ğŸ“± Partager cette question
                    </button>
                    <button onclick="copyCurrentQuestion()" class="w-full bg-gray-100 text-gray-700 font-medium py-3 rounded-xl interactive-btn">
                        ğŸ“‹ Copier le lien
                    </button>
                    <button onclick="showQuestionInsights()" class="w-full bg-blue-100 text-blue-700 font-medium py-3 rounded-xl interactive-btn">
                        ğŸ“Š Voir les indices
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Versets -->
        <div id="versetsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">ğŸ“– Versets Inspirants</h3>
                    <button onclick="closeVersetsModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="versetCard" class="p-6 bg-gradient-to-br from-blue-500 to-indigo-600 text-white rounded-2xl mb-4">
                    <div class="text-center">
                        <div class="text-4xl mb-3">ğŸ“–</div>
                        <div class="bg-white bg-opacity-20 rounded-lg p-4 mb-4">
                            <p id="versetText" class="text-sm font-medium italic mb-2">"Car Dieu a tant aimÃ© le monde qu'il a donnÃ© son Fils unique, afin que quiconque croit en lui ne pÃ©risse point, mais qu'il ait la vie Ã©ternelle."</p>
                            <p id="versetRef" class="text-xs opacity-75">Jean 3:16</p>
                        </div>
                        <p class="text-sm opacity-75">Verset <span id="currentVersetNumber">1</span>/50</p>
                    </div>
                </div>
                
                <div class="flex items-center justify-center space-x-4 mb-4">
                    <button onclick="previousVerset()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        â†
                    </button>
                    <button onclick="randomVerset()" class="bg-gray-100 text-gray-900 px-4 py-2 rounded-full text-sm font-medium interactive-btn">
                        ğŸ² AlÃ©atoire
                    </button>
                    <button onclick="nextVerset()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 interactive-btn">
                        â†’
                    </button>
                </div>
                
                <div class="space-y-3">
                    <button onclick="shareCurrentVerset()" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl interactive-btn">
                        ğŸ“± Partager ce verset
                    </button>
                    <button onclick="sendVersetToSomeone()" class="w-full bg-green-600 text-white font-bold py-3 rounded-xl interactive-btn">
                        ğŸ’Œ Envoyer Ã  quelqu'un
                    </button>
                    <button onclick="copyCurrentVerset()" class="w-full bg-gray-100 text-gray-700 font-medium py-3 rounded-xl interactive-btn">
                        ğŸ“‹ Copier le verset
                    </button>
                    <button onclick="showVersetInsights()" class="w-full bg-green-100 text-green-700 font-medium py-3 rounded-xl interactive-btn">
                        ğŸ“Š Voir les indices
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal Quiz Biblique -->
        <div id="quizModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">ğŸ“– Quiz Biblique</h3>
                    <button onclick="closeQuizModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="quizContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">ğŸ§ </div>
                        <h4 class="font-semibold mb-2" id="quizQuestion">Qui a construit l'arche ?</h4>
                        <p class="text-sm text-gray-600">Question <span id="quizNumber">1</span> â€¢ Score: <span id="currentScore">0</span></p>
                    </div>
                    
                    <div class="space-y-3 mb-6" id="quizOptions">
                        <button onclick="selectQuizAnswer(0)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            A) MoÃ¯se
                        </button>
                        <button onclick="selectQuizAnswer(1)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            B) NoÃ©
                        </button>
                        <button onclick="selectQuizAnswer(2)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            C) Abraham
                        </button>
                        <button onclick="selectQuizAnswer(3)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn">
                            D) David
                        </button>
                    </div>
                    
                    <button onclick="nextQuizQuestion()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow" id="nextQuizBtn" disabled>
                        Suivant
                    </button>
                </div>
                
                <div id="quizResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect">ğŸ‰</div>
                    <h4 class="text-lg font-semibold mb-2">Quiz terminÃ© !</h4>
                    <p class="text-gray-600 mb-4">Score: <span id="finalScore">0</span>/5</p>
                    <button onclick="restartQuiz()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                        Rejouer
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal MÃ©moire Biblique -->
        <div id="memoryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">ğŸ§© MÃ©moire Biblique</h3>
                    <button onclick="closeMemoryModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="memoryContent">
                    <div class="text-center mb-4">
                        <div class="text-4xl mb-2 pulse-effect">ğŸ¯</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Niveau: <span id="memoryLevel" class="font-bold text-purple-600">1</span></div>
                            <div>Score: <span id="memoryScore" class="font-bold text-green-600">0</span></div>
                            <div>Temps: <span id="memoryTimer" class="font-bold text-red-600">60s</span></div>
                        </div>
                        <div class="text-xs text-gray-500 mb-4">
                            Coups: <span id="memoryMoves">0</span> â€¢ Paires: <span id="memoryPairs">0</span>/<span id="memoryTotal">6</span>
                        </div>
                    </div>
                    
                    <div id="memoryGrid" class="grid grid-cols-4 gap-2 mb-4">
                        <!-- Les cartes seront gÃ©nÃ©rÃ©es ici -->
                    </div>
                    
                    <div class="text-center">
                        <button onclick="restartMemoryGame()" class="bg-purple-600 text-white px-4 py-2 rounded-xl text-sm interactive-btn hover:glow">
                            ğŸ”„ Recommencer
                        </button>
                    </div>
                </div>
                
                <div id="memoryResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="memoryResultIcon">ğŸ‰</div>
                    <h4 class="text-lg font-semibold mb-2" id="memoryResultText">Niveau terminÃ© !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-purple-600" id="finalMemoryScore">0</div>
                                <div class="text-xs text-gray-500">Points</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-blue-600" id="finalMemoryMoves">0</div>
                                <div class="text-xs text-gray-500">Coups</div>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="nextMemoryLevel()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow" id="nextLevelBtn">
                            â¡ï¸ Niveau suivant
                        </button>
                        <button onclick="restartMemoryGame()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ”„ Rejouer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Trouve le Verset -->
        <div id="verseModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">ğŸ” Trouve le Verset</h3>
                    <button onclick="closeVerseModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="verseContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">ğŸ“œ</div>
                        <p class="text-sm text-gray-600 mb-4">ComplÃ¨te ce verset cÃ©lÃ¨bre</p>
                        <div class="bg-gray-50 p-4 rounded-lg mb-4">
                            <p class="text-sm" id="verseText">"Car Dieu a tant aimÃ© le monde qu'il a donnÃ© son Fils _____, afin que quiconque croit en lui ne pÃ©risse point, mais qu'il ait la vie _____."</p>
                            <p class="text-xs text-gray-500 mt-2" id="verseRef">Jean 3:16</p>
                        </div>
                    </div>
                    
                    <div class="space-y-3 mb-6">
                        <input type="text" id="verseInput1" placeholder="Premier mot manquant" class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none">
                        <input type="text" id="verseInput2" placeholder="Second mot manquant" class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:outline-none">
                    </div>
                    
                    <button onclick="checkVerseAnswer()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                        VÃ©rifier
                    </button>
                </div>
                
                <div id="verseResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="verseResultIcon">âœ…</div>
                    <h4 class="text-lg font-semibold mb-2" id="verseResultText">Correct !</h4>
                    <p class="text-gray-600 mb-4" id="verseResultMessage">Bien jouÃ© ! Tu connais bien tes versets.</p>
                    <button onclick="nextVerse()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                        Verset suivant
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal de partage -->
        <div id="shareModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800">ğŸ“± Partager</h3>
                    <button onclick="closeShareModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        Ã—
                    </button>
                </div>
                
                <!-- AperÃ§u du message -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-4 mb-6 border border-purple-100">
                    <div class="flex items-center mb-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            ğŸ™
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm" id="shareUsername">@PrayerWarrior</p>
                            <p class="text-xs text-gray-500">Question biblique</p>
                        </div>
                    </div>
                    <p class="text-sm text-gray-700 mb-3" id="shareText">Quel verset biblique te parle aujourd'hui ?</p>
                    <div class="bg-white rounded-lg p-3 border border-gray-200">
                        <p class="text-xs text-gray-500 mb-1">Lien de rÃ©ponse</p>
                        <input type="text" id="shareLink" class="w-full text-xs text-purple-600 bg-transparent border-none outline-none" readonly>
                    </div>
                </div>
                
                <!-- Boutons de partage -->
                <div class="space-y-3 mb-4">
                    <button onclick="copyShareLink()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-4 rounded-2xl flex items-center justify-center space-x-3 hover:shadow-lg transition-all">
                        <span class="text-xl">ğŸ“‹</span>
                        <span>Copier le lien</span>
                    </button>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="shareToInstagram()" class="bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">ğŸ“·</span>
                            <span class="text-sm">Instagram</span>
                        </button>
                        
                        <button onclick="shareToWhatsApp()" class="bg-gradient-to-br from-green-500 to-emerald-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">ğŸ’¬</span>
                            <span class="text-sm">WhatsApp</span>
                        </button>
                        
                        <button onclick="shareToSnapchat()" class="bg-gradient-to-br from-yellow-400 to-orange-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">ğŸ‘»</span>
                            <span class="text-sm">Snapchat</span>
                        </button>
                        
                        <button onclick="shareToTwitter()" class="bg-gradient-to-br from-blue-500 to-cyan-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 hover:shadow-md transition-all">
                            <span class="text-lg">ğŸ¦</span>
                            <span class="text-sm">Twitter</span>
                        </button>
                    </div>
                </div>
                
                <!-- Statistiques -->
                <div class="bg-gray-50 rounded-2xl p-4">
                    <div class="flex items-center justify-between text-sm">
                        <div class="text-center">
                            <div class="font-bold text-purple-600">12</div>
                            <div class="text-xs text-gray-500">Vues</div>
                        </div>
                        <div class="text-center">
                            <div class="font-bold text-green-600">5</div>
                            <div class="text-xs text-gray-500">RÃ©ponses</div>
                        </div>
                        <div class="text-center">
                            <div class="font-bold text-blue-600">3</div>
                            <div class="text-xs text-gray-500">Partages</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal How to Share -->
        <div id="howToShareModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full">
                <h3 class="text-lg font-semibold mb-4">Comment partager ton lien</h3>
                <div class="space-y-4 mb-6">
                    <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-2xl mr-3">ğŸ“±</span>
                        <span class="text-sm">Copie ton lien personnel</span>
                    </div>
                    <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-2xl mr-3">ğŸ“·</span>
                        <span class="text-sm">Partage sur ta story Instagram</span>
                    </div>
                    <div class="flex items-center p-3 bg-gray-50 rounded-lg">
                        <span class="text-2xl mr-3">ğŸ’¬</span>
                        <span class="text-sm">Envoie Ã  tes amis</span>
                    </div>
                </div>
                <button onclick="closeHowToShare()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                    Compris !
                </button>
            </div>
        </div>

        <!-- Modal de Conversation -->
        <div id="conversationModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl max-w-sm w-full h-[80vh] flex flex-col shadow-2xl">
                <!-- Header de conversation -->
                <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-t-3xl">
                    <button onclick="closeConversation()" class="text-2xl mr-4 interactive-btn text-white">â†</button>
                    <div class="flex items-center flex-1">
                        <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-lg mr-3" id="conversationUserAvatar">
                            ğŸ‘¤
                        </div>
                        <div>
                            <h3 class="font-semibold" id="conversationUserName">Marie_2024</h3>
                            <p class="text-xs opacity-75" id="conversationStatus">En ligne</p>
                        </div>
                    </div>
                    <button onclick="blockUser()" class="text-lg interactive-btn text-white opacity-75">ğŸš«</button>
                </div>
                
                <!-- Messages -->
                <div class="flex-1 overflow-y-auto p-4 space-y-4" id="conversationMessages">
                    <!-- Les messages seront chargÃ©s ici -->
                </div>
                
                <!-- Zone de saisie -->
                <div class="p-4 border-t bg-gray-50 rounded-b-3xl">
                    <div class="flex items-center space-x-3">
                        <input type="text" id="messageInput" placeholder="Ã‰cris ton message..." 
                               class="flex-1 px-4 py-3 border border-gray-200 rounded-2xl focus:border-purple-500 focus:outline-none text-sm"
                               onkeypress="handleMessageKeyPress(event)">
                        <button onclick="sendMessage()" class="w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-2xl flex items-center justify-center interactive-btn">
                            <span class="text-lg">ğŸ“¤</span>
                        </button>
                    </div>
                    <div class="flex items-center justify-between mt-3">
                        <div class="flex space-x-2">
                            <button onclick="addEmoji('ğŸ™')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">ğŸ™</button>
                            <button onclick="addEmoji('â¤ï¸')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">â¤ï¸</button>
                            <button onclick="addEmoji('âœ¨')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">âœ¨</button>
                            <button onclick="addEmoji('ğŸ•Šï¸')" class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center text-sm interactive-btn">ğŸ•Šï¸</button>
                        </div>
                        <button onclick="shareVerse()" class="text-xs text-purple-600 font-medium interactive-btn">ğŸ“– Partager un verset</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Bataille Biblique -->
        <div id="battleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">âš”ï¸ Bataille Biblique</h3>
                    <button onclick="closeBattleModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="battleContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">âš”ï¸</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Manche: <span id="battleRound" class="font-bold text-orange-600">1</span>/5</div>
                            <div>Score: <span id="battleScore" class="font-bold text-green-600">0</span></div>
                            <div>Temps: <span id="battleTimer" class="font-bold text-red-600">10s</span></div>
                        </div>
                        <div class="bg-gradient-to-r from-yellow-400 to-orange-500 text-white rounded-xl p-3 mb-4">
                            <p class="text-xs mb-1">ğŸ† Adversaire: <strong>David_Foi</strong></p>
                            <div class="flex items-center justify-between">
                                <div class="text-center">
                                    <div class="text-lg font-bold">0</div>
                                    <div class="text-xs">Toi</div>
                                </div>
                                <div class="text-2xl">âš”ï¸</div>
                                <div class="text-center">
                                    <div class="text-lg font-bold">0</div>
                                    <div class="text-xs">David_Foi</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3 text-center" id="battleQuestion">Qui a construit l'arche de NoÃ© ?</h4>
                        <div class="space-y-2" id="battleOptions">
                            <button onclick="selectBattleAnswer(0)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                A) MoÃ¯se
                            </button>
                            <button onclick="selectBattleAnswer(1)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                B) NoÃ©
                            </button>
                            <button onclick="selectBattleAnswer(2)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                C) Abraham
                            </button>
                            <button onclick="selectBattleAnswer(3)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn">
                                D) David
                            </button>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="restartBattle()" class="bg-orange-600 text-white px-4 py-2 rounded-xl text-sm interactive-btn hover:glow">
                            ğŸ”„ Nouvelle bataille
                        </button>
                    </div>
                </div>
                
                <div id="battleResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="battleResultIcon">ğŸ†</div>
                    <h4 class="text-lg font-semibold mb-2" id="battleResultText">Victoire !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-green-600" id="finalBattleScore">3</div>
                                <div class="text-xs text-gray-500">Tes points</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-red-600" id="opponentScore">2</div>
                                <div class="text-xs text-gray-500">Adversaire</div>
                            </div>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="findNewOpponent()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ” Nouvel adversaire
                        </button>
                        <button onclick="restartBattle()" class="w-full bg-orange-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ”„ Rejouer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal MystÃ¨res Bibliques -->
        <div id="mysteryModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">ğŸ­ MystÃ¨res Bibliques</h3>
                    <button onclick="closeMysteryModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="mysteryContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">ğŸ”</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>MystÃ¨re: <span id="mysteryNumber" class="font-bold text-indigo-600">1</span>/25</div>
                            <div>Score: <span id="mysteryScore" class="font-bold text-green-600">0</span></div>
                            <div>Indices: <span id="mysteryHints" class="font-bold text-blue-600">3</span></div>
                        </div>
                        <div class="bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-4 mb-4">
                            <h4 class="font-bold mb-2">ğŸ”® MystÃ¨re Ã  rÃ©soudre</h4>
                            <p class="text-sm" id="mysteryQuestion">Je suis celui qui a Ã©tÃ© vendu par ses frÃ¨res pour 20 piÃ¨ces d'argent. Mes rÃªves ont prÃ©dit l'avenir et j'ai sauvÃ© l'Ã‰gypte de la famine. Qui suis-je ?</p>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <input type="text" id="mysteryAnswer" placeholder="Tape ta rÃ©ponse..." 
                               class="w-full p-3 border-2 border-gray-200 rounded-lg focus:border-indigo-500 focus:outline-none text-center font-medium"
                               onkeypress="handleMysteryKeyPress(event)">
                    </div>
                    
                    <div class="space-y-3 mb-4">
                        <button onclick="checkMysteryAnswer()" class="w-full bg-indigo-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ” VÃ©rifier la rÃ©ponse
                        </button>
                        <button onclick="getMysteryHint()" class="w-full bg-blue-100 text-blue-700 py-3 rounded-xl interactive-btn" id="hintBtn">
                            ğŸ’¡ Demander un indice (3 restants)
                        </button>
                    </div>
                    
                    <!-- Zone des indices -->
                    <div id="hintsContainer" class="space-y-2 mb-4 hidden">
                        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-3">
                            <h5 class="font-semibold text-yellow-800 mb-1">ğŸ’¡ Indices rÃ©vÃ©lÃ©s :</h5>
                            <div id="hintsList" class="space-y-1 text-sm text-yellow-700">
                                <!-- Les indices apparaÃ®tront ici -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="skipMystery()" class="bg-gray-100 text-gray-600 px-4 py-2 rounded-xl text-sm interactive-btn">
                            â­ï¸ Passer ce mystÃ¨re
                        </button>
                    </div>
                </div>
                
                <div id="mysteryResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="mysteryResultIcon">ğŸ‰</div>
                    <h4 class="text-lg font-semibold mb-2" id="mysteryResultText">MystÃ¨re rÃ©solu !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-indigo-600" id="finalMysteryScore">0</div>
                                <div class="text-xs text-gray-500">Points gagnÃ©s</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-green-600" id="mysteryTime">0s</div>
                                <div class="text-xs text-gray-500">Temps pris</div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <p class="text-sm text-gray-700" id="mysteryExplanation">Joseph Ã©tait le fils de Jacob, vendu par ses frÃ¨res jaloux. Ses dons d'interprÃ©tation des rÃªves l'ont menÃ© Ã  devenir vice-roi d'Ã‰gypte.</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="nextMystery()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ” MystÃ¨re suivant
                        </button>
                        <button onclick="restartMysteryGame()" class="w-full bg-indigo-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ”„ Recommencer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Tournoi des ProphÃ¨tes -->
        <div id="tournamentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">ğŸ† Tournoi des ProphÃ¨tes</h3>
                    <button onclick="closeTournamentModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="tournamentContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">ğŸ†</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Manche: <span id="tournamentRound" class="font-bold text-purple-600">1</span>/10</div>
                            <div>Score: <span id="tournamentScore" class="font-bold text-green-600">0</span></div>
                            <div>Temps: <span id="tournamentTimer" class="font-bold text-red-600">15s</span></div>
                        </div>
                        <div class="bg-gradient-to-r from-purple-500 to-pink-600 text-white rounded-xl p-3 mb-4">
                            <p class="text-xs mb-1">ğŸŒ Classement mondial</p>
                            <div class="flex items-center justify-center">
                                <div class="text-center">
                                    <div class="text-lg font-bold" id="playerRank">156</div>
                                    <div class="text-xs">Ton rang</div>
                                </div>
                                <div class="text-2xl mx-4">ğŸ†</div>
                                <div class="text-center">
                                    <div class="text-lg font-bold">2,847</div>
                                    <div class="text-xs">Participants</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-6">
                        <h4 class="font-semibold mb-3 text-center" id="tournamentQuestion">Qui Ã©tait le plus jeune des fils de Jacob ?</h4>
                        <div class="space-y-2" id="tournamentOptions">
                            <button onclick="selectTournamentAnswer(0)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                A) Joseph
                            </button>
                            <button onclick="selectTournamentAnswer(1)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                B) Benjamin
                            </button>
                            <button onclick="selectTournamentAnswer(2)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                C) Dan
                            </button>
                            <button onclick="selectTournamentAnswer(3)" class="w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option">
                                D) Nephtali
                            </button>
                        </div>
                    </div>
                    
                    <!-- Classement en temps rÃ©el -->
                    <div class="bg-gray-50 rounded-xl p-4">
                        <h5 class="font-semibold text-gray-800 mb-3 text-center">ğŸ… Top 5 en direct</h5>
                        <div class="space-y-2" id="tournamentLeaderboard">
                            <div class="flex items-center justify-between text-sm">
                                <div class="flex items-center">
                                    <span class="text-yellow-500 mr-2">ğŸ¥‡</span>
                                    <span class="font-medium">David_ProphÃ¨te</span>
                                </div>
                                <span class="font-bold text-purple-600">2,450 pts</span>
                            </div>
                            <div class="flex items-center justify-between text-sm">
                                <div class="flex items-center">
                                    <span class="text-gray-400 mr-2">ğŸ¥ˆ</span>
                                    <span class="font-medium">Marie_Sagesse</span>
                                </div>
                                <span class="font-bold text-purple-600">2,380 pts</span>
                            </div>
                            <div class="flex items-center justify-between text-sm">
                                <div class="flex items-center">
                                    <span class="text-orange-500 mr-2">ğŸ¥‰</span>
                                    <span class="font-medium">Paul_VÃ©ritÃ©</span>
                                </div>
                                <span class="font-bold text-purple-600">2,290 pts</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="tournamentResults" class="hidden text-center">
                    <div class="text-4xl mb-4 pulse-effect" id="tournamentResultIcon">ğŸ†</div>
                    <h4 class="text-lg font-semibold mb-2" id="tournamentResultText">Tournoi terminÃ© !</h4>
                    <div class="bg-gray-50 rounded-xl p-4 mb-4">
                        <div class="grid grid-cols-2 gap-4 text-sm">
                            <div class="text-center">
                                <div class="font-bold text-purple-600" id="finalTournamentScore">0</div>
                                <div class="text-xs text-gray-500">Points totaux</div>
                            </div>
                            <div class="text-center">
                                <div class="font-bold text-blue-600" id="finalTournamentRank">0</div>
                                <div class="text-xs text-gray-500">Classement final</div>
                            </div>
                        </div>
                        <div class="mt-3 text-center">
                            <span class="bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-bold" id="tournamentReward">+50 XP</span>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <button onclick="joinNewTournament()" class="w-full bg-green-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ¯ Nouveau tournoi
                        </button>
                        <button onclick="restartTournament()" class="w-full bg-purple-600 text-white py-3 rounded-xl interactive-btn hover:glow">
                            ğŸ”„ Rejouer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal des Indices -->
        <div id="insightsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full max-h-[80vh] overflow-y-auto shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800 flex items-center">
                        <span class="text-2xl mr-2">ğŸ“Š</span>
                        Indices d'activitÃ©
                    </h3>
                    <button onclick="closeInsightsModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        Ã—
                    </button>
                </div>
                
                <!-- Statistiques gÃ©nÃ©rales -->
                <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-2xl p-4 mb-6 border border-purple-100">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">ğŸ“ˆ</span>
                        Statistiques du lien
                    </h4>
                    <div class="grid grid-cols-3 gap-3">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-600" id="insightViews">24</div>
                            <div class="text-xs text-gray-600">Vues</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600" id="insightClicks">12</div>
                            <div class="text-xs text-gray-600">Clics</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600" id="insightResponses">5</div>
                            <div class="text-xs text-gray-600">RÃ©ponses</div>
                        </div>
                    </div>
                </div>
                
                <!-- Indices des visiteurs -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">ğŸ‘¥</span>
                        Qui a vu ton lien
                    </h4>
                    <div class="space-y-3" id="visitorsInsights">
                        <!-- Contenu gÃ©nÃ©rÃ© dynamiquement -->
                    </div>
                </div>
                
                <!-- Indices des rÃ©pondants -->
                <div class="mb-6">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">ğŸ’¬</span>
                        Qui t'a envoyÃ© un message
                    </h4>
                    <div class="space-y-3" id="respondersInsights">
                        <!-- Contenu gÃ©nÃ©rÃ© dynamiquement -->
                    </div>
                </div>
                
                <!-- Graphique temporel -->
                <div class="bg-gray-50 rounded-2xl p-4">
                    <h4 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <span class="text-lg mr-2">â°</span>
                        ActivitÃ© dans le temps
                    </h4>
                    <div class="flex items-end justify-between h-20 mb-2">
                        <div class="bg-purple-300 w-4 rounded-t" style="height: 30%"></div>
                        <div class="bg-purple-400 w-4 rounded-t" style="height: 60%"></div>
                        <div class="bg-purple-500 w-4 rounded-t" style="height: 80%"></div>
                        <div class="bg-purple-600 w-4 rounded-t" style="height: 100%"></div>
                        <div class="bg-purple-400 w-4 rounded-t" style="height: 45%"></div>
                        <div class="bg-purple-300 w-4 rounded-t" style="height: 25%"></div>
                        <div class="bg-purple-200 w-4 rounded-t" style="height: 15%"></div>
                    </div>
                    <div class="flex justify-between text-xs text-gray-500">
                        <span>Lun</span>
                        <span>Mar</span>
                        <span>Mer</span>
                        <span>Jeu</span>
                        <span>Ven</span>
                        <span>Sam</span>
                        <span>Dim</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Parcours Spirituel -->
        <div id="spiritualJourneyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-2xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold">ğŸŒŸ Parcours Spirituel</h3>
                    <button onclick="closeSpiritualJourneyModal()" class="text-2xl text-gray-400 interactive-btn">Ã—</button>
                </div>
                
                <div id="journeyContent">
                    <div class="text-center mb-6">
                        <div class="text-4xl mb-4 pulse-effect">ğŸ—ºï¸</div>
                        <div class="flex items-center justify-between text-sm text-gray-600 mb-4">
                            <div>Jour: <span id="journeyDay" class="font-bold text-emerald-600">1</span>/40</div>
                            <div>Ã‰tapes: <span id="journeySteps" class="font-bold text-blue-600">0</span>/5</div>
                            <div>XP: <span id="journeyXP" class="font-bold text-purple-600">0</span></div>
                        </div>
                        <!-- SÃ©lecteur de parcours -->
                        <div class="mb-4">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-semibold text-gray-800">ğŸ“š Choisir un parcours</h4>
                                <button onclick="showJourneySelector()" class="text-sm text-purple-600 font-medium interactive-btn">
                                    Changer
                                </button>
                            </div>
                            <div class="bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl p-3 mb-2" id="currentJourneyCard">
                                <div class="flex items-center justify-between">
                                    <div>
                                        <h5 class="font-bold text-sm" id="currentJourneyTitle">ğŸŒ± Les Fondations</h5>
                                        <p class="text-xs opacity-90" id="currentJourneySubtitle">Parcours spirituel de base</p>
                                    </div>
                                    <div class="text-right">
                                        <div class="text-lg font-bold" id="currentJourneyProgress">1/40</div>
                                        <div class="text-xs opacity-75">jours</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl p-4 mb-4" id="dailyThemeCard">
                            <h4 class="font-bold mb-2" id="journeyTitle">ğŸŒ± Jour 1 : Les Fondations</h4>
                            <p class="text-sm" id="journeyDescription">Aujourd'hui, nous posons les bases de ton parcours spirituel. DÃ©couvre les piliers de la foi chrÃ©tienne.</p>
                        </div>
                        
                        <!-- Barre de progression du jour -->
                        <div class="mb-4">
                            <div class="flex items-center justify-between text-xs text-gray-600 mb-1">
                                <span>Progression du jour</span>
                                <span id="journeyProgress">0%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-emerald-500 to-teal-600 h-2 rounded-full transition-all duration-300" style="width: 0%" id="journeyProgressBar"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ã‰tapes du jour -->
                    <div class="space-y-3 mb-6" id="journeyStepsContainer">
                        <div class="flex items-center p-3 bg-emerald-50 rounded-xl border border-emerald-200 cursor-pointer hover:bg-emerald-100 transition-all" onclick="completeJourneyStep(1)">
                            <div class="w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span id="step1Icon">1</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-emerald-800 text-sm">ğŸ“– Lire Jean 3:16</p>
                                <p class="text-xs text-emerald-600">MÃ©dite sur l'amour de Dieu</p>
                            </div>
                            <div class="text-emerald-600" id="step1Status">â³</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>2</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">ğŸ™ Prier 5 minutes</p>
                                <p class="text-xs text-gray-500">Parle Ã  Dieu de ton cÅ“ur</p>
                            </div>
                            <div class="text-gray-400">ğŸ”’</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>3</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">âœï¸ Ã‰crire une gratitude</p>
                                <p class="text-xs text-gray-500">Note une chose pour laquelle tu es reconnaissant</p>
                            </div>
                            <div class="text-gray-400">ğŸ”’</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>4</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">ğŸ’ Acte de bontÃ©</p>
                                <p class="text-xs text-gray-500">Fais quelque chose de gentil pour quelqu'un</p>
                            </div>
                            <div class="text-gray-400">ğŸ”’</div>
                        </div>
                        
                        <div class="flex items-center p-3 bg-gray-50 rounded-xl border border-gray-200 opacity-50">
                            <div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                <span>5</span>
                            </div>
                            <div class="flex-1">
                                <p class="font-semibold text-gray-600 text-sm">ğŸ¯ RÃ©flexion du jour</p>
                                <p class="text-xs text-gray-500">RÃ©ponds Ã  la question de rÃ©flexion</p>
                            </div>
                            <div class="text-gray-400">ğŸ”’</div>
                        </div>
                    </div>
                    
                    <!-- RÃ©compenses du jour -->
                    <div class="bg-yellow-50 rounded-xl p-4 border border-yellow-200 mb-4">
                        <h5 class="font-semibold text-yellow-800 mb-2 flex items-center">
                            <span class="text-lg mr-2">ğŸ†</span>
                            RÃ©compenses du jour
                        </h5>
                        <div class="grid grid-cols-3 gap-2">
                            <div class="text-center">
                                <div class="text-lg">ğŸŒŸ</div>
                                <div class="text-xs text-yellow-700">+50 XP</div>
                            </div>
                            <div class="text-center">
                                <div class="text-lg">ğŸ–ï¸</div>
                                <div class="text-xs text-yellow-700">Badge Fondation</div>
                            </div>
                            <div class="text-center">
                                <div class="text-lg">ğŸ“œ</div>
                                <div class="text-xs text-yellow-700">Verset du jour</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button onclick="viewJourneyCalendar()" class="bg-emerald-100 text-emerald-700 px-4 py-2 rounded-xl text-sm interactive-btn mr-2">
                            ğŸ“… Voir le calendrier
                        </button>
                        <button onclick="viewJourneyStats()" class="bg-blue-100 text-blue-700 px-4 py-2 rounded-xl text-sm interactive-btn">
                            ğŸ“Š Mes statistiques
                        </button>
                    </div>
                </div>
                
                <!-- Vue Calendrier -->
                <div id="journeyCalendar" class="hidden">
                    <div class="text-center mb-4">
                        <h4 class="font-semibold text-gray-800 mb-2">ğŸ“… Calendrier du Parcours</h4>
                        <p class="text-sm text-gray-600">40 jours de croissance spirituelle</p>
                    </div>
                    
                    <div class="grid grid-cols-7 gap-1 mb-4">
                        <!-- En-tÃªtes des jours -->
                        <div class="text-center text-xs font-medium text-gray-500 p-2">L</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">M</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">M</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">J</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">V</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">S</div>
                        <div class="text-center text-xs font-medium text-gray-500 p-2">D</div>
                        
                        <!-- Jours du calendrier -->
                        <div class="aspect-square bg-green-500 rounded-lg flex items-center justify-center text-white text-xs font-bold">1</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">2</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">3</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">4</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">5</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">6</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">7</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">8</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">9</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">10</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">11</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">12</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">13</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">14</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">15</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">16</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">17</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">18</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">19</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">20</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">21</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">22</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">23</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">24</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">25</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">26</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">27</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">28</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">29</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">30</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">31</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">32</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">33</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">34</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">35</div>
                        
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">36</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">37</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">38</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">39</div>
                        <div class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-600 text-xs">40</div>
                    </div>
                    
                    <div class="flex items-center justify-center space-x-4 text-xs mb-4">
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-green-500 rounded mr-1"></div>
                            <span>TerminÃ©</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-yellow-500 rounded mr-1"></div>
                            <span>En cours</span>
                        </div>
                        <div class="flex items-center">
                            <div class="w-3 h-3 bg-gray-200 rounded mr-1"></div>
                            <span>Ã€ venir</span>
                        </div>
                    </div>
                    
                    <button onclick="backToJourney()" class="w-full bg-emerald-600 text-white py-3 rounded-xl interactive-btn">
                        â† Retour au jour actuel
                    </button>
                </div>
                
                <!-- Vue Statistiques -->
                <div id="journeyStats" class="hidden">
                    <div class="text-center mb-4">
                        <h4 class="font-semibold text-gray-800 mb-2">ğŸ“Š Tes Statistiques</h4>
                        <p class="text-sm text-gray-600">Progression de ton parcours spirituel</p>
                    </div>
                    
                    <div class="space-y-4 mb-6">
                        <div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-4 border border-emerald-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-emerald-800">Jours complÃ©tÃ©s</span>
                                <span class="text-lg font-bold text-emerald-600">1/40</span>
                            </div>
                            <div class="w-full bg-emerald-200 rounded-full h-2">
                                <div class="bg-emerald-500 h-2 rounded-full" style="width: 2.5%"></div>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm font-medium text-purple-800">XP Total</span>
                                <span class="text-lg font-bold text-purple-600">0</span>
                            </div>
                            <div class="text-xs text-purple-600">Niveau 1 â€¢ 0/100 XP pour le niveau suivant</div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div class="bg-blue-50 rounded-xl p-3 border border-blue-200 text-center">
                                <div class="text-2xl font-bold text-blue-600">0</div>
                                <div class="text-xs text-blue-700">Badges gagnÃ©s</div>
                            </div>
                            <div class="bg-yellow-50 rounded-xl p-3 border border-yellow-200 text-center">
                                <div class="text-2xl font-bold text-yellow-600">0</div>
                                <div class="text-xs text-yellow-700">SÃ©rie actuelle</div>
                            </div>
                        </div>
                        
                        <div class="bg-gray-50 rounded-xl p-4">
                            <h5 class="font-semibold text-gray-800 mb-3">ğŸ† Badges disponibles</h5>
                            <div class="grid grid-cols-4 gap-2">
                                <div class="text-center opacity-50">
                                    <div class="text-2xl">ğŸŒ±</div>
                                    <div class="text-xs text-gray-600">Fondation</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">ğŸ™</div>
                                    <div class="text-xs text-gray-600">PriÃ¨re</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">ğŸ“–</div>
                                    <div class="text-xs text-gray-600">Lecture</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">ğŸ’</div>
                                    <div class="text-xs text-gray-600">Service</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">ğŸ”¥</div>
                                    <div class="text-xs text-gray-600">Passion</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">ğŸ•Šï¸</div>
                                    <div class="text-xs text-gray-600">Paix</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">â­</div>
                                    <div class="text-xs text-gray-600">FidÃ©litÃ©</div>
                                </div>
                                <div class="text-center opacity-30">
                                    <div class="text-2xl">ğŸ‘‘</div>
                                    <div class="text-xs text-gray-600">MaÃ®tre</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button onclick="backToJourney()" class="w-full bg-emerald-600 text-white py-3 rounded-xl interactive-btn">
                        â† Retour au jour actuel
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal SÃ©lecteur de Parcours -->
        <div id="journeySelectorModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full max-h-[90vh] overflow-y-auto shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800">ğŸ“š Choisir un Parcours</h3>
                    <button onclick="closeJourneySelector()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        Ã—
                    </button>
                </div>
                
                <div class="space-y-4" id="journeyOptions">
                    <!-- Parcours 1: Les Fondations -->
                    <div class="journey-option bg-gradient-to-br from-emerald-50 to-teal-50 border-2 border-emerald-200 rounded-2xl p-4 cursor-pointer hover:shadow-lg transition-all" onclick="selectJourney(1)">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gradient-to-r from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    ğŸŒ±
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800">Les Fondations</h4>
                                    <p class="text-xs text-gray-600">Parcours spirituel de base</p>
                                </div>
                            </div>
                            <div class="text-emerald-600 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">DÃ©couvre les piliers essentiels de la foi chrÃ©tienne en 40 jours</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-600">
                                <span class="mr-3">ğŸ† 8 badges</span>
                                <span>â­ Niveau dÃ©butant</span>
                            </div>
                            <div class="bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-xs font-bold">
                                En cours
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parcours 2: La Vie de JÃ©sus -->
                    <div class="journey-option bg-gradient-to-br from-blue-50 to-purple-50 border-2 border-blue-200 rounded-2xl p-4 cursor-pointer hover:shadow-lg transition-all" onclick="selectJourney(2)">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    âœï¸
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800">La Vie de JÃ©sus</h4>
                                    <p class="text-xs text-gray-600">Suivre les pas du Sauveur</p>
                                </div>
                            </div>
                            <div class="text-blue-600 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">DÃ©couvre la vie, les enseignements et l'Å“uvre de JÃ©sus-Christ en 40 jours</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-600">
                                <span class="mr-3">ğŸ† 10 badges</span>
                                <span>â­ Niveau intermÃ©diaire</span>
                            </div>
                            <div class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                                ğŸ”’ DÃ©bloquÃ© aprÃ¨s Fondations
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parcours 3: La Vie de Joseph -->
                    <div class="journey-option bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-2xl p-4 cursor-pointer hover:shadow-lg transition-all" onclick="selectJourney(3)">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gradient-to-r from-yellow-500 to-orange-600 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    ğŸŒˆ
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-800">La Vie de Joseph</h4>
                                    <p class="text-xs text-gray-600">De l'Ã©preuve Ã  la gloire</p>
                                </div>
                            </div>
                            <div class="text-yellow-600 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-700 mb-3">DÃ©couvre l'histoire inspirante de Joseph, de ses rÃªves Ã  son rÃ¨gne en Ã‰gypte</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-600">
                                <span class="mr-3">ğŸ† 12 badges</span>
                                <span>â­ Niveau avancÃ©</span>
                            </div>
                            <div class="bg-gray-100 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                                ğŸ”’ DÃ©bloquÃ© aprÃ¨s JÃ©sus
                            </div>
                        </div>
                    </div>
                    
                    <!-- Parcours Ã  venir -->
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-200 rounded-2xl p-4 opacity-60">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-gray-400 rounded-xl flex items-center justify-center text-white text-xl mr-3">
                                    ğŸ”®
                                </div>
                                <div>
                                    <h4 class="font-bold text-gray-600">Parcours Ã  venir</h4>
                                    <p class="text-xs text-gray-500">BientÃ´t disponible</p>
                                </div>
                            </div>
                            <div class="text-gray-500 font-bold text-sm">40 jours</div>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">D'autres parcours passionnants arrivent bientÃ´t !</p>
                        <div class="flex items-center justify-between">
                            <div class="flex items-center text-xs text-gray-500">
                                <span class="mr-3">ğŸ† ? badges</span>
                                <span>â­ Tous niveaux</span>
                            </div>
                            <div class="bg-gray-200 text-gray-600 px-3 py-1 rounded-full text-xs font-bold">
                                ğŸš§ En dÃ©veloppement
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 text-center">
                    <p class="text-xs text-gray-500 mb-3">ğŸ’¡ Conseil : Termine un parcours pour dÃ©bloquer le suivant</p>
                    <button onclick="closeJourneySelector()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded-xl text-sm font-medium">
                        Fermer
                    </button>
                </div>
            </div>
        </div>

        <!-- Modal de RÃ©ponse -->
        <div id="replyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl max-w-sm w-full max-h-[80vh] flex flex-col shadow-2xl">
                <!-- Header -->
                <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-t-3xl">
                    <button onclick="closeReplyModal()" class="text-2xl mr-4 interactive-btn text-white">â†</button>
                    <div class="flex items-center flex-1">
                        <div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-lg mr-3" id="replyUserAvatar">
                            ğŸ‘¤
                        </div>
                        <div>
                            <h3 class="font-semibold" id="replyUserName">Anonyme #1</h3>
                            <p class="text-xs opacity-75">Message reÃ§u</p>
                        </div>
                    </div>
                </div>
                
                <!-- Message original -->
                <div class="p-4 bg-gray-50 border-b">
                    <div class="bg-white rounded-xl p-3 border border-gray-200">
                        <div class="flex items-center mb-2">
                            <span class="bg-purple-100 text-purple-700 px-2 py-1 rounded-full text-xs font-medium" id="replyMessageType">ğŸ™ PriÃ¨re</span>
                            <span class="text-xs text-gray-500 ml-2" id="replyMessageTime">14:32</span>
                        </div>
                        <p class="text-sm text-gray-800" id="replyOriginalMessage">
                            "Peux-tu prier pour mon examen demain ? J'ai besoin de force ğŸ™"
                        </p>
                    </div>
                </div>
                
                <!-- Zone de rÃ©ponse -->
                <div class="flex-1 p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">ğŸ’¬ Ta rÃ©ponse</h4>
                    <textarea id="replyTextarea" placeholder="Ã‰cris ta rÃ©ponse encourageante..." 
                              class="w-full h-32 px-4 py-3 border border-gray-200 rounded-2xl focus:border-purple-500 focus:outline-none text-sm resize-none"
                              maxlength="500"></textarea>
                    <div class="flex items-center justify-between mt-2">
                        <span class="text-xs text-gray-500"><span id="replyCharCount">0</span>/500 caractÃ¨res</span>
                        <div class="flex space-x-2">
                            <button onclick="addReplyEmoji('ğŸ™')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">ğŸ™</button>
                            <button onclick="addReplyEmoji('â¤ï¸')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">â¤ï¸</button>
                            <button onclick="addReplyEmoji('âœ¨')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">âœ¨</button>
                            <button onclick="addReplyEmoji('ğŸ’ª')" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm interactive-btn">ğŸ’ª</button>
                        </div>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="p-4 border-t bg-gray-50 rounded-b-3xl">
                    <div class="space-y-3">
                        <!-- RÃ©ponses rapides -->
                        <div class="grid grid-cols-2 gap-2">
                            <button onclick="setQuickReply('Je prie pour toi ! ğŸ™ Que Dieu te donne la force et la sagesse.')" 
                                    class="bg-blue-100 text-blue-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                ğŸ™ Je prie pour toi
                            </button>
                            <button onclick="setQuickReply('Que Dieu te bÃ©nisse ! âœ¨ Tu peux compter sur mes priÃ¨res.')" 
                                    class="bg-green-100 text-green-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                âœ¨ BÃ©nÃ©dictions
                            </button>
                            <button onclick="setQuickReply('Courage ! ğŸ’ª Dieu est avec toi dans cette Ã©preuve.')" 
                                    class="bg-orange-100 text-orange-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                ğŸ’ª Courage
                            </button>
                            <button onclick="setQuickReply('Amen ! ğŸ•Šï¸ Que la paix de Dieu soit avec toi.')" 
                                    class="bg-purple-100 text-purple-700 px-3 py-2 rounded-xl text-xs font-medium interactive-btn">
                                ğŸ•Šï¸ Paix
                            </button>
                        </div>
                        
                        <!-- Boutons d'action -->
                        <div class="space-y-3">
                            <div class="flex space-x-3">
                                <button onclick="sendReply()" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-3 rounded-2xl interactive-btn">
                                    ğŸ“¤ Envoyer la rÃ©ponse
                                </button>
                                <button onclick="startPrivateChat()" class="bg-blue-100 text-blue-700 px-4 py-3 rounded-2xl interactive-btn">
                                    ğŸ’¬
                                </button>
                            </div>
                            
                            <!-- Nouveau bouton pour gÃ©nÃ©rer le template -->
                            <button onclick="generateReplyTemplateFromModal()" class="w-full bg-gradient-to-r from-orange-500 to-red-500 text-white font-semibold py-3 rounded-2xl interactive-btn">
                                ğŸ“¸ CrÃ©er template pour statut
                            </button>
                        </div>
                        
                        <!-- Option de discussion privÃ©e -->
                        <div class="text-center">
                            <button onclick="startPrivateChat()" class="text-sm text-blue-600 font-medium interactive-btn">
                                ğŸ’¬ Commencer une discussion privÃ©e
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal de GÃ©nÃ©ration de Template -->
        <div id="templateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl max-w-sm w-full max-h-[90vh] flex flex-col shadow-2xl">
                <!-- Header -->
                <div class="flex items-center p-4 border-b bg-gradient-to-r from-purple-500 to-pink-500 text-white rounded-t-3xl">
                    <button onclick="closeTemplateModal()" class="text-2xl mr-4 interactive-btn text-white">â†</button>
                    <div class="flex-1">
                        <h3 class="font-semibold">ğŸ“¸ Template de RÃ©ponse</h3>
                        <p class="text-xs opacity-75">PrÃªt Ã  partager sur ton statut</p>
                    </div>
                </div>
                
                <!-- Template Preview -->
                <div class="flex-1 p-4 bg-gray-50">
                    <div class="bg-white rounded-2xl shadow-lg overflow-hidden mb-4" id="templatePreview">
                        <!-- Template sera gÃ©nÃ©rÃ© ici -->
                    </div>
                    
                    <!-- Informations -->
                    <div class="bg-blue-50 rounded-xl p-3 mb-4 border border-blue-200">
                        <div class="flex items-center mb-2">
                            <span class="text-lg mr-2">ğŸ’¡</span>
                            <h4 class="font-semibold text-blue-800 text-sm">Comment utiliser</h4>
                        </div>
                        <div class="space-y-1 text-xs text-blue-700">
                            <p>â€¢ Sauvegarde cette image sur ton tÃ©lÃ©phone</p>
                            <p>â€¢ Partage-la sur ton statut WhatsApp/Instagram</p>
                            <p>â€¢ Tes amis pourront voir ta rÃ©ponse et ton lien</p>
                        </div>
                    </div>
                    
                    <!-- Lien personnel -->
                    <div class="bg-purple-50 rounded-xl p-3 border border-purple-200">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-semibold text-purple-800 text-sm">ğŸ”— Ton lien PrayLink</span>
                            <button onclick="copyPersonalLink()" class="text-purple-600 text-xs font-medium interactive-btn">ğŸ“‹ Copier</button>
                        </div>
                        <input type="text" id="personalLink" class="w-full text-xs text-purple-600 bg-transparent border-none outline-none" readonly>
                    </div>
                </div>
                
                <!-- Actions -->
                <div class="p-4 border-t bg-gray-50 rounded-b-3xl">
                    <div class="space-y-3">
                        <button onclick="downloadTemplate()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white font-semibold py-3 rounded-2xl interactive-btn">
                            ğŸ“± TÃ©lÃ©charger l'image
                        </button>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="shareToWhatsAppStatus()" class="bg-green-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 interactive-btn">
                                <span class="text-lg">ğŸ“±</span>
                                <span class="text-sm">WhatsApp</span>
                            </button>
                            
                            <button onclick="shareToInstagramStory()" class="bg-gradient-to-br from-purple-500 to-pink-500 text-white font-medium py-3 rounded-xl flex items-center justify-center space-x-2 interactive-btn">
                                <span class="text-lg">ğŸ“·</span>
                                <span class="text-sm">Instagram</span>
                            </button>
                        </div>
                        
                        <button onclick="closeTemplateModal()" class="w-full bg-gray-200 text-gray-700 font-medium py-3 rounded-xl interactive-btn">
                            Fermer
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Envoyer Verset -->
        <div id="sendVersetModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800">ğŸ’Œ Envoyer un Verset</h3>
                    <button onclick="closeSendVersetModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        Ã—
                    </button>
                </div>
                
                <!-- AperÃ§u du verset -->
                <div class="bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl p-4 mb-6 border border-blue-100">
                    <div class="text-center">
                        <div class="text-3xl mb-3">ğŸ“–</div>
                        <p class="text-sm font-medium italic text-gray-700 mb-2" id="sendVersetText">"Car Dieu a tant aimÃ© le monde..."</p>
                        <p class="text-xs text-blue-600 font-bold" id="sendVersetRef">Jean 3:16</p>
                    </div>
                </div>
                
                <!-- Formulaire d'envoi -->
                <div class="space-y-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ“± NumÃ©ro de tÃ©lÃ©phone ou email</label>
                        <input type="text" id="recipientContact" placeholder="06 12 34 56 78 ou email@exemple.com" 
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none text-sm">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ’¬ Message personnel (optionnel)</label>
                        <textarea id="personalMessage" placeholder="Ajoute un message personnel..." 
                                  class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none text-sm resize-none h-20"
                                  maxlength="200"></textarea>
                        <div class="text-xs text-gray-500 mt-1">
                            <span id="messageCharCount">0</span>/200 caractÃ¨res
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ğŸ¨ Choisir un style</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="selectVersetStyle('classic')" class="p-3 border-2 border-blue-200 rounded-xl text-center hover:border-blue-500 transition-all" id="styleClassic">
                                <div class="text-lg mb-1">ğŸ“œ</div>
                                <div class="text-xs">Classique</div>
                            </button>
                            <button onclick="selectVersetStyle('modern')" class="p-3 border-2 border-gray-200 rounded-xl text-center hover:border-blue-500 transition-all" id="styleModern">
                                <div class="text-lg mb-1">âœ¨</div>
                                <div class="text-xs">Moderne</div>
                            </button>
                            <button onclick="selectVersetStyle('elegant')" class="p-3 border-2 border-gray-200 rounded-xl text-center hover:border-blue-500 transition-all" id="styleElegant">
                                <div class="text-lg mb-1">ğŸŒŸ</div>
                                <div class="text-xs">Ã‰lÃ©gant</div>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Boutons d'action -->
                <div class="space-y-3">
                    <button onclick="sendVersetNow()" class="w-full bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold py-4 rounded-2xl hover:shadow-lg transition-all">
                        ğŸ“¤ Envoyer le verset
                    </button>
                    
                    <div class="grid grid-cols-2 gap-3">
                        <button onclick="previewVersetMessage()" class="bg-blue-100 text-blue-700 font-medium py-3 rounded-xl hover:bg-blue-200 transition-all">
                            ğŸ‘€ AperÃ§u
                        </button>
                        <button onclick="saveVersetDraft()" class="bg-gray-100 text-gray-700 font-medium py-3 rounded-xl hover:bg-gray-200 transition-all">
                            ğŸ’¾ Brouillon
                        </button>
                    </div>
                </div>
                
                <!-- Contacts suggÃ©rÃ©s -->
                <div class="mt-6 pt-4 border-t border-gray-200">
                    <h4 class="text-sm font-medium text-gray-700 mb-3">ğŸ‘¥ Contacts suggÃ©rÃ©s</h4>
                    <div class="space-y-2">
                        <button onclick="selectSuggestedContact('Marie', '06 12 34 56 78')" class="w-full flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all text-left">
                            <div class="w-8 h-8 bg-pink-100 rounded-full flex items-center justify-center text-sm mr-3">ğŸŒ¸</div>
                            <div>
                                <p class="text-sm font-medium text-gray-800">Marie</p>
                                <p class="text-xs text-gray-500">06 12 34 56 78</p>
                            </div>
                        </button>
                        <button onclick="selectSuggestedContact('Paul', 'paul@email.com')" class="w-full flex items-center p-2 bg-gray-50 rounded-lg hover:bg-gray-100 transition-all text-left">
                            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-sm mr-3">âš¡</div>
                            <div>
                                <p class="text-sm font-medium text-gray-800">Paul</p>
                                <p class="text-xs text-gray-500">paul@email.com</p>
                            </div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Modal Premium Upgrade -->
        <div id="premiumUpgradeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center p-4 z-50">
            <div class="bg-white rounded-3xl p-6 max-w-sm w-full shadow-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-bold text-gray-800 flex items-center">
                        <span class="text-2xl mr-2">ğŸ‘‘</span>
                        PrayLink Premium
                    </h3>
                    <button onclick="closePremiumModal()" class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-200 transition-all">
                        Ã—
                    </button>
                </div>
                
                <!-- Hero Section -->
                <div class="text-center mb-6">
                    <div class="w-20 h-20 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center text-3xl premium-glow pulse-effect">
                        ğŸ‘‘
                    </div>
                    <h4 class="text-lg font-bold text-gray-800 mb-2">DÃ©bloquer l'expÃ©rience complÃ¨te</h4>
                    <p class="text-sm text-gray-600">AccÃ¨de Ã  tous les jeux premium et fonctionnalitÃ©s exclusives</p>
                </div>
                
                <!-- Avantages Premium -->
                <div class="space-y-3 mb-6">
                    <div class="flex items-center p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-xl border border-yellow-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            âš”ï¸
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">Bataille Biblique</p>
                            <p class="text-xs text-gray-600">DÃ©fie tes amis en temps rÃ©el</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-3 bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl border border-purple-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            ğŸ†
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">Tournoi des ProphÃ¨tes</p>
                            <p class="text-xs text-gray-600">CompÃ©tition mondiale</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-3 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-xl border border-indigo-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            ğŸ­
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">MystÃ¨res Bibliques</p>
                            <p class="text-xs text-gray-600">Ã‰nigmes sacrÃ©es Ã  rÃ©soudre</p>
                        </div>
                    </div>
                    
                    <div class="flex items-center p-3 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border border-emerald-200">
                        <div class="w-10 h-10 bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                            ğŸŒŸ
                        </div>
                        <div>
                            <p class="font-semibold text-gray-800 text-sm">Parcours Spirituel</p>
                            <p class="text-xs text-gray-600">Aventure de 40 jours</p>
                        </div>
                    </div>
                </div>
                
                <!-- Prix et CTA -->
                <div class="bg-gradient-to-br from-yellow-50 to-orange-50 border-2 border-yellow-200 rounded-2xl p-4 mb-4">
                    <div class="text-center">
                        <div class="flex items-center justify-center mb-2">
                            <span class="text-2xl font-bold text-gray-800">4,99â‚¬</span>
                            <span class="text-sm text-gray-600 ml-1">/mois</span>
                        </div>
                        <p class="text-xs text-gray-600 mb-3">Annule Ã  tout moment â€¢ Essai gratuit 7 jours</p>
                        
                        <button onclick="purchasePremium()" class="w-full bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-bold py-4 rounded-2xl premium-glow interactive-btn mb-3">
                            ğŸš€ Commencer l'essai gratuit
                        </button>
                        
                        <p class="text-xs text-gray-500">Paiement sÃ©curisÃ© â€¢ Sans engagement</p>
                    </div>
                </div>
                
                <!-- TÃ©moignages -->
                <div class="text-center">
                    <p class="text-xs text-gray-500 mb-2">â­â­â­â­â­ 4.9/5 (2,847 avis)</p>
                    <p class="text-xs text-gray-600 italic">"Les jeux premium ont transformÃ© ma lecture biblique !" - Marie, 24 ans</p>
                </div>
            </div>
        </div>

    </div>

    <script>
        let currentPage = 'welcomePage';
        let selectedPlatform = '';
        let username = '';
        let profileEmoji = 'ğŸ™';
        let currentQuestionIndex = 0;
        let currentVersetIndex = 0;
        let currentConversation = null;
        let currentFilter = 'all';

        // IMPORTANT: Remplacez cette URL par l'URL de votre script Google Apps Script dÃ©ployÃ©
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbznqEPPRCC79rujx_rKALbzHftiJIZ2WP0-F-jPZ-GDNh6zT0sWCwhyyvNOVdmuR4oiMA/exec';

        // Loader functions
        function showLoader() { document.getElementById('loader').classList.remove('hidden'); document.getElementById('loader').classList.add('flex'); }
        function hideLoader() { document.getElementById('loader').classList.add('hidden'); document.getElementById('loader').classList.remove('flex'); }


        // DonnÃ©es d'indices d'activitÃ©
        const insightsData = {
            visitors: [
                {
                    id: 1,
                    avatar: 'ğŸŒ¸',
                    hint: 'Personne de ton lycÃ©e',
                    location: 'Paris, France',
                    time: '14:32',
                    device: 'iPhone',
                    hasResponded: true
                },
                {
                    id: 2,
                    avatar: 'âš¡',
                    hint: 'Ami de ton frÃ¨re',
                    location: 'Lyon, France',
                    time: '12:15',
                    device: 'Android',
                    hasResponded: false
                },
                {
                    id: 3,
                    avatar: 'âœ¨',
                    hint: 'Quelqu\'un de ton Ã©glise',
                    location: 'Marseille, France',
                    time: '10:45',
                    device: 'iPad',
                    hasResponded: true
                },
                {
                    id: 4,
                    avatar: 'ğŸ”¥',
                    hint: 'Personne de ta classe',
                    location: 'Toulouse, France',
                    time: '09:20',
                    device: 'iPhone',
                    hasResponded: false
                },
                {
                    id: 5,
                    avatar: 'ğŸ’–',
                    hint: 'Ami proche',
                    location: 'Nice, France',
                    time: '08:30',
                    device: 'Android',
                    hasResponded: true
                }
            ],
            responders: [
                {
                    id: 1,
                    avatar: 'ğŸŒ¸',
                    hint: 'Personne de ton lycÃ©e',
                    message: 'Merci pour cette question, elle me fait rÃ©flÃ©chir...',
                    time: '14:35',
                    sentiment: 'positive'
                },
                {
                    id: 3,
                    avatar: 'âœ¨',
                    hint: 'Quelqu\'un de ton Ã©glise',
                    message: 'Ce verset m\'a beaucoup aidÃ© cette semaine ğŸ™',
                    time: '10:50',
                    sentiment: 'positive'
                },
                {
                    id: 5,
                    avatar: 'ğŸ’–',
                    hint: 'Ami proche',
                    message: 'J\'aimerais en parler avec toi en privÃ©',
                    time: '08:45',
                    sentiment: 'neutral'
                }
            ]
        };

        // DonnÃ©es des versets partagÃ©s aujourd'hui
        const todayVerses = [
            {
                id: 1,
                user: 'Marie_2024',
                avatar: 'ğŸŒ¸',
                time: '14:32',
                verse: 'Car Dieu a tant aimÃ© le monde qu\'il a donnÃ© son Fils unique, afin que quiconque croit en lui ne pÃ©risse point, mais qu\'il ait la vie Ã©ternelle.',
                reference: 'Jean 3:16',
                message: 'Ce verset me donne tellement d\'espoir aujourd\'hui ! ğŸ™',
                likes: 12,
                comments: 5,
                shares: 3,
                isLiked: false,
                link: 'https://praylink.app/v/marie2024/1'
            },
            {
                id: 2,
                user: 'David_Foi',
                avatar: 'âš¡',
                time: '12:15',
                verse: 'Je puis tout par celui qui me fortifie.',
                reference: 'Philippiens 4:13',
                message: 'Avant mon entretien d\'embauche... Ce verset me donne la force ! ğŸ’ª',
                likes: 8,
                comments: 3,
                shares: 2,
                isLiked: true,
                link: 'https://praylink.app/v/davidfoi/2'
            },
            {
                id: 3,
                user: 'Sarah_LumiÃ¨re',
                avatar: 'âœ¨',
                time: '10:45',
                verse: 'L\'Ã‰ternel est mon berger: je ne manquerai de rien.',
                reference: 'Psaume 23:1',
                message: 'Dans les moments difficiles, ce psaume me rappelle que Dieu pourvoit Ã  tout ğŸ•Šï¸',
                likes: 15,
                comments: 7,
                shares: 4,
                isLiked: false,
                link: 'https://praylink.app/v/sarahlumiere/3'
            },
            {
                id: 4,
                user: 'Paul_Espoir',
                avatar: 'ğŸ”¥',
                time: '09:20',
                verse: 'Et nous savons que toutes choses concourent au bien de ceux qui aiment Dieu.',
                reference: 'Romains 8:28',
                message: 'MÃªme dans l\'Ã©preuve, Dieu a un plan parfait ! ğŸ™Œ',
                likes: 20,
                comments: 9,
                shares: 6,
                isLiked: true,
                link: 'https://praylink.app/v/paulespoir/4'
            },
            {
                id: 5,
                user: 'Emma_Grace',
                avatar: 'ğŸ’–',
                time: '08:30',
                verse: 'Venez Ã  moi, vous tous qui Ãªtes fatiguÃ©s et chargÃ©s, et je vous donnerai du repos.',
                reference: 'Matthieu 11:28',
                message: 'Pour tous ceux qui sont Ã©puisÃ©s... JÃ©sus nous invite au repos â¤ï¸',
                likes: 18,
                comments: 12,
                shares: 8,
                isLiked: false,
                link: 'https://praylink.app/v/emmagrace/5'
            }
        ];

        // Messages de conversation exemple
        const conversationData = {
            'Marie_2024': {
                avatar: 'ğŸŒ¸',
                status: 'En ligne',
                messages: [
                    { type: 'received', text: 'Salut ! J\'ai vu que tu as aimÃ© mon verset ğŸ˜Š', time: '14:35' },
                    { type: 'received', text: 'Jean 3:16 me touche vraiment en ce moment', time: '14:35' },
                    { type: 'sent', text: 'Salut Marie ! Oui, ce verset est magnifique ğŸ™', time: '14:37' },
                    { type: 'received', text: 'Tu as un verset qui te parle en ce moment ?', time: '14:38' }
                ]
            }
        };

        // Base de donnÃ©es de questions infinies
        const questionCategories = {
            versets: [
                'Quel verset biblique te parle aujourd\'hui ?',
                'Envoie-moi ton verset prÃ©fÃ©rÃ©, anonymement',
                'Quel verset t\'a aidÃ© Ã  traverser une Ã©preuve ?',
                'Si tu devais offrir un verset Ã  quelqu\'un ce soir ?',
                'Quel verset te donne de l\'espoir ?',
                'Partage un verset qui t\'a marquÃ© cette semaine',
                'Quel verset rÃ©cites-tu quand tu as peur ?',
                'Un verset qui te fait sourire ?',
                'Le verset que tu aimerais graver dans ton cÅ“ur ?',
                'Quel verset t\'aide Ã  pardonner ?',
                'Un verset pour les moments difficiles ?',
                'Le verset qui dÃ©crit le mieux l\'amour de Dieu ?',
                'Quel verset te rappelle la fidÃ©litÃ© de Dieu ?',
                'Un verset qui t\'encourage Ã  persÃ©vÃ©rer ?',
                'Le verset qui t\'aide Ã  avoir confiance ?',
                'Quel verset te parle de la paix ?',
                'Un verset sur la joie qui te touche ?',
                'Le verset qui t\'aide dans tes relations ?',
                'Quel verset te rappelle ta valeur aux yeux de Dieu ?',
                'Un verset qui t\'aide Ã  gÃ©rer le stress ?'
            ],
            foi: [
                'Qu\'est-ce que la foi pour toi ?',
                'Comment ta foi a-t-elle grandi cette annÃ©e ?',
                'Raconte un moment oÃ¹ ta foi a Ã©tÃ© testÃ©e',
                'Qu\'est-ce qui renforce ta foi au quotidien ?',
                'Comment expliques-tu ta foi Ã  tes amis ?',
                'Quel est ton plus grand dÃ©fi de foi ?',
                'Comment pries-tu quand tu doutes ?',
                'Qu\'est-ce qui t\'a amenÃ© Ã  croire ?',
                'Comment vois-tu Dieu dans ta vie ?',
                'Quel miracle as-tu vÃ©cu rÃ©cemment ?',
                'Comment Dieu t\'a-t-il surpris cette semaine ?',
                'Qu\'est-ce que tu aimerais demander Ã  JÃ©sus ?',
                'Comment sens-tu la prÃ©sence de Dieu ?',
                'Quel est ton tÃ©moignage en une phrase ?',
                'Comment ta foi influence-t-elle tes choix ?',
                'Qu\'est-ce que tu aimerais voir Dieu faire ?',
                'Comment Dieu t\'a-t-il consolÃ© rÃ©cemment ?',
                'Quel aspect de Dieu t\'Ã©merveille le plus ?',
                'Comment partages-tu ta foi avec les autres ?',
                'Qu\'est-ce que tu apprends sur Dieu en ce moment ?'
            ],
            priere: [
                'Comment pries-tu quand tu es triste ?',
                'Quelle est ta priÃ¨re du matin ?',
                'Pour quoi pries-tu le plus souvent ?',
                'Comment Dieu a-t-il rÃ©pondu Ã  tes priÃ¨res ?',
                'Quel est ton lieu de priÃ¨re prÃ©fÃ©rÃ© ?',
                'Comment pries-tu quand tu es en colÃ¨re ?',
                'Quelle priÃ¨re t\'a le plus marquÃ© ?',
                'Comment pries-tu pour tes amis ?',
                'Qu\'est-ce qui t\'aide Ã  te concentrer en priant ?',
                'Comment pries-tu dans les transports ?',
                'Quelle est ta priÃ¨re avant de dormir ?',
                'Comment pries-tu quand tu es stressÃ© ?',
                'Pour qui aimerais-tu qu\'on prie ?',
                'Comment pries-tu en groupe ?',
                'Quelle priÃ¨re de la Bible t\'inspire ?',
                'Comment pries-tu quand tu es reconnaissant ?',
                'Qu\'est-ce que tu demandes le plus Ã  Dieu ?',
                'Comment pries-tu pour ton avenir ?',
                'Quelle est ta priÃ¨re d\'intercession ?',
                'Comment pries-tu dans la nature ?'
            ],
            personnages: [
                'Quel personnage biblique t\'inspire le plus ?',
                'Si tu pouvais dÃ®ner avec un personnage biblique ?',
                'Quel personnage biblique te ressemble ?',
                'Quelle femme de la Bible t\'inspire ?',
                'Quel roi de la Bible admires-tu ?',
                'Quel prophÃ¨te aimerais-tu rencontrer ?',
                'Quel disciple de JÃ©sus te ressemble ?',
                'Quelle histoire biblique te marque ?',
                'Quel personnage biblique a eu le plus de courage ?',
                'Qui dans la Bible a montrÃ© le plus d\'amour ?',
                'Quel personnage biblique a surmontÃ© ses peurs ?',
                'Qui dans la Bible t\'apprend la patience ?',
                'Quel personnage biblique a eu la foi la plus forte ?',
                'Qui dans la Bible t\'inspire pour le pardon ?',
                'Quel personnage biblique Ã©tait le plus fidÃ¨le ?',
                'Qui dans la Bible a montrÃ© le plus d\'humilitÃ© ?',
                'Quel personnage biblique t\'apprend la persÃ©vÃ©rance ?',
                'Qui dans la Bible a eu le cÅ“ur le plus gÃ©nÃ©reux ?',
                'Quel personnage biblique t\'inspire pour servir ?',
                'Qui dans la Bible a montrÃ© le plus de sagesse ?'
            ],
            vie: [
                'Comment vis-tu ta foi au travail/Ã©cole ?',
                'Quel dÃ©fi spirituel traverses-tu ?',
                'Comment Dieu guide-t-il tes dÃ©cisions ?',
                'Qu\'est-ce que tu aimerais changer dans ta vie ?',
                'Comment gÃ¨res-tu les tentations ?',
                'Qu\'est-ce qui te rapproche de Dieu ?',
                'Comment aides-tu les autres autour de toi ?',
                'Quel fruit de l\'Esprit dÃ©veloppes-tu ?',
                'Comment gÃ¨res-tu les conflits ?',
                'Qu\'est-ce que tu apprends sur l\'amour ?',
                'Comment pratiques-tu le pardon ?',
                'Quel service rends-tu Ã  ton Ã©glise ?',
                'Comment honores-tu tes parents ?',
                'Qu\'est-ce qui te donne de la joie ?',
                'Comment gÃ¨res-tu l\'anxiÃ©tÃ© ?',
                'Qu\'est-ce que tu fais pour grandir spirituellement ?',
                'Comment aimes-tu tes ennemis ?',
                'Qu\'est-ce que tu sacrifies pour Dieu ?',
                'Comment utilises-tu tes talents pour Dieu ?',
                'Qu\'est-ce que tu fais pour la justice ?'
            ],
            espoir: [
                'Qu\'est-ce qui te donne de l\'espoir aujourd\'hui ?',
                'Comment vois-tu ton avenir avec Dieu ?',
                'Quel rÃªve as-tu pour le royaume de Dieu ?',
                'Comment Dieu restaure-t-il ta vie ?',
                'Qu\'est-ce que tu attends avec impatience ?',
                'Comment l\'espoir change-t-il ta perspective ?',
                'Quel miracle espÃ¨res-tu voir ?',
                'Comment encourages-tu les autres ?',
                'Qu\'est-ce qui te motive Ã  continuer ?',
                'Comment vois-tu Dieu agir dans le monde ?',
                'Quel changement espÃ¨res-tu voir ?',
                'Comment l\'espoir t\'aide-t-il dans les Ã©preuves ?',
                'Qu\'est-ce que tu espÃ¨res apprendre ?',
                'Comment partages-tu l\'espoir avec les autres ?',
                'Quel impact veux-tu avoir ?',
                'Comment l\'espoir influence-t-il tes priÃ¨res ?',
                'Qu\'est-ce que tu espÃ¨res pour ta famille ?',
                'Comment l\'espoir change-t-il tes relations ?',
                'Quel hÃ©ritage spirituel veux-tu laisser ?',
                'Comment l\'espoir t\'aide-t-il Ã  pardonner ?'
            ]
        };

        const questionEmojis = ['ğŸ“–', 'ğŸ™', 'ğŸ’', 'âœ¨', 'ğŸ’ª', 'ğŸŒŸ', 'â¤ï¸', 'ğŸ•Šï¸', 'ğŸ”¥', 'ğŸ’«', 'ğŸŒˆ', 'â­', 'ğŸ’', 'ğŸ¯', 'ğŸŒ¸', 'ğŸ¦‹', 'ğŸŒ…', 'ğŸµ', 'ğŸ†', 'ğŸ’–'];
        const questionColors = [
            'from-blue-500 to-indigo-600',
            'from-purple-500 to-pink-600', 
            'from-green-500 to-teal-600',
            'from-pink-500 to-rose-600',
            'from-yellow-500 to-orange-600',
            'from-indigo-500 to-purple-600',
            'from-amber-500 to-yellow-600',
            'from-blue-400 to-cyan-500',
            'from-violet-500 to-purple-600',
            'from-emerald-500 to-green-600',
            'from-red-500 to-pink-600',
            'from-teal-500 to-cyan-600',
            'from-orange-500 to-red-600',
            'from-lime-500 to-green-600',
            'from-fuchsia-500 to-pink-600',
            'from-sky-500 to-blue-600',
            'from-rose-500 to-pink-600',
            'from-cyan-500 to-teal-600',
            'from-indigo-400 to-purple-500',
            'from-emerald-400 to-teal-500'
        ];

        // Fonction pour gÃ©nÃ©rer une question alÃ©atoire infinie
        function generateInfiniteQuestion() {
            const categories = Object.keys(questionCategories);
            const randomCategory = categories[Math.floor(Math.random() * categories.length)];
            const categoryQuestions = questionCategories[randomCategory];
            const randomQuestion = categoryQuestions[Math.floor(Math.random() * categoryQuestions.length)];
            const randomEmoji = questionEmojis[Math.floor(Math.random() * questionEmojis.length)];
            const randomColor = questionColors[Math.floor(Math.random() * questionColors.length)];
            
            return {
                text: randomQuestion,
                emoji: randomEmoji,
                color: randomColor,
                buttonColor: 'bg-purple-600',
                category: randomCategory
            };
        }

        // Questions actuelles (gÃ©nÃ©rÃ©es dynamiquement)
        let allQuestions = [];
        let totalQuestionsGenerated = 0;

        // Initialiser avec 100 questions
        function initializeQuestions() {
            allQuestions = [];
            for (let i = 0; i < 100; i++) {
                allQuestions.push(generateInfiniteQuestion());
                totalQuestionsGenerated++;
            }
        }

        // Versets bibliques
        const allVersets = [
            { text: "Car Dieu a tant aimÃ© le monde qu'il a donnÃ© son Fils unique, afin que quiconque croit en lui ne pÃ©risse point, mais qu'il ait la vie Ã©ternelle.", ref: "Jean 3:16" },
            { text: "Je puis tout par celui qui me fortifie.", ref: "Philippiens 4:13" },
            { text: "L'Ã‰ternel est mon berger: je ne manquerai de rien.", ref: "Psaume 23:1" },
            { text: "Cherchez premiÃ¨rement le royaume et la justice de Dieu; et toutes ces choses vous seront donnÃ©es par-dessus.", ref: "Matthieu 6:33" },
            { text: "Car mes pensÃ©es ne sont pas vos pensÃ©es, et vos voies ne sont pas mes voies, dit l'Ã‰ternel.", ref: "Ã‰saÃ¯e 55:8" },
            { text: "Venez Ã  moi, vous tous qui Ãªtes fatiguÃ©s et chargÃ©s, et je vous donnerai du repos.", ref: "Matthieu 11:28" },
            { text: "Et nous savons que toutes choses concourent au bien de ceux qui aiment Dieu.", ref: "Romains 8:28" },
            { text: "Que votre cÅ“ur ne se trouble point. Croyez en Dieu, et croyez en moi.", ref: "Jean 14:1" },
            { text: "L'Ã‰ternel combattra pour vous; et vous, gardez le silence.", ref: "Exode 14:14" },
            { text: "Car lÃ  oÃ¹ deux ou trois sont assemblÃ©s en mon nom, je suis au milieu d'eux.", ref: "Matthieu 18:20" }
        ];

        // Quiz data
        let quizData = {
            questions: [
                {
                    question: "Qui a construit l'arche ?",
                    options: ["A) MoÃ¯se", "B) NoÃ©", "C) Abraham", "D) David"],
                    correct: 1
                },
                {
                    question: "Combien de disciples JÃ©sus avait-il ?",
                    options: ["A) 10", "B) 11", "C) 12", "D) 13"],
                    correct: 2
                },
                {
                    question: "Dans quelle ville JÃ©sus est-il nÃ© ?",
                    options: ["A) Nazareth", "B) JÃ©rusalem", "C) BethlÃ©em", "D) CapharnaÃ¼m"],
                    correct: 2
                },
                {
                    question: "Qui a trahi JÃ©sus ?",
                    options: ["A) Pierre", "B) Jean", "C) Judas", "D) Thomas"],
                    correct: 2
                },
                {
                    question: "Combien de jours JÃ©sus a-t-il jeÃ»nÃ© ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 60"],
                    correct: 1
                },
                {
                    question: "Qui Ã©tait le roi le plus sage d'IsraÃ«l ?",
                    options: ["A) David", "B) Salomon", "C) SaÃ¼l", "D) Josias"],
                    correct: 1
                },
                {
                    question: "Combien de livres y a-t-il dans la Bible ?",
                    options: ["A) 64", "B) 65", "C) 66", "D) 67"],
                    correct: 2
                },
                {
                    question: "Qui a Ã©crit le plus de livres du Nouveau Testament ?",
                    options: ["A) Pierre", "B) Jean", "C) Paul", "D) Matthieu"],
                    correct: 2
                },
                {
                    question: "Quel Ã©tait le mÃ©tier de Pierre avant de suivre JÃ©sus ?",
                    options: ["A) Charpentier", "B) PÃªcheur", "C) Berger", "D) Collecteur d'impÃ´ts"],
                    correct: 1
                },
                {
                    question: "Combien de plaies Dieu a-t-il envoyÃ©es sur l'Ã‰gypte ?",
                    options: ["A) 8", "B) 9", "C) 10", "D) 12"],
                    correct: 2
                },
                {
                    question: "Qui a Ã©tÃ© avalÃ© par un grand poisson ?",
                    options: ["A) Jonas", "B) Ã‰lie", "C) Ã‰zÃ©chiel", "D) Daniel"],
                    correct: 0
                },
                {
                    question: "Combien d'annÃ©es les IsraÃ©lites ont-ils errÃ© dans le dÃ©sert ?",
                    options: ["A) 30", "B) 35", "C) 40", "D) 50"],
                    correct: 2
                },
                {
                    question: "Qui Ã©tait la mÃ¨re de JÃ©sus ?",
                    options: ["A) Marie", "B) Marthe", "C) Marie-Madeleine", "D) Ã‰lisabeth"],
                    correct: 0
                },
                {
                    question: "Quel Ã©tait le nom du jardin oÃ¹ Adam et Ãˆve vivaient ?",
                    options: ["A) GethsÃ©manÃ©", "B) Ã‰den", "C) Oliviers", "D) SinaÃ¯"],
                    correct: 1
                },
                {
                    question: "Qui a baptisÃ© JÃ©sus ?",
                    options: ["A) Pierre", "B) Jean l'Ã‰vangÃ©liste", "C) Jean-Baptiste", "D) AndrÃ©"],
                    correct: 2
                },
                {
                    question: "Combien de frÃ¨res Joseph avait-il ?",
                    options: ["A) 10", "B) 11", "C) 12", "D) 13"],
                    correct: 1
                },
                {
                    question: "Qui a reÃ§u les Dix Commandements ?",
                    options: ["A) Abraham", "B) MoÃ¯se", "C) David", "D) Salomon"],
                    correct: 1
                },
                {
                    question: "Dans quel fleuve JÃ©sus a-t-il Ã©tÃ© baptisÃ© ?",
                    options: ["A) Nil", "B) Euphrate", "C) Jourdain", "D) Tigre"],
                    correct: 2
                },
                {
                    question: "Qui Ã©tait le pÃ¨re de Jean-Baptiste ?",
                    options: ["A) Zacharie", "B) SimÃ©on", "C) Joseph", "D) HÃ©rode"],
                    correct: 0
                },
                {
                    question: "Combien de pains JÃ©sus a-t-il multipliÃ©s pour nourrir 5000 personnes ?",
                    options: ["A) 3", "B) 5", "C) 7", "D) 12"],
                    correct: 1
                },
                {
                    question: "Qui a niÃ© connaÃ®tre JÃ©sus trois fois ?",
                    options: ["A) Jean", "B) Pierre", "C) Thomas", "D) Judas"],
                    correct: 1
                },
                {
                    question: "Quel Ã©tait le nom du mont oÃ¹ MoÃ¯se a reÃ§u les commandements ?",
                    options: ["A) Carmel", "B) Horeb", "C) SinaÃ¯", "D) Sion"],
                    correct: 2
                },
                {
                    question: "Qui Ã©tait le plus petit des disciples ?",
                    options: ["A) Matthieu", "B) ZachÃ©e", "C) Jean", "D) AndrÃ©"],
                    correct: 1
                },
                {
                    question: "Combien de fois par jour Daniel priait-il ?",
                    options: ["A) 2", "B) 3", "C) 5", "D) 7"],
                    correct: 1
                },
                {
                    question: "Qui a construit le premier temple de JÃ©rusalem ?",
                    options: ["A) David", "B) Salomon", "C) Esdras", "D) NÃ©hÃ©mie"],
                    correct: 1
                },
                {
                    question: "Quel Ã©tait le nom de la femme d'Abraham ?",
                    options: ["A) Rachel", "B) LÃ©a", "C) Sara", "D) RÃ©becca"],
                    correct: 2
                },
                {
                    question: "Combien d'animaux de chaque espÃ¨ce NoÃ© a-t-il pris dans l'arche ?",
                    options: ["A) 1 couple", "B) 2 couples", "C) 7 couples", "D) Ã‡a dÃ©pend de l'espÃ¨ce"],
                    correct: 3
                },
                {
                    question: "Qui Ã©tait le roi gÃ©ant que David a vaincu ?",
                    options: ["A) Goliath", "B) Og", "C) Sihon", "D) Nebucadnetsar"],
                    correct: 0
                },
                {
                    question: "Dans quelle ville Paul a-t-il Ã©tÃ© converti ?",
                    options: ["A) JÃ©rusalem", "B) Damas", "C) Antioche", "D) Tarse"],
                    correct: 1
                },
                {
                    question: "Qui Ã©tait la sÅ“ur de MoÃ¯se ?",
                    options: ["A) DÃ©bora", "B) Esther", "C) Miriam", "D) Ruth"],
                    correct: 2
                },
                {
                    question: "Combien de jours et nuits a durÃ© le dÃ©luge ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 150"],
                    correct: 1
                },
                {
                    question: "Qui Ã©tait le pÃ¨re d'Isaac ?",
                    options: ["A) Abraham", "B) Jacob", "C) NoÃ©", "D) Adam"],
                    correct: 0
                },
                {
                    question: "Quel Ã©tait le nom du serviteur d'Abraham ?",
                    options: ["A) Ã‰liÃ©zer", "B) Lot", "C) IsmaÃ«l", "D) Laban"],
                    correct: 0
                },
                {
                    question: "Qui a interprÃ©tÃ© les rÃªves de Pharaon ?",
                    options: ["A) MoÃ¯se", "B) Joseph", "C) Daniel", "D) Ã‰zÃ©chiel"],
                    correct: 1
                },
                {
                    question: "Combien d'Ã©pouses le roi Salomon avait-il ?",
                    options: ["A) 300", "B) 500", "C) 700", "D) 1000"],
                    correct: 2
                },
                {
                    question: "Qui Ã©tait la mÃ¨re de Samuel ?",
                    options: ["A) Anne", "B) Ruth", "C) DÃ©bora", "D) Esther"],
                    correct: 0
                },
                {
                    question: "Dans quelle ville JÃ©sus a-t-il grandi ?",
                    options: ["A) BethlÃ©em", "B) Nazareth", "C) CapharnaÃ¼m", "D) JÃ©rusalem"],
                    correct: 1
                },
                {
                    question: "Qui Ã©tait le premier roi d'IsraÃ«l ?",
                    options: ["A) David", "B) Salomon", "C) SaÃ¼l", "D) Samuel"],
                    correct: 2
                },
                {
                    question: "Combien de chapitres y a-t-il dans le livre des Psaumes ?",
                    options: ["A) 120", "B) 130", "C) 140", "D) 150"],
                    correct: 3
                },
                {
                    question: "Qui Ã©tait l'Ã©pouse de Jacob qu'il aimait le plus ?",
                    options: ["A) LÃ©a", "B) Rachel", "C) Bilha", "D) Zilpa"],
                    correct: 1
                },
                {
                    question: "Quel Ã©tait le nom du frÃ¨re de MoÃ¯se ?",
                    options: ["A) Aaron", "B) JosuÃ©", "C) Caleb", "D) Ã‰lÃ©azar"],
                    correct: 0
                }
            ],
            currentQuestion: 0,
            score: 0,
            selectedAnswer: null,
            questionsAnswered: 0
        };

        // Battle game data
        let battleData = {
            currentRound: 1,
            maxRounds: 5,
            playerScore: 0,
            opponentScore: 0,
            timeLeft: 10,
            timer: null,
            selectedAnswer: null,
            currentQuestion: 0,
            opponentName: 'David_Foi',
            questions: [
                {
                    question: "Qui a construit l'arche de NoÃ© ?",
                    options: ["A) MoÃ¯se", "B) NoÃ©", "C) Abraham", "D) David"],
                    correct: 1
                },
                {
                    question: "Combien de disciples JÃ©sus avait-il ?",
                    options: ["A) 10", "B) 11", "C) 12", "D) 13"],
                    correct: 2
                },
                {
                    question: "Dans quelle ville JÃ©sus est-il nÃ© ?",
                    options: ["A) Nazareth", "B) JÃ©rusalem", "C) BethlÃ©em", "D) CapharnaÃ¼m"],
                    correct: 2
                },
                {
                    question: "Qui a trahi JÃ©sus ?",
                    options: ["A) Pierre", "B) Jean", "C) Judas", "D) Thomas"],
                    correct: 2
                },
                {
                    question: "Combien de jours JÃ©sus a-t-il jeÃ»nÃ© ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 60"],
                    correct: 1
                },
                {
                    question: "Qui Ã©tait le roi le plus sage d'IsraÃ«l ?",
                    options: ["A) David", "B) Salomon", "C) SaÃ¼l", "D) Josias"],
                    correct: 1
                },
                {
                    question: "Qui a reÃ§u les Dix Commandements ?",
                    options: ["A) Abraham", "B) MoÃ¯se", "C) David", "D) Salomon"],
                    correct: 1
                },
                {
                    question: "Dans quel fleuve JÃ©sus a-t-il Ã©tÃ© baptisÃ© ?",
                    options: ["A) Nil", "B) Euphrate", "C) Jourdain", "D) Tigre"],
                    correct: 2
                },
                {
                    question: "Qui Ã©tait le pÃ¨re de Jean-Baptiste ?",
                    options: ["A) Zacharie", "B) SimÃ©on", "C) Joseph", "D) HÃ©rode"],
                    correct: 0
                },
                {
                    question: "Combien de pains JÃ©sus a-t-il multipliÃ©s pour nourrir 5000 personnes ?",
                    options: ["A) 3", "B) 5", "C) 7", "D) 12"],
                    correct: 1
                }
            ]
        };

        // Memory game data
        let memoryData = {
            currentLevel: 1,
            score: 0,
            flippedCards: [],
            matchedPairs: 0,
            moves: 0,
            timeLeft: 60,
            timer: null,
            cards: [
                { id: 1, name: 'NoÃ©', emoji: 'ğŸš¢', description: 'Constructeur de l\'arche' },
                { id: 2, name: 'MoÃ¯se', emoji: 'ğŸ“œ', description: 'LibÃ©rateur d\'IsraÃ«l' },
                { id: 3, name: 'David', emoji: 'ğŸ‘‘', description: 'Roi berger' },
                { id: 4, name: 'Salomon', emoji: 'ğŸ›ï¸', description: 'Roi sage' },
                { id: 5, name: 'Daniel', emoji: 'ğŸ¦', description: 'Dans la fosse aux lions' },
                { id: 6, name: 'Jonas', emoji: 'ğŸ‹', description: 'AvalÃ© par un poisson' },
                { id: 7, name: 'Abraham', emoji: 'â­', description: 'PÃ¨re de la foi' },
                { id: 8, name: 'Joseph', emoji: 'ğŸŒˆ', description: 'Manteau multicolore' },
                { id: 9, name: 'Ã‰lie', emoji: 'ğŸ”¥', description: 'ProphÃ¨te du feu' },
                { id: 10, name: 'Samuel', emoji: 'ğŸ•¯ï¸', description: 'ProphÃ¨te enfant' },
                { id: 11, name: 'JosuÃ©', emoji: 'âš”ï¸', description: 'ConquÃ©rant de Canaan' },
                { id: 12, name: 'GÃ©dÃ©on', emoji: 'ğŸº', description: 'Juge victorieux' }
            ]
        };

        // Verse game data
        let verseData = {
            verses: [
                {
                    text: "Car Dieu a tant aimÃ© le monde qu'il a donnÃ© son Fils _____, afin que quiconque croit en lui ne pÃ©risse point, mais qu'il ait la vie _____.",
                    answers: ["unique", "Ã©ternelle"],
                    ref: "Jean 3:16"
                },
                {
                    text: "Je suis le _____ et la _____. Nul ne vient au PÃ¨re que par moi.",
                    answers: ["chemin", "vÃ©ritÃ©"],
                    ref: "Jean 14:6"
                },
                {
                    text: "Je puis _____ par celui qui me _____.",
                    answers: ["tout", "fortifie"],
                    ref: "Philippiens 4:13"
                },
                {
                    text: "L'Ã‰ternel est mon _____ : je ne _____ de rien.",
                    answers: ["berger", "manquerai"],
                    ref: "Psaume 23:1"
                },
                {
                    text: "Cherchez premiÃ¨rement le _____ et la _____ de Dieu.",
                    answers: ["royaume", "justice"],
                    ref: "Matthieu 6:33"
                },
                {
                    text: "Venez Ã  moi, vous tous qui Ãªtes _____ et _____, et je vous donnerai du repos.",
                    answers: ["fatiguÃ©s", "chargÃ©s"],
                    ref: "Matthieu 11:28"
                },
                {
                    text: "Et nous savons que toutes choses concourent au _____ de ceux qui _____ Dieu.",
                    answers: ["bien", "aiment"],
                    ref: "Romains 8:28"
                },
                {
                    text: "Que votre _____ ne se trouble point. Croyez en Dieu, et croyez en _____.",
                    answers: ["cÅ“ur", "moi"],
                    ref: "Jean 14:1"
                },
                {
                    text: "L'Ã‰ternel _____ pour vous ; et vous, gardez le _____.",
                    answers: ["combattra", "silence"],
                    ref: "Exode 14:14"
                },
                {
                    text: "Car lÃ  oÃ¹ _____ ou _____ sont assemblÃ©s en mon nom, je suis au milieu d'eux.",
                    answers: ["deux", "trois"],
                    ref: "Matthieu 18:20"
                },
                {
                    text: "Confie-toi en l'Ã‰ternel de tout ton _____, et ne t'appuie pas sur ta propre _____.",
                    answers: ["cÅ“ur", "intelligence"],
                    ref: "Proverbes 3:5"
                },
                {
                    text: "Car mes _____ ne sont pas vos _____, dit l'Ã‰ternel.",
                    answers: ["pensÃ©es", "pensÃ©es"],
                    ref: "Ã‰saÃ¯e 55:8"
                },
                {
                    text: "Ne crains rien, car je suis avec toi ; ne promÃ¨ne pas des regards _____, car je suis ton _____.",
                    answers: ["inquiets", "Dieu"],
                    ref: "Ã‰saÃ¯e 41:10"
                },
                {
                    text: "L'Ã‰ternel ton Dieu est au _____ de toi, comme un hÃ©ros qui _____.",
                    answers: ["milieu", "sauve"],
                    ref: "Sophonie 3:17"
                },
                {
                    text: "Celui qui demeure sous l'_____ du TrÃ¨s-Haut repose Ã  l'_____ du Tout-Puissant.",
                    answers: ["abri", "ombre"],
                    ref: "Psaume 91:1"
                },
                {
                    text: "JÃ©sus lui dit : Je suis la _____ et la _____ ; celui qui croit en moi vivra.",
                    answers: ["rÃ©surrection", "vie"],
                    ref: "Jean 11:25"
                },
                {
                    text: "Mais ceux qui se _____ en l'Ã‰ternel renouvellent leur _____ ; ils prennent le vol comme les aigles.",
                    answers: ["confient", "force"],
                    ref: "Ã‰saÃ¯e 40:31"
                },
                {
                    text: "Car c'est par la _____ que vous Ãªtes sauvÃ©s, par le moyen de la _____ ; et cela ne vient pas de vous.",
                    answers: ["grÃ¢ce", "foi"],
                    ref: "Ã‰phÃ©siens 2:8"
                },
                {
                    text: "Remets ton _____ Ã  l'Ã‰ternel, et il _____.",
                    answers: ["sort", "agira"],
                    ref: "Psaume 37:5"
                },
                {
                    text: "Approchez-vous de Dieu, et il s'_____ de vous.",
                    answers: ["approchera"],
                    ref: "Jacques 4:8"
                },
                {
                    text: "Car l'Ã‰ternel prend _____ Ã  son peuple, et il a _____ de ses malheureux.",
                    answers: ["plaisir", "compassion"],
                    ref: "Psaume 149:4"
                },
                {
                    text: "Heureux ceux qui ont le cÅ“ur _____, car ils _____ Dieu !",
                    answers: ["pur", "verront"],
                    ref: "Matthieu 5:8"
                },
                {
                    text: "Demandez, et l'on vous _____ ; cherchez, et vous _____ ; frappez, et l'on vous ouvrira.",
                    answers: ["donnera", "trouverez"],
                    ref: "Matthieu 7:7"
                },
                {
                    text: "L'Ã‰ternel est _____ et _____ ; lent Ã  la colÃ¨re et riche en bontÃ©.",
                    answers: ["misÃ©ricordieux", "compatissant"],
                    ref: "Psaume 103:8"
                },
                {
                    text: "GoÃ»tez et voyez combien l'Ã‰ternel est _____ ! Heureux l'homme qui cherche en lui son _____ !",
                    answers: ["bon", "refuge"],
                    ref: "Psaume 34:8"
                },
                {
                    text: "Si nous _____ nos pÃ©chÃ©s, il est _____ et juste pour nous les pardonner.",
                    answers: ["confessons", "fidÃ¨le"],
                    ref: "1 Jean 1:9"
                },
                {
                    text: "Car Dieu n'est pas un Dieu de _____, mais de _____.",
                    answers: ["dÃ©sordre", "paix"],
                    ref: "1 Corinthiens 14:33"
                },
                {
                    text: "RÃ©jouissez-vous toujours dans le _____ ; je le dis encore : _____-vous !",
                    answers: ["Seigneur", "rÃ©jouissez"],
                    ref: "Philippiens 4:4"
                },
                {
                    text: "Ne vous _____ de rien ; mais en toute chose faites connaÃ®tre vos besoins Ã  Dieu par des _____ et des supplications.",
                    answers: ["inquiÃ©tez", "priÃ¨res"],
                    ref: "Philippiens 4:6"
                },
                {
                    text: "Et la _____ de Dieu, qui surpasse toute _____, gardera vos cÅ“urs et vos pensÃ©es en JÃ©sus-Christ.",
                    answers: ["paix", "intelligence"],
                    ref: "Philippiens 4:7"
                },
                {
                    text: "JÃ©sus-Christ est le _____ hier, aujourd'hui, et Ã©ternellement.",
                    answers: ["mÃªme"],
                    ref: "HÃ©breux 13:8"
                },
                {
                    text: "Car nous marchons par la _____, et non par la _____.",
                    answers: ["foi", "vue"],
                    ref: "2 Corinthiens 5:7"
                },
                {
                    text: "Tout ce que vous ferez, faites-le de bon _____, comme pour le _____, et non pour des hommes.",
                    answers: ["cÅ“ur", "Seigneur"],
                    ref: "Colossiens 3:23"
                },
                {
                    text: "Car il n'y a sous le ciel aucun autre _____ qui ait Ã©tÃ© donnÃ© parmi les hommes, par lequel nous devions Ãªtre _____.",
                    answers: ["nom", "sauvÃ©s"],
                    ref: "Actes 4:12"
                },
                {
                    text: "Ainsi la _____ vient de ce qu'on entend, et ce qu'on entend vient de la _____ de Christ.",
                    answers: ["foi", "parole"],
                    ref: "Romains 10:17"
                },
                {
                    text: "Soyez dans la _____, mes frÃ¨res, perfectionnez-vous, consolez-vous, ayez un mÃªme _____.",
                    answers: ["joie", "sentiment"],
                    ref: "2 Corinthiens 13:11"
                },
                {
                    text: "Car le salaire du _____ c'est la mort ; mais le don gratuit de Dieu, c'est la _____ Ã©ternelle en JÃ©sus-Christ.",
                    answers: ["pÃ©chÃ©", "vie"],
                    ref: "Romains 6:23"
                },
                {
                    text: "Voici, je me tiens Ã  la _____ et je frappe. Si quelqu'un entend ma voix et ouvre la porte, j'_____ chez lui.",
                    answers: ["porte", "entrerai"],
                    ref: "Apocalypse 3:20"
                },
                {
                    text: "Heureux les _____ en esprit, car le _____ des cieux est Ã  eux !",
                    answers: ["pauvres", "royaume"],
                    ref: "Matthieu 5:3"
                },
                {
                    text: "Aimez vos _____, bÃ©nissez ceux qui vous _____, faites du bien Ã  ceux qui vous haÃ¯ssent.",
                    answers: ["ennemis", "maudissent"],
                    ref: "Matthieu 5:44"
                },
                {
                    text: "Car quiconque invoquera le _____ du Seigneur sera _____.",
                    answers: ["nom", "sauvÃ©"],
                    ref: "Romains 10:13"
                }
            ],
            currentVerse: 0
        };

        function goToPage(pageId) {
            // Cacher toutes les pages
            const pages = ['welcomePage', 'platformPage', 'usernamePage', 'profilePhotoPage', 'premiumPage', 'mainPage', 'settingsPage', 'inboxPage'];
            pages.forEach(page => {
                document.getElementById(page).classList.add('hidden');
            });
            
            // Afficher la page demandÃ©e
            document.getElementById(pageId).classList.remove('hidden');
            document.getElementById(pageId).classList.add('slide-in');
            
            currentPage = pageId;
            
            // Charger le contenu spÃ©cifique Ã  la page
            if (pageId === 'inboxPage') {
                loadTodayVerses();
            }
            
            showNotification(`ğŸ“± Navigation vers ${pageId}`);
        }

        function selectPlatform(platform) {
            selectedPlatform = platform;
            showNotification(`${platform} sÃ©lectionnÃ© !`);
        }

        function setProfileEmoji(emoji) {
            profileEmoji = emoji;
            
            const profileDisplay = document.getElementById('profileEmoji');
            const mainProfile = document.getElementById('mainProfileEmoji');
            
            if (profileDisplay) {
                profileDisplay.textContent = emoji;
            }
            
            if (mainProfile) {
                mainProfile.textContent = emoji;
            }
            
            showNotification(`${emoji} Emoji sÃ©lectionnÃ© !`);
        }

        function selectProfilePhoto() {
            showNotification('ğŸ“· FonctionnalitÃ© de photo Ã  venir !');
        }

        function showTab(tab) {
            // Reset all tabs
            document.getElementById('playTab').classList.remove('border-purple-600', 'text-purple-600');
            document.getElementById('playTab').classList.add('text-gray-500');
            document.getElementById('gamesTab').classList.remove('border-purple-600', 'text-purple-600');
            document.getElementById('gamesTab').classList.add('text-gray-500');
            document.getElementById('inboxTab').classList.remove('border-purple-600', 'text-purple-600');
            document.getElementById('inboxTab').classList.add('text-gray-500');
            
            // Hide all content
            document.getElementById('playContent').classList.add('hidden');
            document.getElementById('gamesContent').classList.add('hidden');
            document.getElementById('inboxContent').classList.add('hidden');
            
            // Show selected tab and content
            if (tab === 'play') {
                document.getElementById('playTab').classList.add('border-purple-600', 'text-purple-600');
                document.getElementById('playTab').classList.remove('text-gray-500');
                document.getElementById('playContent').classList.remove('hidden');
            } else if (tab === 'games') {
                document.getElementById('gamesTab').classList.add('border-purple-600', 'text-purple-600');
                document.getElementById('gamesTab').classList.remove('text-gray-500');
                document.getElementById('gamesContent').classList.remove('hidden');
            } else {
                document.getElementById('inboxTab').classList.add('border-purple-600', 'text-purple-600');
                document.getElementById('inboxTab').classList.remove('text-gray-500');
                document.getElementById('inboxContent').classList.remove('hidden');
                // Charger les messages quand on ouvre l'inbox
                loadInboxMessages();
            }
        }

        // Questions Modal Functions
        function openQuestionsModal() {
            document.getElementById('questionsModal').classList.remove('hidden');
            document.getElementById('questionsModal').classList.add('flex');
            updateQuestionDisplay();
        }

        function closeQuestionsModal() {
            document.getElementById('questionsModal').classList.add('hidden');
            document.getElementById('questionsModal').classList.remove('flex');
        }

        function updateQuestionDisplay() {
            // GÃ©nÃ©rer plus de questions si nÃ©cessaire
            if (currentQuestionIndex >= allQuestions.length - 10) {
                for (let i = 0; i < 50; i++) {
                    allQuestions.push(generateInfiniteQuestion());
                    totalQuestionsGenerated++;
                }
            }
            
            const currentQuestion = allQuestions[currentQuestionIndex];
            const questionText = document.getElementById('questionText');
            const questionEmoji = document.getElementById('questionEmoji');
            const questionNumber = document.getElementById('currentQuestionNumber');
            const questionCard = document.getElementById('questionCard');
            
            if (questionText) {
                questionText.textContent = currentQuestion.text;
            }
            if (questionEmoji) {
                questionEmoji.textContent = currentQuestion.emoji;
            }
            if (questionNumber) {
                questionNumber.textContent = currentQuestionIndex + 1;
            }
            if (questionCard) {
                questionCard.className = `p-6 bg-gradient-to-br ${currentQuestion.color} text-white rounded-2xl mb-4`;
            }
            
            // Mettre Ã  jour la catÃ©gorie
            const questionCategory = document.getElementById('questionCategory');
            if (questionCategory && currentQuestion.category) {
                const categoryNames = {
                    versets: 'Versets',
                    foi: 'Foi',
                    priere: 'PriÃ¨re',
                    personnages: 'Personnages',
                    vie: 'Vie quotidienne',
                    espoir: 'Espoir'
                };
                questionCategory.textContent = categoryNames[currentQuestion.category] || 'Question';
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            updateQuestionDisplay();
            showNotification('â¡ï¸ Question suivante');
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                updateQuestionDisplay();
                showNotification('â¬…ï¸ Question prÃ©cÃ©dente');
            }
        }

        function randomQuestion() {
            // GÃ©nÃ©rer une nouvelle question alÃ©atoire
            const newQuestion = generateInfiniteQuestion();
            allQuestions.push(newQuestion);
            currentQuestionIndex = allQuestions.length - 1;
            totalQuestionsGenerated++;
            updateQuestionDisplay();
            showNotification('ğŸ² Nouvelle question gÃ©nÃ©rÃ©e !');
        }

        function copyCurrentQuestion() {
            const link = `https://praylink.app/q/${currentQuestionIndex}`;
            showNotification('ğŸ“‹ Lien copiÃ© !');
        }

        function shareCurrentQuestion() {
            const currentQuestion = allQuestions[currentQuestionIndex];
            const shareLink = `https://praylink.app/q/${currentQuestionIndex}?u=${encodeURIComponent(username || 'PrayerWarrior')}`;
            
            // CrÃ©er le contenu de partage
            const shareText = `${currentQuestion.text}\n\nRÃ©ponds-moi anonymement ici ğŸ‘‡\n${shareLink}`;
            
            // Ouvrir le modal de partage
            openShareModal(shareText, shareLink);
        }

        // Versets Modal Functions
        function openVersetsModal() {
            document.getElementById('versetsModal').classList.remove('hidden');
            document.getElementById('versetsModal').classList.add('flex');
            updateVersetDisplay();
        }

        function closeVersetsModal() {
            document.getElementById('versetsModal').classList.add('hidden');
            document.getElementById('versetsModal').classList.remove('flex');
        }

        function updateVersetDisplay() {
            const currentVerset = allVersets[currentVersetIndex];
            const versetText = document.getElementById('versetText');
            const versetRef = document.getElementById('versetRef');
            const versetNumber = document.getElementById('currentVersetNumber');
            
            if (versetText) {
                versetText.textContent = `"${currentVerset.text}"`;
            }
            if (versetRef) {
                versetRef.textContent = currentVerset.ref;
            }
            if (versetNumber) {
                versetNumber.textContent = currentVersetIndex + 1;
            }
        }

        function nextVerset() {
            if (currentVersetIndex < allVersets.length - 1) {
                currentVersetIndex++;
                updateVersetDisplay();
                showNotification('â¡ï¸ Verset suivant');
            }
        }

        function previousVerset() {
            if (currentVersetIndex > 0) {
                currentVersetIndex--;
                updateVersetDisplay();
                showNotification('â¬…ï¸ Verset prÃ©cÃ©dent');
            }
        }

        function randomVerset() {
            currentVersetIndex = Math.floor(Math.random() * allVersets.length);
            updateVersetDisplay();
            showNotification('ğŸ² Verset alÃ©atoire !');
        }

        function copyCurrentVerset() {
            const currentVerset = allVersets[currentVersetIndex];
            const versetText = `"${currentVerset.text}" - ${currentVerset.ref}`;
            showNotification('ğŸ“‹ Verset copiÃ© !');
        }

        function shareCurrentVerset() {
            const currentVerset = allVersets[currentVersetIndex];
            const shareLink = `https://praylink.app/v/${currentVersetIndex}?u=${encodeURIComponent(username || 'PrayerWarrior')}`;
            
            // CrÃ©er le contenu de partage
            const shareText = `"${currentVerset.text}"\n${currentVerset.ref}\n\nPartagÃ© par ${username || '@PrayerWarrior'} sur PrayLink ğŸ™\n${shareLink}`;
            
            // Ouvrir le modal de partage
            openShareModal(shareText, shareLink);
        }

        function openShareModal(text, link) {
            document.getElementById('shareText').textContent = text;
            document.getElementById('shareLink').value = link;
            
            document.getElementById('shareModal').classList.remove('hidden');
            document.getElementById('shareModal').classList.add('flex');
        }

        function closeShareModal() {
            document.getElementById('shareModal').classList.add('hidden');
            document.getElementById('shareModal').classList.remove('flex');
        }

        function copyShareLink() {
            const linkInput = document.getElementById('shareLink');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showNotification('ğŸ“‹ Lien copiÃ© dans le presse-papier !');
                
                // Animation de succÃ¨s
                const copyBtn = document.querySelector('[onclick="copyShareLink()"]');
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = 'âœ… CopiÃ© !';
                copyBtn.classList.add('bg-green-500');
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.classList.remove('bg-green-500');
                }, 2000);
            } catch (err) {
                showNotification('âŒ Erreur lors de la copie');
            }
        }

        function shareToInstagram() {
            const text = document.getElementById('shareText').textContent;
            const instagramUrl = `https://www.instagram.com/create/story/?text=${encodeURIComponent(text)}`;
            window.open(instagramUrl, '_blank');
            showNotification('ğŸ“· Ouverture d\'Instagram...');
        }

        function shareToWhatsApp() {
            const text = document.getElementById('shareText').textContent;
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(text)}`;
            window.open(whatsappUrl, '_blank');
            showNotification('ğŸ’¬ Ouverture de WhatsApp...');
        }

        function shareToSnapchat() {
            const text = document.getElementById('shareText').textContent;
            const snapchatUrl = `https://www.snapchat.com/scan?attachmentUrl=${encodeURIComponent(document.getElementById('shareLink').value)}`;
            window.open(snapchatUrl, '_blank');
            showNotification('ğŸ‘» Ouverture de Snapchat...');
        }

        function shareToTwitter() {
            const text = document.getElementById('shareText').textContent;
            const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;
            window.open(twitterUrl, '_blank');
            showNotification('ğŸ¦ Ouverture de Twitter...');
        }

        function generateRandomQuestion() {
            const randomQuestion = allQuestions[Math.floor(Math.random() * allQuestions.length)];
            showNotification('ğŸ² Nouvelle question gÃ©nÃ©rÃ©e !');
        }

        // Quiz functions
        function startBibleQuiz() {
            quizData.currentQuestion = Math.floor(Math.random() * quizData.questions.length);
            quizData.score = 0;
            quizData.selectedAnswer = null;
            quizData.questionsAnswered = 0;
            
            document.getElementById('quizModal').classList.remove('hidden');
            document.getElementById('quizModal').classList.add('flex');
            
            loadQuizQuestion();
        }

        function loadQuizQuestion() {
            const current = quizData.questions[quizData.currentQuestion];
            
            document.getElementById('quizQuestion').textContent = current.question;
            document.getElementById('quizNumber').textContent = quizData.questionsAnswered + 1;
            document.getElementById('currentScore').textContent = quizData.score;
            
            const optionsContainer = document.getElementById('quizOptions');
            optionsContainer.innerHTML = '';
            
            current.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.onclick = () => selectQuizAnswer(index);
                button.className = 'w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn answer-option';
                button.setAttribute('data-index', index);
                button.innerHTML = `<span class="font-medium">${option}</span>`;
                optionsContainer.appendChild(button);
            });
            
            document.getElementById('nextQuizBtn').disabled = true;
            quizData.selectedAnswer = null;
        }

        function selectQuizAnswer(index) {
            quizData.selectedAnswer = index;
            
            document.querySelectorAll('.answer-option').forEach((btn, i) => {
                btn.classList.remove('border-purple-500', 'bg-purple-50', 'border-green-500', 'bg-green-50', 'border-red-500', 'bg-red-50');
                if (i === index) {
                    btn.classList.add('border-purple-500', 'bg-purple-50');
                }
            });
            
            document.getElementById('nextQuizBtn').disabled = false;
        }

        function nextQuizQuestion() {
            const current = quizData.questions[quizData.currentQuestion];
            
            // Montrer la bonne rÃ©ponse
            document.querySelectorAll('.answer-option').forEach((btn, i) => {
                btn.classList.remove('border-purple-500', 'bg-purple-50');
                if (i === current.correct) {
                    btn.classList.add('border-green-500', 'bg-green-50');
                } else if (i === quizData.selectedAnswer && i !== current.correct) {
                    btn.classList.add('border-red-500', 'bg-red-50');
                }
                btn.disabled = true;
            });
            
            if (quizData.selectedAnswer === current.correct) {
                quizData.score++;
                showNotification('âœ… Bonne rÃ©ponse !');
            } else {
                showNotification('âŒ Mauvaise rÃ©ponse !');
            }
            
            quizData.questionsAnswered++;
            
            // Attendre 2 secondes puis charger une nouvelle question alÃ©atoire
            setTimeout(() => {
                // Choisir une nouvelle question alÃ©atoire diffÃ©rente de la prÃ©cÃ©dente
                let newQuestionIndex;
                do {
                    newQuestionIndex = Math.floor(Math.random() * quizData.questions.length);
                } while (newQuestionIndex === quizData.currentQuestion && quizData.questions.length > 1);
                
                quizData.currentQuestion = newQuestionIndex;
                
                // RÃ©activer les boutons
                document.querySelectorAll('.answer-option').forEach(btn => {
                    btn.disabled = false;
                });
                
                loadQuizQuestion();
            }, 2000);
        }

        function showQuizResults() {
            document.getElementById('quizContent').classList.add('hidden');
            document.getElementById('quizResults').classList.remove('hidden');
            document.getElementById('finalScore').textContent = `${quizData.score}/${quizData.questionsAnswered}`;
        }

        function restartQuiz() {
            document.getElementById('quizContent').classList.remove('hidden');
            document.getElementById('quizResults').classList.add('hidden');
            startBibleQuiz();
        }

        function closeQuizModal() {
            document.getElementById('quizModal').classList.add('hidden');
            document.getElementById('quizModal').classList.remove('flex');
        }

        // Verse game functions
        function startVerseGame() {
            verseData.currentVerse = 0;
            
            document.getElementById('verseModal').classList.remove('hidden');
            document.getElementById('verseModal').classList.add('flex');
            
            loadCurrentVerse();
        }

        function loadCurrentVerse() {
            const current = verseData.verses[verseData.currentVerse];
            
            document.getElementById('verseText').textContent = current.text;
            document.getElementById('verseRef').textContent = current.ref;
            document.getElementById('verseInput1').value = '';
            document.getElementById('verseInput2').value = '';
            
            // GÃ©rer l'affichage des champs selon le nombre de mots manquants
            const input2Container = document.getElementById('verseInput2');
            if (current.answers.length === 1) {
                input2Container.style.display = 'none';
                document.getElementById('verseInput1').placeholder = 'Mot manquant';
            } else {
                input2Container.style.display = 'block';
                document.getElementById('verseInput1').placeholder = 'Premier mot manquant';
                document.getElementById('verseInput2').placeholder = 'Second mot manquant';
            }
            
            document.getElementById('verseContent').classList.remove('hidden');
            document.getElementById('verseResults').classList.add('hidden');
        }

        function checkVerseAnswer() {
            const current = verseData.verses[verseData.currentVerse];
            const input1 = document.getElementById('verseInput1').value.toLowerCase().trim();
            const input2 = document.getElementById('verseInput2').value.toLowerCase().trim();
            
            const correct1 = current.answers[0].toLowerCase();
            const correct2 = current.answers.length > 1 ? current.answers[1].toLowerCase() : '';
            
            let isCorrect;
            let correctAnswersText;
            
            if (current.answers.length === 1) {
                isCorrect = input1 === correct1;
                correctAnswersText = `"${current.answers[0]}"`;
            } else {
                isCorrect = input1 === correct1 && input2 === correct2;
                correctAnswersText = `"${current.answers[0]}" et "${current.answers[1]}"`;
            }
            
            document.getElementById('verseContent').classList.add('hidden');
            document.getElementById('verseResults').classList.remove('hidden');
            
            if (isCorrect) {
                document.getElementById('verseResultIcon').textContent = 'âœ…';
                document.getElementById('verseResultText').textContent = 'Correct !';
                document.getElementById('verseResultMessage').textContent = 'Bien jouÃ© ! Tu connais bien tes versets.';
                showNotification('âœ… Bonne rÃ©ponse !');
            } else {
                document.getElementById('verseResultIcon').textContent = 'âŒ';
                document.getElementById('verseResultText').textContent = 'Pas tout Ã  fait...';
                document.getElementById('verseResultMessage').textContent = `Les bonnes rÃ©ponses Ã©taient : ${correctAnswersText}.`;
                showNotification('âŒ Essaie encore !');
            }
        }

        function nextVerse() {
            // Choisir un verset alÃ©atoire diffÃ©rent du prÃ©cÃ©dent
            let newVerseIndex;
            do {
                newVerseIndex = Math.floor(Math.random() * verseData.verses.length);
            } while (newVerseIndex === verseData.currentVerse && verseData.verses.length > 1);
            
            verseData.currentVerse = newVerseIndex;
            loadCurrentVerse();
        }

        function closeVerseModal() {
            document.getElementById('verseModal').classList.add('hidden');
            document.getElementById('verseModal').classList.remove('flex');
        }

        // Memory game functions
        function loadMemoryLevel() {
            const pairsCount = Math.min(6 + memoryData.currentLevel - 1, 12);
            const selectedCards = memoryData.cards.slice(0, pairsCount);
            const gameCards = [...selectedCards, ...selectedCards].map((card, index) => ({
                ...card,
                uniqueId: index,
                isFlipped: false,
                isMatched: false
            }));
            
            // MÃ©langer les cartes
            for (let i = gameCards.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [gameCards[i], gameCards[j]] = [gameCards[j], gameCards[i]];
            }
            
            memoryData.gameCards = gameCards;
            memoryData.flippedCards = [];
            memoryData.matchedPairs = 0;
            memoryData.moves = 0;
            memoryData.timeLeft = 60 + (memoryData.currentLevel - 1) * 10;
            
            updateMemoryDisplay();
            renderMemoryGrid();
            startMemoryTimer();
        }

        function renderMemoryGrid() {
            const grid = document.getElementById('memoryGrid');
            const gridSize = memoryData.gameCards.length <= 12 ? 'grid-cols-4' : 'grid-cols-5';
            grid.className = `grid ${gridSize} gap-2 mb-4`;
            
            grid.innerHTML = memoryData.gameCards.map(card => `
                <div class="memory-card aspect-square bg-gradient-to-br from-purple-500 to-pink-500 rounded-xl flex items-center justify-center cursor-pointer transition-all duration-300 hover:scale-105 ${card.isFlipped || card.isMatched ? 'bg-gradient-to-br from-green-400 to-blue-500' : ''}" 
                     onclick="flipMemoryCard(${card.uniqueId})"
                     data-card-id="${card.uniqueId}">
                    <div class="text-center">
                        ${card.isFlipped || card.isMatched 
                            ? `<div class="text-2xl mb-1">${card.emoji}</div><div class="text-xs text-white font-medium">${card.name}</div>`
                            : '<div class="text-2xl text-white">ğŸ¯</div>'
                        }
                    </div>
                </div>
            `).join('');
        }

        function flipMemoryCard(uniqueId) {
            const card = memoryData.gameCards.find(c => c.uniqueId === uniqueId);
            
            if (!card || card.isFlipped || card.isMatched || memoryData.flippedCards.length >= 2) {
                return;
            }
            
            card.isFlipped = true;
            memoryData.flippedCards.push(card);
            
            renderMemoryGrid();
            
            if (memoryData.flippedCards.length === 2) {
                memoryData.moves++;
                updateMemoryDisplay();
                
                setTimeout(() => {
                    checkMemoryMatch();
                }, 1000);
            }
        }

        function checkMemoryMatch() {
            const [card1, card2] = memoryData.flippedCards;
            
            if (card1.id === card2.id) {
                // Match trouvÃ©
                card1.isMatched = true;
                card2.isMatched = true;
                memoryData.matchedPairs++;
                memoryData.score += 100 + (memoryData.timeLeft * 2);
                
                showNotification('âœ… Paire trouvÃ©e !');
                
                // VÃ©rifier si le niveau est terminÃ©
                if (memoryData.matchedPairs === memoryData.gameCards.length / 2) {
                    setTimeout(() => {
                        completeMemoryLevel();
                    }, 500);
                }
            } else {
                // Pas de match
                card1.isFlipped = false;
                card2.isFlipped = false;
                showNotification('âŒ Pas de match !');
            }
            
            memoryData.flippedCards = [];
            renderMemoryGrid();
            updateMemoryDisplay();
        }

        function completeMemoryLevel() {
            clearInterval(memoryData.timer);
            
            // Bonus de temps
            const timeBonus = memoryData.timeLeft * 5;
            memoryData.score += timeBonus;
            
            document.getElementById('memoryContent').classList.add('hidden');
            document.getElementById('memoryResults').classList.remove('hidden');
            
            document.getElementById('finalMemoryScore').textContent = memoryData.score;
            document.getElementById('finalMemoryMoves').textContent = memoryData.moves;
            
            if (memoryData.currentLevel >= 5) {
                document.getElementById('memoryResultText').textContent = 'Jeu terminÃ© !';
                document.getElementById('memoryResultIcon').textContent = 'ğŸ†';
                document.getElementById('nextLevelBtn').style.display = 'none';
            } else {
                document.getElementById('memoryResultText').textContent = `Niveau ${memoryData.currentLevel} terminÃ© !`;
                document.getElementById('memoryResultIcon').textContent = 'ğŸ‰';
                document.getElementById('nextLevelBtn').style.display = 'block';
            }
        }

        function nextMemoryLevel() {
            memoryData.currentLevel++;
            document.getElementById('memoryContent').classList.remove('hidden');
            document.getElementById('memoryResults').classList.add('hidden');
            loadMemoryLevel();
        }

        function restartMemoryGame() {
            clearInterval(memoryData.timer);
            memoryData.currentLevel = 1;
            memoryData.score = 0;
            document.getElementById('memoryContent').classList.remove('hidden');
            document.getElementById('memoryResults').classList.add('hidden');
            loadMemoryLevel();
        }

        function updateMemoryDisplay() {
            document.getElementById('memoryLevel').textContent = memoryData.currentLevel;
            document.getElementById('memoryScore').textContent = memoryData.score;
            document.getElementById('memoryTimer').textContent = memoryData.timeLeft + 's';
            document.getElementById('memoryMoves').textContent = memoryData.moves;
            document.getElementById('memoryPairs').textContent = memoryData.matchedPairs;
            document.getElementById('memoryTotal').textContent = memoryData.gameCards ? memoryData.gameCards.length / 2 : 6;
        }

        function startMemoryTimer() {
            clearInterval(memoryData.timer);
            
            memoryData.timer = setInterval(() => {
                memoryData.timeLeft--;
                updateMemoryDisplay();
                
                if (memoryData.timeLeft <= 0) {
                    clearInterval(memoryData.timer);
                    gameOverMemory();
                }
            }, 1000);
        }

        function gameOverMemory() {
            document.getElementById('memoryContent').classList.add('hidden');
            document.getElementById('memoryResults').classList.remove('hidden');
            
            document.getElementById('memoryResultText').textContent = 'Temps Ã©coulÃ© !';
            document.getElementById('memoryResultIcon').textContent = 'â°';
            document.getElementById('finalMemoryScore').textContent = memoryData.score;
            document.getElementById('finalMemoryMoves').textContent = memoryData.moves;
            document.getElementById('nextLevelBtn').style.display = 'none';
            
            showNotification('â° Temps Ã©coulÃ© ! Essaie encore.');
        }

        function closeMemoryModal() {
            clearInterval(memoryData.timer);
            document.getElementById('memoryModal').classList.add('hidden');
            document.getElementById('memoryModal').classList.remove('flex');
        }

        function startMemoryGame() {
            memoryData.currentLevel = 1;
            memoryData.score = 0;
            memoryData.flippedCards = [];
            memoryData.matchedPairs = 0;
            memoryData.moves = 0;
            
            document.getElementById('memoryModal').classList.remove('hidden');
            document.getElementById('memoryModal').classList.add('flex');
            
            loadMemoryLevel();
        }

        // Battle game functions
        function startBattleGame() {
            battleData.currentRound = 1;
            battleData.playerScore = 0;
            battleData.opponentScore = 0;
            battleData.selectedAnswer = null;
            battleData.currentQuestion = Math.floor(Math.random() * battleData.questions.length);
            
            document.getElementById('battleModal').classList.remove('hidden');
            document.getElementById('battleModal').classList.add('flex');
            
            loadBattleQuestion();
        }

        function loadBattleQuestion() {
            const current = battleData.questions[battleData.currentQuestion];
            
            document.getElementById('battleQuestion').textContent = current.question;
            document.getElementById('battleRound').textContent = battleData.currentRound;
            document.getElementById('battleScore').textContent = battleData.playerScore;
            
            // Mettre Ã  jour les scores dans l'interface
            const scoreElements = document.querySelectorAll('#battleContent .text-lg.font-bold');
            if (scoreElements.length >= 2) {
                scoreElements[0].textContent = battleData.playerScore;
                scoreElements[1].textContent = battleData.opponentScore;
            }
            
            const optionsContainer = document.getElementById('battleOptions');
            optionsContainer.innerHTML = '';
            
            current.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.onclick = () => selectBattleAnswer(index);
                button.className = 'w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-orange-500 transition-all interactive-btn battle-option';
                button.setAttribute('data-index', index);
                button.innerHTML = `<span class="font-medium">${option}</span>`;
                optionsContainer.appendChild(button);
            });
            
            battleData.selectedAnswer = null;
            battleData.timeLeft = 10;
            startBattleTimer();
        }

        function selectBattleAnswer(index) {
            if (battleData.selectedAnswer !== null) return;
            
            battleData.selectedAnswer = index;
            clearInterval(battleData.timer);
            
            const current = battleData.questions[battleData.currentQuestion];
            
            // Montrer les rÃ©ponses
            document.querySelectorAll('.battle-option').forEach((btn, i) => {
                btn.disabled = true;
                btn.classList.remove('border-gray-200', 'hover:border-orange-500');
                
                if (i === current.correct) {
                    btn.classList.add('border-green-500', 'bg-green-50');
                } else if (i === index && i !== current.correct) {
                    btn.classList.add('border-red-500', 'bg-red-50');
                }
            });
            
            // Calculer les scores
            if (index === current.correct) {
                battleData.playerScore++;
                showNotification('âœ… Bonne rÃ©ponse !');
            } else {
                showNotification('âŒ Mauvaise rÃ©ponse !');
            }
            
            // Simuler la rÃ©ponse de l'adversaire (50% de chance de rÃ©ussir)
            if (Math.random() > 0.5) {
                battleData.opponentScore++;
            }
            
            // Attendre 2 secondes puis passer Ã  la question suivante
            setTimeout(() => {
                if (battleData.currentRound >= battleData.maxRounds) {
                    endBattle();
                } else {
                    battleData.currentRound++;
                    // Choisir une nouvelle question alÃ©atoire
                    let newQuestionIndex;
                    do {
                        newQuestionIndex = Math.floor(Math.random() * battleData.questions.length);
                    } while (newQuestionIndex === battleData.currentQuestion && battleData.questions.length > 1);
                    
                    battleData.currentQuestion = newQuestionIndex;
                    
                    // RÃ©activer les boutons
                    document.querySelectorAll('.battle-option').forEach(btn => {
                        btn.disabled = false;
                    });
                    
                    loadBattleQuestion();
                }
            }, 2000);
        }

        function startBattleTimer() {
            clearInterval(battleData.timer);
            
            battleData.timer = setInterval(() => {
                battleData.timeLeft--;
                document.getElementById('battleTimer').textContent = battleData.timeLeft + 's';
                
                if (battleData.timeLeft <= 0) {
                    clearInterval(battleData.timer);
                    // Temps Ã©coulÃ©, considÃ©rer comme mauvaise rÃ©ponse
                    if (battleData.selectedAnswer === null) {
                        selectBattleAnswer(-1); // RÃ©ponse invalide
                    }
                }
            }, 1000);
        }

        function endBattle() {
            document.getElementById('battleContent').classList.add('hidden');
            document.getElementById('battleResults').classList.remove('hidden');
            
            document.getElementById('finalBattleScore').textContent = battleData.playerScore;
            document.getElementById('opponentScore').textContent = battleData.opponentScore;
            
            if (battleData.playerScore > battleData.opponentScore) {
                document.getElementById('battleResultIcon').textContent = 'ğŸ†';
                document.getElementById('battleResultText').textContent = 'Victoire !';
                showNotification('ğŸ† Tu as gagnÃ© la bataille !');
            } else if (battleData.playerScore < battleData.opponentScore) {
                document.getElementById('battleResultIcon').textContent = 'ğŸ˜”';
                document.getElementById('battleResultText').textContent = 'DÃ©faite...';
                showNotification('ğŸ˜” Tu as perdu cette fois...');
            } else {
                document.getElementById('battleResultIcon').textContent = 'ğŸ¤';
                document.getElementById('battleResultText').textContent = 'Ã‰galitÃ© !';
                showNotification('ğŸ¤ Match nul !');
            }
        }

        function restartBattle() {
            document.getElementById('battleContent').classList.remove('hidden');
            document.getElementById('battleResults').classList.add('hidden');
            startBattleGame();
        }

        function findNewOpponent() {
            const opponents = ['Marie_2024', 'Paul_Espoir', 'Sarah_LumiÃ¨re', 'Emma_Grace', 'Luc_Foi', 'Anna_PriÃ¨re'];
            battleData.opponentName = opponents[Math.floor(Math.random() * opponents.length)];
            
            // Mettre Ã  jour le nom de l'adversaire dans l'interface
            const opponentNameElement = document.querySelector('#battleContent strong');
            if (opponentNameElement) {
                opponentNameElement.textContent = battleData.opponentName;
            }
            
            showNotification(`ğŸ” Nouvel adversaire trouvÃ© : ${battleData.opponentName}`);
            restartBattle();
        }

        function closeBattleModal() {
            clearInterval(battleData.timer);
            document.getElementById('battleModal').classList.add('hidden');
            document.getElementById('battleModal').classList.remove('flex');
        }

        // Premium functions
        function upgradeToPremium() {
            document.getElementById('premiumUpgradeModal').classList.remove('hidden');
            document.getElementById('premiumUpgradeModal').classList.add('flex');
        }

        function showPremiumRequired() {
            showNotification('ğŸ‘‘ FonctionnalitÃ© Premium requise ! Passe Premium pour dÃ©bloquer ce jeu.');
            setTimeout(() => {
                upgradeToPremium();
            }, 1000);
        }

        function closePremiumModal() {
            document.getElementById('premiumUpgradeModal').classList.add('hidden');
            document.getElementById('premiumUpgradeModal').classList.remove('flex');
        }

        function purchasePremium() {
            showNotification('ğŸ‰ FÃ©licitations ! Tu es maintenant Premium !');
            closePremiumModal();
            // Ici on pourrait dÃ©bloquer les jeux premium
        }

        // Settings functions
        function showHowToShare() {
            document.getElementById('howToShareModal').classList.remove('hidden');
            document.getElementById('howToShareModal').classList.add('flex');
        }

        function closeHowToShare() {
            document.getElementById('howToShareModal').classList.add('hidden');
            document.getElementById('howToShareModal').classList.remove('flex');
        }

        function deleteAccount() {
            if (confirm('Es-tu sÃ»r de vouloir supprimer ton compte ? Cette action est irrÃ©versible.')) {
                showNotification('ğŸ—‘ï¸ Compte supprimÃ© avec succÃ¨s !');
                goToPage('welcomePage');
            }
        }

        // Notification system
        function showNotification(message) {
            // Simple console log instead of visual notification
            console.log(message);
        }

        // Fonction pour charger les versets d'aujourd'hui
        function loadTodayVerses() {
            const feed = document.getElementById('versesNewsFeed');
            if (!feed) return;
            
            let filteredVerses = todayVerses;
            
            if (currentFilter === 'recent') {
                filteredVerses = todayVerses.slice(0, 3);
            } else if (currentFilter === 'popular') {
                filteredVerses = todayVerses.filter(v => v.likes > 10);
            }
            
            feed.innerHTML = filteredVerses.map(verse => `
                <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-100 mb-4">
                    <!-- Header utilisateur -->
                    <div class="flex items-center justify-between mb-3">
                        <div class="flex items-center">
                            <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-lg mr-3">
                                ${verse.avatar}
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-sm">${verse.user}</h4>
                                <p class="text-xs text-gray-500">${verse.time}</p>
                            </div>
                        </div>
                        <button onclick="copyVerseLink('${verse.link}')" class="text-gray-400 hover:text-purple-500 interactive-btn">
                            <span class="text-lg">ğŸ”—</span>
                        </button>
                    </div>
                    
                    <!-- Message personnel -->
                    <p class="text-sm text-gray-700 mb-3">${verse.message}</p>
                    
                    <!-- Verset -->
                    <div class="bg-gradient-to-br from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-100 mb-3">
                        <p class="text-sm text-gray-800 italic mb-2">"${verse.verse}"</p>
                        <p class="text-xs text-purple-600 font-medium">${verse.reference}</p>
                    </div>
                    
                    <!-- Actions -->
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                            <button onclick="toggleLike(${verse.id})" class="flex items-center space-x-1 interactive-btn ${verse.isLiked ? 'text-red-500' : 'text-gray-500'}">
                                <span class="text-lg">${verse.isLiked ? 'â¤ï¸' : 'ğŸ¤'}</span>
                                <span class="text-sm font-medium">${verse.likes}</span>
                            </button>
                            
                            <button onclick="startConversation('${verse.user}')" class="flex items-center space-x-1 text-gray-500 hover:text-purple-500 interactive-btn">
                                <span class="text-lg">ğŸ’¬</span>
                                <span class="text-sm font-medium">${verse.comments}</span>
                            </button>
                            
                            <button onclick="shareVerse(${verse.id})" class="flex items-center space-x-1 text-gray-500 hover:text-blue-500 interactive-btn">
                                <span class="text-lg">ğŸ“¤</span>
                                <span class="text-sm font-medium">${verse.shares}</span>
                            </button>
                        </div>
                        
                        <button onclick="startConversation('${verse.user}')" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-4 py-2 rounded-full text-xs font-medium interactive-btn">
                            ğŸ’¬ Discuter
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Fonction pour filtrer les versets
        function filterVerses(filter) {
            currentFilter = filter;
            
            // Mettre Ã  jour les boutons de filtre
            document.getElementById('filterAll').className = filter === 'all' 
                ? 'px-4 py-2 bg-purple-600 text-white rounded-full text-sm mr-3 interactive-btn'
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm mr-3 interactive-btn';
                
            document.getElementById('filterRecent').className = filter === 'recent' 
                ? 'px-4 py-2 bg-purple-600 text-white rounded-full text-sm mr-3 interactive-btn'
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm mr-3 interactive-btn';
                
            document.getElementById('filterPopular').className = filter === 'popular' 
                ? 'px-4 py-2 bg-purple-600 text-white rounded-full text-sm interactive-btn'
                : 'px-4 py-2 bg-gray-200 text-gray-700 rounded-full text-sm interactive-btn';
            
            loadTodayVerses();
            showNotification(`ğŸ“Š Filtre "${filter}" appliquÃ©`);
        }

        // Fonction pour liker un verset
        function toggleLike(verseId) {
            const verse = todayVerses.find(v => v.id === verseId);
            if (verse) {
                verse.isLiked = !verse.isLiked;
                verse.likes += verse.isLiked ? 1 : -1;
                loadTodayVerses();
                showNotification(verse.isLiked ? 'â¤ï¸ Verset aimÃ© !' : 'ğŸ¤ Like retirÃ©');
            }
        }

        // Fonction pour copier le lien d'un verset
        function copyVerseLink(link) {
            showNotification('ğŸ”— Lien copiÃ© dans le presse-papier !');
        }

        // Fonction pour dÃ©marrer une conversation
        function startConversation(username) {
            currentConversation = username;
            
            document.getElementById('conversationUserName').textContent = username;
            document.getElementById('conversationUserAvatar').textContent = conversationData[username]?.avatar || 'ğŸ‘¤';
            document.getElementById('conversationStatus').textContent = conversationData[username]?.status || 'Hors ligne';
            
            loadConversationMessages();
            
            document.getElementById('conversationModal').classList.remove('hidden');
            document.getElementById('conversationModal').classList.add('flex');
        }

        // Fonction pour charger les messages de conversation
        function loadConversationMessages() {
            const messagesContainer = document.getElementById('conversationMessages');
            const messages = conversationData[currentConversation]?.messages || [];
            
            messagesContainer.innerHTML = messages.map(msg => `
                <div class="flex ${msg.type === 'sent' ? 'justify-end' : 'justify-start'}">
                    <div class="max-w-[70%] ${msg.type === 'sent' 
                        ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white' 
                        : 'bg-gray-100 text-gray-800'} rounded-2xl px-4 py-3">
                        <p class="text-sm">${msg.text}</p>
                        <p class="text-xs opacity-75 mt-1">${msg.time}</p>
                    </div>
                </div>
            `).join('');
            
            // Scroll vers le bas
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Fonction pour fermer la conversation
        function closeConversation() {
            document.getElementById('conversationModal').classList.add('hidden');
            document.getElementById('conversationModal').classList.remove('flex');
            currentConversation = null;
        }

        // Fonction pour envoyer un message
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message && currentConversation) {
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                // Ajouter le message Ã  la conversation
                if (!conversationData[currentConversation]) {
                    conversationData[currentConversation] = { messages: [] };
                }
                
                conversationData[currentConversation].messages.push({
                    type: 'sent',
                    text: message,
                    time: time
                });
                
                input.value = '';
                loadConversationMessages();
                showNotification('ğŸ“¤ Message envoyÃ© !');
                
                // Simuler une rÃ©ponse automatique aprÃ¨s 2 secondes
                setTimeout(() => {
                    const responses = [
                        'Merci pour ton message ! ğŸ™',
                        'Amen ! Ce verset me touche aussi â¤ï¸',
                        'Que Dieu te bÃ©nisse ! âœ¨',
                        'Prions ensemble pour cela ğŸ•Šï¸'
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    const responseTime = new Date();
                    const responseTimeStr = responseTime.getHours().toString().padStart(2, '0') + ':' + responseTime.getMinutes().toString().padStart(2, '0');
                    
                    conversationData[currentConversation].messages.push({
                        type: 'received',
                        text: randomResponse,
                        time: responseTimeStr
                    });
                    
                    loadConversationMessages();
                }, 2000);
            }
        }

        // Fonction pour gÃ©rer l'appui sur EntrÃ©e
        function handleMessageKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // Fonction pour ajouter un emoji
        function addEmoji(emoji) {
            const input = document.getElementById('messageInput');
            input.value += emoji;
            input.focus();
        }

        // Fonction pour partager un verset dans la conversation
        function shareVerse() {
            const randomVerse = allVersets[Math.floor(Math.random() * allVersets.length)];
            const input = document.getElementById('messageInput');
            input.value = `ğŸ“– "${randomVerse.text}" - ${randomVerse.ref}`;
        }

        // Fonction pour bloquer un utilisateur
        function blockUser() {
            if (confirm(`ÃŠtes-vous sÃ»r de vouloir bloquer ${currentConversation} ?`)) {
                showNotification('ğŸš« Utilisateur bloquÃ©');
                closeConversation();
            }
        }

        // DonnÃ©es des messages reÃ§us
        const inboxMessages = [
            {
                id: 1,
                type: 'ğŸ™ PriÃ¨re',
                typeColor: 'bg-purple-100 text-purple-700',
                bgGradient: 'from-purple-500 to-pink-600',
                time: '14:32',
                message: 'Peux-tu prier pour mon examen demain ? J\'ai besoin de force ğŸ™',
                sender: 'Anonyme #1',
                avatar: 'ğŸ‘¤',
                hasLink: false,
                link: null
            },
            {
                id: 2,
                type: 'ğŸ“– Verset',
                typeColor: 'bg-blue-100 text-blue-700',
                bgGradient: 'from-blue-500 to-indigo-600',
                time: '12:15',
                message: 'Comment tu vis ce verset : Je puis tout par celui qui me fortifie ?',
                sender: 'Anonyme #2',
                avatar: 'ğŸ‘¤',
                hasLink: true,
                link: 'https://praylink.app/u/marie2024'
            },
            {
                id: 3,
                type: 'âœ¨ Question',
                typeColor: 'bg-green-100 text-green-700',
                bgGradient: 'from-green-500 to-emerald-600',
                time: 'Hier',
                message: 'Peux-tu prier pour ma famille ? Nous traversons une pÃ©riode difficile ğŸ˜¢',
                sender: 'Anonyme #3',
                avatar: 'ğŸ‘¤',
                hasLink: true,
                link: 'https://praylink.app/u/david_foi'
            },
            {
                id: 4,
                type: 'ğŸ’ TÃ©moignage',
                typeColor: 'bg-pink-100 text-pink-700',
                bgGradient: 'from-pink-500 to-rose-600',
                time: 'Hier',
                message: 'Merci pour tes priÃ¨res ! Mon entretien s\'est super bien passÃ© ! Dieu est fidÃ¨le ğŸ™Œ',
                sender: 'Anonyme #4',
                avatar: 'ğŸ‘¤',
                hasLink: false,
                link: null
            },
            {
                id: 5,
                type: 'ğŸ¤ Encouragement',
                typeColor: 'bg-yellow-100 text-yellow-700',
                bgGradient: 'from-yellow-500 to-orange-600',
                time: '2 jours',
                message: 'Ton message m\'a vraiment encouragÃ©. Continue Ã  partager l\'amour de Dieu ! âœ¨',
                sender: 'Anonyme #5',
                avatar: 'ğŸ‘¤',
                hasLink: true,
                link: 'https://praylink.app/u/sarah_lumiere'
            }
        ];

        // Fonction pour charger les messages dans l'inbox du tab principal
        function loadInboxMessages() {
            const messagesList = document.getElementById('messagesList');
            if (!messagesList) return;
            
            messagesList.innerHTML = inboxMessages.map(msg => `
                <div class="bg-gradient-to-br ${msg.bgGradient} text-white p-4 rounded-xl">
                    <div class="flex items-center justify-between mb-2">
                        <span class="bg-white bg-opacity-20 px-2 py-1 rounded-full text-xs">${msg.type}</span>
                        <span class="text-xs opacity-75">${msg.time}</span>
                    </div>
                    <p class="text-sm mb-3">"${msg.message}"</p>
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-sm mr-2">${msg.avatar}</div>
                            <span class="text-xs">${msg.sender}</span>
                            ${msg.hasLink ? '<span class="text-xs opacity-75 ml-2">â€¢ A un profil</span>' : ''}
                        </div>
                        <button onclick="openReplyModal(${msg.id})" class="bg-white bg-opacity-20 px-3 py-1 rounded-full text-xs interactive-btn hover:bg-opacity-30">ğŸ’¬ RÃ©pondre</button>
                    </div>
                </div>
            `).join('');
        }

        // Fonctions pour les indices d'activitÃ©
        function showQuestionInsights() {
            loadInsightsData('question');
            document.getElementById('insightsModal').classList.remove('hidden');
            document.getElementById('insightsModal').classList.add('flex');
        }

        function showVersetInsights() {
            loadInsightsData('verset');
            document.getElementById('insightsModal').classList.remove('hidden');
            document.getElementById('insightsModal').classList.add('flex');
        }

        function closeInsightsModal() {
            document.getElementById('insightsModal').classList.add('hidden');
            document.getElementById('insightsModal').classList.remove('flex');
        }

        function loadInsightsData(type) {
            // Charger les visiteurs
            const visitorsContainer = document.getElementById('visitorsInsights');
            visitorsContainer.innerHTML = insightsData.visitors.map(visitor => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-xl">
                    <div class="flex items-center">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-400 to-pink-400 rounded-full flex items-center justify-center text-lg mr-3">
                            ${visitor.avatar}
                        </div>
                        <div>
                            <p class="font-medium text-gray-800 text-sm">${visitor.hint}</p>
                            <div class="flex items-center text-xs text-gray-500">
                                <span class="mr-2">ğŸ“ ${visitor.location}</span>
                                <span class="mr-2">ğŸ“± ${visitor.device}</span>
                                <span>${visitor.time}</span>
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        ${visitor.hasResponded 
                            ? '<span class="bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium">ğŸ’¬ A rÃ©pondu</span>'
                            : '<span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">ğŸ‘€ Vu seulement</span>'
                        }
                    </div>
                </div>
            `).join('');

            // Charger les rÃ©pondants
            const respondersContainer = document.getElementById('respondersInsights');
            respondersContainer.innerHTML = insightsData.responders.map(responder => `
                <div class="p-3 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl border border-blue-100">
                    <div class="flex items-center mb-2">
                        <div class="w-8 h-8 bg-gradient-to-br from-blue-400 to-indigo-400 rounded-full flex items-center justify-center text-sm mr-3">
                            ${responder.avatar}
                        </div>
                        <div class="flex-1">
                            <p class="font-medium text-gray-800 text-sm">${responder.hint}</p>
                            <p class="text-xs text-gray-500">${responder.time}</p>
                        </div>
                        <div class="text-lg">
                            ${responder.sentiment === 'positive' ? 'ğŸ˜Š' : responder.sentiment === 'negative' ? 'ğŸ˜”' : 'ğŸ˜'}
                        </div>
                    </div>
                    <p class="text-sm text-gray-700 italic bg-white bg-opacity-50 rounded-lg p-2">
                        "${responder.message}"
                    </p>
                </div>
            `).join('');

            // Mettre Ã  jour les statistiques
            document.getElementById('insightViews').textContent = insightsData.visitors.length * 2 + Math.floor(Math.random() * 10);
            document.getElementById('insightClicks').textContent = insightsData.visitors.length;
            document.getElementById('insightResponses').textContent = insightsData.responders.length;
        }

        // Mystery game data
        let mysteryData = {
            currentMystery: 0,
            score: 0,
            hintsUsed: 0,
            maxHints: 3,
            startTime: null,
            mysteries: [
                {
                    question: "Je suis celui qui a Ã©tÃ© vendu par ses frÃ¨res pour 20 piÃ¨ces d'argent. Mes rÃªves ont prÃ©dit l'avenir et j'ai sauvÃ© l'Ã‰gypte de la famine. Qui suis-je ?",
                    answer: ["joseph"],
                    hints: [
                        "ğŸŒˆ J'avais un manteau de plusieurs couleurs",
                        "ğŸ‘‘ Je suis devenu vice-roi d'Ã‰gypte",
                        "ğŸŒ¾ J'ai interprÃ©tÃ© les rÃªves de Pharaon sur les vaches grasses et maigres"
                    ],
                    explanation: "Joseph Ã©tait le fils de Jacob, vendu par ses frÃ¨res jaloux. Ses dons d'interprÃ©tation des rÃªves l'ont menÃ© Ã  devenir vice-roi d'Ã‰gypte."
                },
                {
                    question: "Je suis le roi qui a demandÃ© la sagesse Ã  Dieu et qui a construit le premier temple. Mes jugements Ã©taient cÃ©lÃ¨bres dans tout le royaume. Qui suis-je ?",
                    answer: ["salomon"],
                    hints: [
                        "âš–ï¸ J'ai proposÃ© de couper un bÃ©bÃ© en deux pour trouver sa vraie mÃ¨re",
                        "ğŸ›ï¸ J'ai construit un temple magnifique Ã  JÃ©rusalem",
                        "ğŸ‘‘ Mon pÃ¨re Ã©tait le roi David"
                    ],
                    explanation: "Salomon Ã©tait le fils de David, connu pour sa sagesse extraordinaire et pour avoir construit le premier temple de JÃ©rusalem."
                },
                {
                    question: "Je suis celui qui a Ã©tÃ© avalÃ© par un grand poisson aprÃ¨s avoir fui ma mission. Dieu m'avait envoyÃ© prÃªcher Ã  une grande ville. Qui suis-je ?",
                    answer: ["jonas"],
                    hints: [
                        "ğŸ‹ J'ai passÃ© trois jours dans le ventre d'un poisson",
                        "ğŸƒâ€â™‚ï¸ J'ai essayÃ© de fuir vers Tarsis au lieu d'obÃ©ir Ã  Dieu",
                        "ğŸ™ï¸ Dieu m'avait envoyÃ© prÃªcher Ã  Ninive"
                    ],
                    explanation: "Jonas Ã©tait un prophÃ¨te qui a tentÃ© de fuir sa mission divine mais a Ã©tÃ© ramenÃ© Ã  la raison aprÃ¨s son sÃ©jour dans le ventre du poisson."
                },
                {
                    question: "Je suis le berger qui est devenu roi et qui a vaincu un gÃ©ant avec une fronde. J'ai Ã©crit de nombreux psaumes. Qui suis-je ?",
                    answer: ["david"],
                    hints: [
                        "ğŸµ J'ai Ã©crit de nombreux psaumes et je jouais de la harpe",
                        "âš”ï¸ J'ai vaincu Goliath avec une pierre et une fronde",
                        "ğŸ‘‘ J'ai Ã©tÃ© oint roi par le prophÃ¨te Samuel"
                    ],
                    explanation: "David Ã©tait un berger devenu roi d'IsraÃ«l, cÃ©lÃ¨bre pour avoir vaincu Goliath et pour ses psaumes inspirÃ©s."
                },
                {
                    question: "Je suis celui qui a conduit le peuple d'IsraÃ«l hors d'Ã‰gypte et qui a reÃ§u les Dix Commandements sur le mont SinaÃ¯. Qui suis-je ?",
                    answer: ["moise", "moÃ¯se"],
                    hints: [
                        "ğŸŒŠ J'ai sÃ©parÃ© les eaux de la mer Rouge",
                        "ğŸ“œ J'ai reÃ§u les Dix Commandements de Dieu",
                        "ğŸ”¥ J'ai vu Dieu dans un buisson ardent"
                    ],
                    explanation: "MoÃ¯se Ã©tait le grand libÃ©rateur d'IsraÃ«l, qui a conduit le peuple hors de l'esclavage Ã©gyptien et reÃ§u la Loi de Dieu."
                },
                {
                    question: "Je suis la femme qui a cachÃ© les espions israÃ©lites Ã  JÃ©richo et qui a Ã©tÃ© sauvÃ©e lors de la prise de la ville. Qui suis-je ?",
                    answer: ["rahab"],
                    hints: [
                        "ğŸ  J'habitais dans les murailles de JÃ©richo",
                        "ğŸ”´ J'ai attachÃ© un cordon rouge Ã  ma fenÃªtre",
                        "ğŸ•µï¸ J'ai cachÃ© les espions envoyÃ©s par JosuÃ©"
                    ],
                    explanation: "Rahab Ã©tait une femme de JÃ©richo qui a aidÃ© les espions israÃ©lites et a Ã©tÃ© Ã©pargnÃ©e lors de la conquÃªte de la ville."
                },
                {
                    question: "Je suis le prophÃ¨te qui a Ã©tÃ© nourri par des corbeaux et qui a dÃ©fiÃ© les prophÃ¨tes de Baal sur le mont Carmel. Qui suis-je ?",
                    answer: ["elie", "Ã©lie"],
                    hints: [
                        "ğŸ”¥ J'ai fait descendre le feu du ciel sur l'autel",
                        "ğŸ¦ Des corbeaux m'apportaient de la nourriture",
                        "â›°ï¸ J'ai dÃ©fiÃ© 450 prophÃ¨tes de Baal sur le mont Carmel"
                    ],
                    explanation: "Ã‰lie Ã©tait un puissant prophÃ¨te qui a dÃ©montrÃ© la puissance de Dieu face aux prophÃ¨tes de Baal et a Ã©tÃ© nourri miraculeusement."
                },
                {
                    question: "Je suis celui qui a interprÃ©tÃ© les rÃªves du roi Nebucadnetsar et qui a survÃ©cu dans la fosse aux lions. Qui suis-je ?",
                    answer: ["daniel"],
                    hints: [
                        "ğŸ¦ J'ai passÃ© une nuit dans la fosse aux lions",
                        "ğŸ‘‘ J'ai interprÃ©tÃ© les rÃªves de Nebucadnetsar",
                        "ğŸ™ Je priais trois fois par jour malgrÃ© l'interdiction"
                    ],
                    explanation: "Daniel Ã©tait un prophÃ¨te fidÃ¨le qui a servi dans la cour babylonienne et a Ã©tÃ© protÃ©gÃ© par Dieu dans la fosse aux lions."
                },
                {
                    question: "Je suis la femme qui a remplacÃ© Vashti comme reine et qui ai sauvÃ© mon peuple d'un gÃ©nocide. Qui suis-je ?",
                    answer: ["esther"],
                    hints: [
                        "ğŸ‘‘ Je suis devenue reine de Perse",
                        "ğŸ­ J'ai cachÃ© mon identitÃ© juive au dÃ©but",
                        "âš”ï¸ J'ai dÃ©jouÃ© le plan d'Haman contre les Juifs"
                    ],
                    explanation: "Esther Ã©tait une jeune juive devenue reine de Perse qui a courageusement sauvÃ© son peuple du massacre planifiÃ© par Haman."
                },
                {
                    question: "Je suis celui qui a construit une arche pour sauver ma famille et les animaux du dÃ©luge. Qui suis-je ?",
                    answer: ["noe", "noÃ©"],
                    hints: [
                        "ğŸš¢ J'ai construit une grande arche en bois",
                        "ğŸŒ§ï¸ J'ai survÃ©cu au dÃ©luge de 40 jours",
                        "ğŸ•Šï¸ Une colombe m'a apportÃ© un rameau d'olivier"
                    ],
                    explanation: "NoÃ© Ã©tait un homme juste qui a obÃ©i Ã  Dieu en construisant l'arche et a sauvÃ© l'humanitÃ© et les animaux du dÃ©luge."
                },
                {
                    question: "Je suis la femme moabite qui a suivi ma belle-mÃ¨re et qui suis devenue l'arriÃ¨re-grand-mÃ¨re du roi David. Qui suis-je ?",
                    answer: ["ruth"],
                    hints: [
                        "ğŸ’• J'ai dit : 'Ton peuple sera mon peuple, ton Dieu sera mon Dieu'",
                        "ğŸŒ¾ J'ai glanÃ© dans les champs de Boaz",
                        "ğŸ‘µ Ma belle-mÃ¨re s'appelait Naomi"
                    ],
                    explanation: "Ruth Ã©tait une femme moabite qui a montrÃ© une fidÃ©litÃ© remarquable envers sa belle-mÃ¨re et est devenue ancÃªtre de David."
                },
                {
                    question: "Je suis le juge qui a vaincu les Madianites avec seulement 300 hommes et des cruches. Qui suis-je ?",
                    answer: ["gedeon", "gÃ©dÃ©on"],
                    hints: [
                        "ğŸº J'ai utilisÃ© des cruches et des torches pour effrayer l'ennemi",
                        "ğŸ‘¥ J'ai rÃ©duit mon armÃ©e de 32 000 Ã  300 hommes",
                        "ğŸŒ¾ J'ai demandÃ© un signe avec une toison"
                    ],
                    explanation: "GÃ©dÃ©on Ã©tait un juge d'IsraÃ«l qui a remportÃ© une victoire miraculeuse contre les Madianites avec une petite armÃ©e."
                },
                {
                    question: "Je suis le disciple qui a doutÃ© de la rÃ©surrection jusqu'Ã  ce que je voie les plaies de JÃ©sus. Qui suis-je ?",
                    answer: ["thomas"],
                    hints: [
                        "ğŸ¤š J'ai voulu toucher les plaies de JÃ©sus",
                        "â“ J'ai dit : 'Si je ne vois pas, je ne croirai pas'",
                        "âœï¸ J'ai proclamÃ© : 'Mon Seigneur et mon Dieu' aprÃ¨s avoir vu"
                    ],
                    explanation: "Thomas Ã©tait l'un des douze apÃ´tres, surnommÃ© 'l'incrÃ©dule' car il a doutÃ© de la rÃ©surrection avant de voir JÃ©sus."
                },
                {
                    question: "Je suis celui qui a baptisÃ© JÃ©sus dans le Jourdain et qui ai prÃ©parÃ© le chemin du Seigneur. Qui suis-je ?",
                    answer: ["jean-baptiste", "jean baptiste"],
                    hints: [
                        "ğŸŒŠ J'ai baptisÃ© JÃ©sus dans le fleuve Jourdain",
                        "ğŸ¦— Je me nourrissais de sauterelles et de miel sauvage",
                        "ğŸ—£ï¸ J'ai dit : 'Il faut qu'il croisse et que je diminue'"
                    ],
                    explanation: "Jean-Baptiste Ã©tait le prÃ©curseur de JÃ©sus, qui a prÃ©parÃ© le chemin du Seigneur et l'a baptisÃ© dans le Jourdain."
                },
                {
                    question: "Je suis l'apÃ´tre qui a reniÃ© JÃ©sus trois fois mais qui suis devenu le chef de l'Ã‰glise primitive. Qui suis-je ?",
                    answer: ["pierre"],
                    hints: [
                        "ğŸ“ J'ai reniÃ© JÃ©sus trois fois avant le chant du coq",
                        "ğŸ—ï¸ JÃ©sus m'a donnÃ© les clÃ©s du royaume des cieux",
                        "ğŸ£ J'Ã©tais pÃªcheur avant de suivre JÃ©sus"
                    ],
                    explanation: "Pierre Ã©tait l'apÃ´tre impulsif qui, malgrÃ© son reniement, est devenu le leader de l'Ã‰glise primitive aprÃ¨s la rÃ©surrection."
                },
                {
                    question: "Je suis celui qui a persÃ©cutÃ© les chrÃ©tiens avant de devenir apÃ´tre sur le chemin de Damas. Qui suis-je ?",
                    answer: ["paul", "saul"],
                    hints: [
                        "âš¡ J'ai Ã©tÃ© aveuglÃ© par une lumiÃ¨re sur le chemin de Damas",
                        "âœ‰ï¸ J'ai Ã©crit de nombreuses lettres aux Ã‰glises",
                        "ğŸ‘¥ Mon nom Ã©tait Saul avant ma conversion"
                    ],
                    explanation: "Paul (anciennement Saul) Ã©tait un persÃ©cuteur des chrÃ©tiens qui est devenu le plus grand missionnaire aprÃ¨s sa conversion miraculeuse."
                },
                {
                    question: "Je suis la femme qui a versÃ© un parfum prÃ©cieux sur les pieds de JÃ©sus et les a essuyÃ©s avec ses cheveux. Qui suis-je ?",
                    answer: ["marie-madeleine", "marie madeleine"],
                    hints: [
                        "ğŸ’ J'ai versÃ© un parfum trÃ¨s coÃ»teux sur JÃ©sus",
                        "ğŸ‘©â€ğŸ¦± J'ai essuyÃ© ses pieds avec mes cheveux",
                        "âœï¸ J'ai Ã©tÃ© la premiÃ¨re Ã  voir JÃ©sus ressuscitÃ©"
                    ],
                    explanation: "Marie-Madeleine Ã©tait une disciple dÃ©vouÃ©e de JÃ©sus, connue pour son geste d'amour avec le parfum et pour avoir Ã©tÃ© tÃ©moin de la rÃ©surrection."
                },
                {
                    question: "Je suis le roi qui a Ã©crit : 'L'Ã‰ternel est mon berger, je ne manquerai de rien'. Qui suis-je ?",
                    answer: ["david"],
                    hints: [
                        "ğŸ‘ J'Ã©tais berger avant d'Ãªtre roi",
                        "ğŸµ J'ai Ã©crit le Psaume 23",
                        "ğŸ‘‘ J'ai Ã©tÃ© le deuxiÃ¨me roi d'IsraÃ«l"
                    ],
                    explanation: "David, le roi-berger, a Ã©crit le cÃ©lÃ¨bre Psaume 23 qui commence par 'L'Ã‰ternel est mon berger'."
                },
                {
                    question: "Je suis celui qui a Ã©tÃ© jetÃ© dans une citerne par ses frÃ¨res mais qui ai fini par leur pardonner. Qui suis-je ?",
                    answer: ["joseph"],
                    hints: [
                        "ğŸ•³ï¸ Mes frÃ¨res m'ont jetÃ© dans une citerne",
                        "ğŸ J'ai nourri mes frÃ¨res pendant la famine",
                        "ğŸ˜¢ J'ai pleurÃ© quand je me suis fait reconnaÃ®tre"
                    ],
                    explanation: "Joseph a pardonnÃ© Ã  ses frÃ¨res qui l'avaient vendu, dÃ©montrant un cÅ“ur plein de grÃ¢ce et de misÃ©ricorde."
                },
                {
                    question: "Je suis la femme stÃ©rile qui a priÃ© avec ferveur et qui ai donnÃ© naissance au prophÃ¨te Samuel. Qui suis-je ?",
                    answer: ["anne"],
                    hints: [
                        "ğŸ™ J'ai priÃ© avec tant de ferveur qu'on m'a crue ivre",
                        "ğŸ‘¶ J'ai consacrÃ© mon fils au service de Dieu",
                        "ğŸ›ï¸ J'ai amenÃ© Samuel au temple quand il Ã©tait petit"
                    ],
                    explanation: "Anne Ã©tait une femme de foi qui a priÃ© avec persÃ©vÃ©rance pour avoir un enfant et a consacrÃ© Samuel Ã  Dieu."
                },
                {
                    question: "Je suis le disciple bien-aimÃ© qui ai Ã©crit l'Ã‰vangile de l'amour et l'Apocalypse. Qui suis-je ?",
                    answer: ["jean"],
                    hints: [
                        "â¤ï¸ J'Ã©tais le disciple que JÃ©sus aimait",
                        "ğŸ“– J'ai Ã©crit : 'Dieu est amour'",
                        "ğŸï¸ J'ai reÃ§u la rÃ©vÃ©lation sur l'Ã®le de Patmos"
                    ],
                    explanation: "Jean Ã©tait le disciple bien-aimÃ©, auteur de l'Ã‰vangile qui met l'accent sur l'amour et du livre de l'Apocalypse."
                },
                {
                    question: "Je suis celui qui ai luttÃ© avec l'ange toute une nuit et dont le nom a Ã©tÃ© changÃ© en IsraÃ«l. Qui suis-je ?",
                    answer: ["jacob"],
                    hints: [
                        "ğŸ¤¼â€â™‚ï¸ J'ai luttÃ© avec un ange jusqu'Ã  l'aube",
                        "ğŸ¦µ Ma hanche a Ã©tÃ© dÃ©boÃ®tÃ©e pendant le combat",
                        "ğŸ‘¥ J'ai eu douze fils qui sont devenus les tribus d'IsraÃ«l"
                    ],
                    explanation: "Jacob a luttÃ© avec l'ange et son nom a Ã©tÃ© changÃ© en IsraÃ«l, devenant le pÃ¨re des douze tribus."
                },
                {
                    question: "Je suis la femme qui ai cachÃ© les espions sur le toit et qui ai Ã©tÃ© sauvÃ©e par un cordon rouge. Qui suis-je ?",
                    answer: ["rahab"],
                    hints: [
                        "ğŸ  J'habitais dans les murailles de JÃ©richo",
                        "ğŸ”´ Un cordon rouge a marquÃ© ma maison",
                        "ğŸ‘¥ J'ai aidÃ© les espions israÃ©lites Ã  s'Ã©chapper"
                    ],
                    explanation: "Rahab a fait preuve de foi en aidant les espions d'IsraÃ«l et a Ã©tÃ© rÃ©compensÃ©e par le salut de sa famille."
                },
                {
                    question: "Je suis celui qui ai Ã©tÃ© appelÃ© 'ami de Dieu' et qui ai Ã©tÃ© prÃªt Ã  sacrifier mon fils unique. Qui suis-je ?",
                    answer: ["abraham"],
                    hints: [
                        "ğŸ‘´ J'ai quittÃ© ma terre natale sur l'ordre de Dieu",
                        "ğŸ”ª J'ai Ã©tÃ© prÃªt Ã  sacrifier Isaac sur le mont Morija",
                        "â­ Dieu m'a promis une descendance nombreuse comme les Ã©toiles"
                    ],
                    explanation: "Abraham Ã©tait l'ami de Dieu, le pÃ¨re de la foi, qui a obÃ©i mÃªme quand Dieu lui a demandÃ© de sacrifier Isaac."
                },
                {
                    question: "Je suis le prophÃ¨te qui ai Ã©tÃ© emmenÃ© au ciel dans un char de feu sans passer par la mort. Qui suis-je ?",
                    answer: ["elie", "Ã©lie"],
                    hints: [
                        "ğŸ”¥ Un char de feu m'a emmenÃ© au ciel",
                        "ğŸŒªï¸ Un tourbillon m'a enlevÃ©",
                        "ğŸ‘¨â€ğŸ“ Ã‰lisÃ©e Ã©tait mon disciple et successeur"
                    ],
                    explanation: "Ã‰lie a Ã©tÃ© enlevÃ© au ciel dans un char de feu, Ã©tant l'un des rares Ã  ne pas avoir connu la mort."
                }
            ]
        };

        // Tournament data
        let tournamentData = {
            currentRound: 1,
            maxRounds: 10,
            score: 0,
            timeLeft: 15,
            timer: null,
            selectedAnswer: null,
            currentQuestion: 0,
            playerRank: 156,
            questions: [
                {
                    question: "Qui Ã©tait le plus jeune des fils de Jacob ?",
                    options: ["A) Joseph", "B) Benjamin", "C) Dan", "D) Nephtali"],
                    correct: 1
                },
                {
                    question: "Quel prophÃ¨te a Ã©tÃ© nourri par des corbeaux ?",
                    options: ["A) Ã‰lie", "B) Ã‰lisÃ©e", "C) Ã‰zÃ©chiel", "D) JÃ©rÃ©mie"],
                    correct: 0
                },
                {
                    question: "Combien de temps Daniel a-t-il priÃ© malgrÃ© l'interdiction ?",
                    options: ["A) 7 jours", "B) 21 jours", "C) 30 jours", "D) Il n'a jamais arrÃªtÃ©"],
                    correct: 3
                },
                {
                    question: "Qui Ã©tait la femme de MoÃ¯se ?",
                    options: ["A) SÃ©phora", "B) Miriam", "C) DÃ©bora", "D) Ruth"],
                    correct: 0
                },
                {
                    question: "Quel roi a construit le premier temple ?",
                    options: ["A) David", "B) Salomon", "C) Ã‰zÃ©chias", "D) Josias"],
                    correct: 1
                },
                {
                    question: "Combien de plaies Dieu a-t-il envoyÃ©es sur l'Ã‰gypte ?",
                    options: ["A) 7", "B) 10", "C) 12", "D) 40"],
                    correct: 1
                },
                {
                    question: "Qui a interprÃ©tÃ© le rÃªve de Nebucadnetsar ?",
                    options: ["A) Joseph", "B) Daniel", "C) Ã‰zÃ©chiel", "D) JÃ©rÃ©mie"],
                    correct: 1
                },
                {
                    question: "Quel Ã©tait le nom du gÃ©ant vaincu par David ?",
                    options: ["A) Og", "B) Goliath", "C) Sihon", "D) Anak"],
                    correct: 1
                },
                {
                    question: "Combien d'annÃ©es les IsraÃ©lites ont-ils errÃ© dans le dÃ©sert ?",
                    options: ["A) 30", "B) 40", "C) 50", "D) 70"],
                    correct: 1
                },
                {
                    question: "Qui Ã©tait le pÃ¨re de Jean-Baptiste ?",
                    options: ["A) Zacharie", "B) SimÃ©on", "C) Joseph", "D) HÃ©rode"],
                    correct: 0
                }
            ]
        };

        // Tournament functions
        function startTournament() {
            tournamentData.currentRound = 1;
            tournamentData.score = 0;
            tournamentData.selectedAnswer = null;
            tournamentData.currentQuestion = Math.floor(Math.random() * tournamentData.questions.length);
            tournamentData.playerRank = Math.floor(Math.random() * 200) + 50;
            
            document.getElementById('tournamentModal').classList.remove('hidden');
            document.getElementById('tournamentModal').classList.add('flex');
            
            loadTournamentQuestion();
        }

        function loadTournamentQuestion() {
            const current = tournamentData.questions[tournamentData.currentQuestion];
            
            document.getElementById('tournamentQuestion').textContent = current.question;
            document.getElementById('tournamentRound').textContent = tournamentData.currentRound;
            document.getElementById('tournamentScore').textContent = tournamentData.score;
            document.getElementById('playerRank').textContent = tournamentData.playerRank;
            
            const optionsContainer = document.getElementById('tournamentOptions');
            optionsContainer.innerHTML = '';
            
            current.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.onclick = () => selectTournamentAnswer(index);
                button.className = 'w-full p-3 text-left border-2 border-gray-200 rounded-lg hover:border-purple-500 transition-all interactive-btn tournament-option';
                button.setAttribute('data-index', index);
                button.innerHTML = `<span class="font-medium">${option}</span>`;
                optionsContainer.appendChild(button);
            });
            
            tournamentData.selectedAnswer = null;
            tournamentData.timeLeft = 15;
            startTournamentTimer();
            updateLeaderboard();
        }

        function selectTournamentAnswer(index) {
            if (tournamentData.selectedAnswer !== null) return;
            
            tournamentData.selectedAnswer = index;
            clearInterval(tournamentData.timer);
            
            const current = tournamentData.questions[tournamentData.currentQuestion];
            
            // Montrer les rÃ©ponses
            document.querySelectorAll('.tournament-option').forEach((btn, i) => {
                btn.disabled = true;
                btn.classList.remove('border-gray-200', 'hover:border-purple-500');
                
                if (i === current.correct) {
                    btn.classList.add('border-green-500', 'bg-green-50');
                } else if (i === index && i !== current.correct) {
                    btn.classList.add('border-red-500', 'bg-red-50');
                }
            });
            
            // Calculer le score
            if (index === current.correct) {
                const timeBonus = Math.max(0, tournamentData.timeLeft * 10);
                const basePoints = 100;
                const roundBonus = tournamentData.currentRound * 5;
                const totalPoints = basePoints + timeBonus + roundBonus;
                
                tournamentData.score += totalPoints;
                tournamentData.playerRank = Math.max(1, tournamentData.playerRank - Math.floor(Math.random() * 10));
                showNotification(`âœ… +${totalPoints} points ! Classement: ${tournamentData.playerRank}`);
            } else {
                tournamentData.playerRank = Math.min(2847, tournamentData.playerRank + Math.floor(Math.random() * 5));
                showNotification('âŒ Mauvaise rÃ©ponse !');
            }
            
            // Attendre 2 secondes puis passer Ã  la question suivante
            setTimeout(() => {
                if (tournamentData.currentRound >= tournamentData.maxRounds) {
                    endTournament();
                } else {
                    tournamentData.currentRound++;
                    // Choisir une nouvelle question alÃ©atoire
                    let newQuestionIndex;
                    do {
                        newQuestionIndex = Math.floor(Math.random() * tournamentData.questions.length);
                    } while (newQuestionIndex === tournamentData.currentQuestion && tournamentData.questions.length > 1);
                    
                    tournamentData.currentQuestion = newQuestionIndex;
                    
                    // RÃ©activer les boutons
                    document.querySelectorAll('.tournament-option').forEach(btn => {
                        btn.disabled = false;
                    });
                    
                    loadTournamentQuestion();
                }
            }, 2000);
        }

        function startTournamentTimer() {
            clearInterval(tournamentData.timer);
            
            tournamentData.timer = setInterval(() => {
                tournamentData.timeLeft--;
                document.getElementById('tournamentTimer').textContent = tournamentData.timeLeft + 's';
                
                if (tournamentData.timeLeft <= 0) {
                    clearInterval(tournamentData.timer);
                    // Temps Ã©coulÃ©, considÃ©rer comme mauvaise rÃ©ponse
                    if (tournamentData.selectedAnswer === null) {
                        selectTournamentAnswer(-1); // RÃ©ponse invalide
                    }
                }
            }, 1000);
        }

        function updateLeaderboard() {
            // Simuler des changements dans le classement
            const leaderboard = [
                { name: 'David_ProphÃ¨te', score: 2450 + Math.floor(Math.random() * 100) },
                { name: 'Marie_Sagesse', score: 2380 + Math.floor(Math.random() * 100) },
                { name: 'Paul_VÃ©ritÃ©', score: 2290 + Math.floor(Math.random() * 100) },
                { name: 'Sarah_Foi', score: 2180 + Math.floor(Math.random() * 100) },
                { name: 'Luc_Espoir', score: 2120 + Math.floor(Math.random() * 100) }
            ];
            
            // Trier par score
            leaderboard.sort((a, b) => b.score - a.score);
            
            const leaderboardContainer = document.getElementById('tournamentLeaderboard');
            const medals = ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', '4.', '5.'];
            const colors = ['text-yellow-500', 'text-gray-400', 'text-orange-500', 'text-gray-600', 'text-gray-600'];
            
            leaderboardContainer.innerHTML = leaderboard.map((player, index) => `
                <div class="flex items-center justify-between text-sm">
                    <div class="flex items-center">
                        <span class="${colors[index]} mr-2">${medals[index]}</span>
                        <span class="font-medium">${player.name}</span>
                    </div>
                    <span class="font-bold text-purple-600">${player.score.toLocaleString()} pts</span>
                </div>
            `).join('');
        }

        function endTournament() {
            document.getElementById('tournamentContent').classList.add('hidden');
            document.getElementById('tournamentResults').classList.remove('hidden');
            
            document.getElementById('finalTournamentScore').textContent = tournamentData.score.toLocaleString();
            document.getElementById('finalTournamentRank').textContent = tournamentData.playerRank;
            
            // Calculer la rÃ©compense
            let reward = 50;
            if (tournamentData.playerRank <= 10) {
                reward = 500;
                document.getElementById('tournamentResultIcon').textContent = 'ğŸ†';
                document.getElementById('tournamentResultText').textContent = 'Top 10 mondial !';
            } else if (tournamentData.playerRank <= 50) {
                reward = 300;
                document.getElementById('tournamentResultIcon').textContent = 'ğŸ¥‡';
                document.getElementById('tournamentResultText').textContent = 'Excellent classement !';
            } else if (tournamentData.playerRank <= 100) {
                reward = 200;
                document.getElementById('tournamentResultIcon').textContent = 'ğŸ‰';
                document.getElementById('tournamentResultText').textContent = 'Bon tournoi !';
            } else {
                document.getElementById('tournamentResultIcon').textContent = 'ğŸ‘';
                document.getElementById('tournamentResultText').textContent = 'Tournoi terminÃ© !';
            }
            
            document.getElementById('tournamentReward').textContent = `+${reward} XP`;
            
            showNotification(`ğŸ† Tournoi terminÃ© ! Classement: ${tournamentData.playerRank}/2,847`);
        }

        function restartTournament() {
            document.getElementById('tournamentContent').classList.remove('hidden');
            document.getElementById('tournamentResults').classList.add('hidden');
            startTournament();
        }

        function joinNewTournament() {
            showNotification('ğŸ¯ Recherche d\'un nouveau tournoi...');
            setTimeout(() => {
                restartTournament();
            }, 1000);
        }

        function closeTournamentModal() {
            clearInterval(tournamentData.timer);
            document.getElementById('tournamentModal').classList.add('hidden');
            document.getElementById('tournamentModal').classList.remove('flex');
        }

        // Mystery game functions
        function startMysteryGame() {
            mysteryData.currentMystery = 0;
            mysteryData.score = 0;
            mysteryData.hintsUsed = 0;
            mysteryData.startTime = Date.now();
            
            document.getElementById('mysteryModal').classList.remove('hidden');
            document.getElementById('mysteryModal').classList.add('flex');
            
            loadCurrentMystery();
        }

        function loadCurrentMystery() {
            const current = mysteryData.mysteries[mysteryData.currentMystery];
            
            document.getElementById('mysteryQuestion').textContent = current.question;
            document.getElementById('mysteryNumber').textContent = mysteryData.currentMystery + 1;
            document.getElementById('mysteryScore').textContent = mysteryData.score;
            document.getElementById('mysteryHints').textContent = mysteryData.maxHints - mysteryData.hintsUsed;
            document.getElementById('mysteryAnswer').value = '';
            
            // RÃ©initialiser l'interface
            document.getElementById('mysteryContent').classList.remove('hidden');
            document.getElementById('mysteryResults').classList.add('hidden');
            document.getElementById('hintsContainer').classList.add('hidden');
            document.getElementById('hintsList').innerHTML = '';
            
            // Mettre Ã  jour le bouton d'indice
            const hintBtn = document.getElementById('hintBtn');
            const hintsLeft = mysteryData.maxHints - mysteryData.hintsUsed;
            if (hintsLeft > 0) {
                hintBtn.textContent = `ğŸ’¡ Demander un indice (${hintsLeft} restants)`;
                hintBtn.disabled = false;
                hintBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                hintBtn.textContent = 'ğŸ’¡ Plus d\'indices disponibles';
                hintBtn.disabled = true;
                hintBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
            
            mysteryData.startTime = Date.now();
        }

        function checkMysteryAnswer() {
            const userAnswer = document.getElementById('mysteryAnswer').value.toLowerCase().trim();
            const current = mysteryData.mysteries[mysteryData.currentMystery];
            
            if (!userAnswer) {
                showNotification('â“ Ã‰cris ta rÃ©ponse d\'abord !');
                return;
            }
            
            const isCorrect = current.answer.some(answer => 
                userAnswer === answer.toLowerCase() || 
                userAnswer.includes(answer.toLowerCase())
            );
            
            const timeTaken = Math.floor((Date.now() - mysteryData.startTime) / 1000);
            
            document.getElementById('mysteryContent').classList.add('hidden');
            document.getElementById('mysteryResults').classList.remove('hidden');
            
            if (isCorrect) {
                // Calculer le score
                let points = 100;
                const timeBonus = Math.max(0, 60 - timeTaken) * 2; // Bonus de temps
                const hintPenalty = mysteryData.hintsUsed * 10; // PÃ©nalitÃ© pour les indices
                const totalPoints = Math.max(10, points + timeBonus - hintPenalty);
                
                mysteryData.score += totalPoints;
                
                document.getElementById('mysteryResultIcon').textContent = 'ğŸ‰';
                document.getElementById('mysteryResultText').textContent = 'MystÃ¨re rÃ©solu !';
                document.getElementById('finalMysteryScore').textContent = `+${totalPoints}`;
                
                showNotification(`ğŸ‰ Correct ! +${totalPoints} points`);
            } else {
                document.getElementById('mysteryResultIcon').textContent = 'âŒ';
                document.getElementById('mysteryResultText').textContent = 'Pas tout Ã  fait...';
                document.getElementById('finalMysteryScore').textContent = '0';
                
                showNotification(`âŒ La rÃ©ponse Ã©tait : ${current.answer[0]}`);
            }
            
            document.getElementById('mysteryTime').textContent = timeTaken + 's';
            document.getElementById('mysteryExplanation').textContent = current.explanation;
        }

        function getMysteryHint() {
            if (mysteryData.hintsUsed >= mysteryData.maxHints) {
                showNotification('ğŸ’¡ Plus d\'indices disponibles !');
                return;
            }
            
            const current = mysteryData.mysteries[mysteryData.currentMystery];
            const hint = current.hints[mysteryData.hintsUsed];
            
            // Afficher le conteneur des indices
            document.getElementById('hintsContainer').classList.remove('hidden');
            
            // Ajouter le nouvel indice
            const hintsList = document.getElementById('hintsList');
            const hintElement = document.createElement('div');
            hintElement.className = 'text-sm text-yellow-700';
            hintElement.textContent = `${mysteryData.hintsUsed + 1}. ${hint}`;
            hintsList.appendChild(hintElement);
            
            mysteryData.hintsUsed++;
            
            // Mettre Ã  jour l'affichage
            document.getElementById('mysteryHints').textContent = mysteryData.maxHints - mysteryData.hintsUsed;
            
            // Mettre Ã  jour le bouton d'indice
            const hintBtn = document.getElementById('hintBtn');
            const hintsLeft = mysteryData.maxHints - mysteryData.hintsUsed;
            if (hintsLeft > 0) {
                hintBtn.textContent = `ğŸ’¡ Demander un indice (${hintsLeft} restants)`;
            } else {
                hintBtn.textContent = 'ğŸ’¡ Plus d\'indices disponibles';
                hintBtn.disabled = true;
                hintBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
            
            showNotification(`ğŸ’¡ Indice rÃ©vÃ©lÃ© ! ${hintsLeft} restants`);
        }

        function handleMysteryKeyPress(event) {
            if (event.key === 'Enter') {
                checkMysteryAnswer();
            }
        }

        function nextMystery() {
            if (mysteryData.currentMystery < mysteryData.mysteries.length - 1) {
                mysteryData.currentMystery++;
                mysteryData.hintsUsed = 0; // RÃ©initialiser les indices pour le nouveau mystÃ¨re
                loadCurrentMystery();
            } else {
                // Fin du jeu
                showFinalMysteryResults();
            }
        }

        function skipMystery() {
            if (confirm('Es-tu sÃ»r de vouloir passer ce mystÃ¨re ? Tu ne gagneras aucun point.')) {
                nextMystery();
                showNotification('â­ï¸ MystÃ¨re passÃ©');
            }
        }

        function showFinalMysteryResults() {
            document.getElementById('mysteryContent').classList.add('hidden');
            document.getElementById('mysteryResults').classList.remove('hidden');
            
            document.getElementById('mysteryResultIcon').textContent = 'ğŸ†';
            document.getElementById('mysteryResultText').textContent = 'Tous les mystÃ¨res terminÃ©s !';
            document.getElementById('finalMysteryScore').textContent = mysteryData.score;
            document.getElementById('mysteryTime').textContent = 'Fini !';
            document.getElementById('mysteryExplanation').textContent = `FÃ©licitations ! Tu as terminÃ© tous les mystÃ¨res bibliques avec un score de ${mysteryData.score} points. Tu es un vrai dÃ©tective de la Bible ! ğŸ•µï¸â€â™‚ï¸`;
            
            // Cacher le bouton "MystÃ¨re suivant"
            const nextBtn = document.querySelector('[onclick="nextMystery()"]');
            if (nextBtn) {
                nextBtn.style.display = 'none';
            }
        }

        function restartMysteryGame() {
            mysteryData.currentMystery = 0;
            mysteryData.score = 0;
            mysteryData.hintsUsed = 0;
            
            // RÃ©afficher le bouton "MystÃ¨re suivant"
            const nextBtn = document.querySelector('[onclick="nextMystery()"]');
            if (nextBtn) {
                nextBtn.style.display = 'block';
            }
            
            loadCurrentMystery();
        }

        function closeMysteryModal() {
            document.getElementById('mysteryModal').classList.add('hidden');
            document.getElementById('mysteryModal').classList.remove('flex');
        }

        // Spiritual Journey data
        let journeyData = {
            currentJourney: 1, // 1 = Fondations, 2 = Vie de JÃ©sus, 3 = Vie de Joseph, etc.
            currentDay: 1,
            totalDays: 40,
            completedSteps: 0,
            totalSteps: 5,
            xp: 0,
            level: 1,
            badges: [],
            streak: 0,
            completedJourneys: [],
            steps: [
                { id: 1, title: 'ğŸ“– Lire Jean 3:16', description: 'MÃ©dite sur l\'amour de Dieu', completed: false },
                { id: 2, title: 'ğŸ™ Prier 5 minutes', description: 'Parle Ã  Dieu de ton cÅ“ur', completed: false },
                { id: 3, title: 'âœï¸ Ã‰crire une gratitude', description: 'Note une chose pour laquelle tu es reconnaissant', completed: false },
                { id: 4, title: 'ğŸ’ Acte de bontÃ©', description: 'Fais quelque chose de gentil pour quelqu\'un', completed: false },
                { id: 5, title: 'ğŸ¯ RÃ©flexion du jour', description: 'RÃ©ponds Ã  la question de rÃ©flexion', completed: false }
            ],
            journeys: {
                1: {
                    title: 'ğŸŒ± Les Fondations',
                    subtitle: 'Parcours spirituel de base',
                    description: 'DÃ©couvre les piliers essentiels de la foi chrÃ©tienne en 40 jours',
                    color: 'from-emerald-500 to-teal-600',
                    totalDays: 40,
                    dailyThemes: [
                        { day: 1, title: 'ğŸŒ± Les Fondations', description: 'Pose les bases de ton parcours spirituel. DÃ©couvre les piliers de la foi chrÃ©tienne.' },
                        { day: 2, title: 'ğŸ™ La PriÃ¨re', description: 'Apprends Ã  communiquer avec Dieu et Ã  dÃ©velopper une vie de priÃ¨re authentique.' },
                        { day: 3, title: 'ğŸ“– La Parole', description: 'DÃ©couvre comment la Bible peut transformer ta vie quotidienne et te guider.' },
                        { day: 4, title: 'â¤ï¸ L\'Amour', description: 'Explore l\'amour de Dieu et comment l\'exprimer envers les autres.' },
                        { day: 5, title: 'ğŸ•Šï¸ La Paix', description: 'Trouve la paix intÃ©rieure qui vient de Dieu, mÃªme dans les tempÃªtes.' },
                        { day: 6, title: 'ğŸ’ª La Force', description: 'DÃ©couvre la force qui vient de Dieu pour surmonter les dÃ©fis.' },
                        { day: 7, title: 'ğŸŒŸ L\'Espoir', description: 'Cultive l\'espoir qui ne dÃ©Ã§oit jamais, ancrÃ© en Christ.' },
                        { day: 8, title: 'ğŸµ La Louange', description: 'Apprends Ã  louer Dieu dans toutes les circonstances.' },
                        { day: 9, title: 'ğŸ¤ La Communion', description: 'DÃ©couvre l\'importance de la communautÃ© chrÃ©tienne.' },
                        { day: 10, title: 'ğŸ”¥ La Passion', description: 'DÃ©veloppe une passion ardente pour Dieu et sa mission.' },
                        { day: 11, title: 'ğŸ›¡ï¸ La Foi', description: 'Renforce ta foi et apprends Ã  faire confiance Ã  Dieu.' },
                        { day: 12, title: 'ğŸ La GrÃ¢ce', description: 'Comprends la grÃ¢ce immense de Dieu envers toi.' },
                        { day: 13, title: 'ğŸ”„ Le Pardon', description: 'Apprends Ã  pardonner comme Dieu te pardonne.' },
                        { day: 14, title: 'ğŸŒˆ L\'Alliance', description: 'DÃ©couvre les promesses de Dieu pour ta vie.' },
                        { day: 15, title: 'âš–ï¸ La Justice', description: 'Comprends la justice et la misÃ©ricorde de Dieu.' },
                        { day: 16, title: 'ğŸ•¯ï¸ La LumiÃ¨re', description: 'Sois une lumiÃ¨re dans ce monde.' },
                        { day: 17, title: 'ğŸ§­ La Direction', description: 'Laisse Dieu guider tes pas.' },
                        { day: 18, title: 'ğŸ¯ Le But', description: 'DÃ©couvre le plan de Dieu pour ta vie.' },
                        { day: 19, title: 'ğŸŒŠ Le BaptÃªme', description: 'Comprends la signification du baptÃªme.' },
                        { day: 20, title: 'ğŸ La Communion', description: 'MÃ©dite sur le sacrifice de JÃ©sus.' },
                        { day: 21, title: 'ğŸ‘‘ La RoyautÃ©', description: 'Tu es enfant du Roi des rois.' },
                        { day: 22, title: 'ğŸª La Joie', description: 'Trouve la joie parfaite en Dieu.' },
                        { day: 23, title: 'ğŸŒ¿ La Croissance', description: 'Grandis spirituellement chaque jour.' },
                        { day: 24, title: 'ğŸ”¥ L\'Esprit Saint', description: 'DÃ©couvre le rÃ´le de l\'Esprit Saint.' },
                        { day: 25, title: 'ğŸ“¯ Le TÃ©moignage', description: 'Partage ta foi avec les autres.' },
                        { day: 26, title: 'ğŸ”ï¸ Les DÃ©fis', description: 'Surmonte les obstacles avec Dieu.' },
                        { day: 27, title: 'ğŸŒ… Le Renouveau', description: 'Chaque jour est un nouveau commencement.' },
                        { day: 28, title: 'ğŸ­ L\'IdentitÃ©', description: 'DÃ©couvre qui tu es en Christ.' },
                        { day: 29, title: 'ğŸŒ La Mission', description: 'Trouve ta mission dans le monde.' },
                        { day: 30, title: 'â­ La Gloire', description: 'Rends gloire Ã  Dieu en toutes choses.' },
                        { day: 31, title: 'ğŸ”— L\'UnitÃ©', description: 'Vis l\'unitÃ© avec tes frÃ¨res et sÅ“urs.' },
                        { day: 32, title: 'ğŸ¨ La CrÃ©ativitÃ©', description: 'Utilise tes talents pour Dieu.' },
                        { day: 33, title: 'ğŸƒâ€â™‚ï¸ La PersÃ©vÃ©rance', description: 'Continue malgrÃ© les difficultÃ©s.' },
                        { day: 34, title: 'ğŸª La CÃ©lÃ©bration', description: 'CÃ©lÃ¨bre les victoires de Dieu.' },
                        { day: 35, title: 'ğŸŒ± Les Fruits', description: 'Porte du fruit dans ta vie.' },
                        { day: 36, title: 'ğŸ  La Famille', description: 'DÃ©couvre la famille de Dieu.' },
                        { day: 37, title: 'ğŸ’ La Valeur', description: 'Tu as une valeur inestimable aux yeux de Dieu.' },
                        { day: 38, title: 'ğŸŒŸ La Transformation', description: 'Laisse Dieu te transformer.' },
                        { day: 39, title: 'ğŸ¯ L\'HÃ©ritage', description: 'PrÃ©pare l\'hÃ©ritage que tu laisseras.' },
                        { day: 40, title: 'ğŸ‘‘ La Victoire', description: 'CÃ©lÃ¨bre la victoire finale en Christ.' }
                    ]
                },
                2: {
                    title: 'âœï¸ La Vie de JÃ©sus',
                    subtitle: 'Suivre les pas du Sauveur',
                    description: 'DÃ©couvre la vie, les enseignements et l\'Å“uvre de JÃ©sus-Christ en 40 jours',
                    color: 'from-blue-500 to-purple-600',
                    totalDays: 40,
                    dailyThemes: [
                        { day: 1, title: 'ğŸŒŸ L\'Annonciation', description: 'L\'ange Gabriel annonce Ã  Marie qu\'elle portera le Sauveur.' },
                        { day: 2, title: 'ğŸ‘¶ La Naissance', description: 'JÃ©sus naÃ®t Ã  BethlÃ©em, accomplissant les prophÃ©ties.' },
                        { day: 3, title: 'â­ Les Mages', description: 'Les mages d\'Orient viennent adorer le nouveau-nÃ©.' },
                        { day: 4, title: 'ğŸƒâ€â™‚ï¸ La Fuite en Ã‰gypte', description: 'Joseph et Marie fuient en Ã‰gypte pour protÃ©ger JÃ©sus.' },
                        { day: 5, title: 'ğŸ›ï¸ JÃ©sus au Temple', description: 'Ã€ 12 ans, JÃ©sus Ã©tonne les docteurs au temple.' },
                        { day: 6, title: 'ğŸ”¨ Le Charpentier', description: 'JÃ©sus grandit et apprend le mÃ©tier de charpentier.' },
                        { day: 7, title: 'ğŸŒŠ Le BaptÃªme', description: 'Jean-Baptiste baptise JÃ©sus dans le Jourdain.' },
                        { day: 8, title: 'ğŸœï¸ La Tentation', description: 'JÃ©sus jeÃ»ne 40 jours et rÃ©siste aux tentations de Satan.' },
                        { day: 9, title: 'ğŸ‘¥ Les Premiers Disciples', description: 'JÃ©sus appelle ses premiers disciples.' },
                        { day: 10, title: 'ğŸ’’ Les Noces de Cana', description: 'Premier miracle : JÃ©sus change l\'eau en vin.' },
                        { day: 11, title: 'ğŸ›ï¸ Purification du Temple', description: 'JÃ©sus chasse les marchands du temple.' },
                        { day: 12, title: 'ğŸŒ™ NicodÃ¨me', description: 'JÃ©sus explique la nouvelle naissance Ã  NicodÃ¨me.' },
                        { day: 13, title: 'ğŸ’§ La Samaritaine', description: 'JÃ©sus rÃ©vÃ¨le qu\'il est l\'eau vive.' },
                        { day: 14, title: 'ğŸ Multiplication des Pains', description: 'JÃ©sus nourrit 5000 personnes avec 5 pains.' },
                        { day: 15, title: 'ğŸŒŠ Marche sur l\'Eau', description: 'JÃ©sus marche sur les eaux du lac.' },
                        { day: 16, title: 'ğŸ‘ï¸ GuÃ©rison de l\'Aveugle', description: 'JÃ©sus redonne la vue Ã  un aveugle-nÃ©.' },
                        { day: 17, title: 'ğŸ‘ Le Bon Berger', description: 'JÃ©sus se rÃ©vÃ¨le comme le bon berger.' },
                        { day: 18, title: 'ğŸ’€ RÃ©surrection de Lazare', description: 'JÃ©sus ressuscite son ami Lazare.' },
                        { day: 19, title: 'ğŸ‘¶ JÃ©sus et les Enfants', description: 'Laissez venir Ã  moi les petits enfants.' },
                        { day: 20, title: 'ğŸ’° Le Jeune Homme Riche', description: 'JÃ©sus parle des richesses et du royaume.' },
                        { day: 21, title: 'ğŸŒ´ EntrÃ©e Triomphale', description: 'JÃ©sus entre Ã  JÃ©rusalem sur un Ã¢non.' },
                        { day: 22, title: 'ğŸ›ï¸ Enseignement au Temple', description: 'JÃ©sus enseigne dans le temple.' },
                        { day: 23, title: 'ğŸ•¯ï¸ Les Vierges Sages', description: 'Parabole sur la vigilance.' },
                        { day: 24, title: 'ğŸ’° Les Talents', description: 'Parabole sur la fidÃ©litÃ©.' },
                        { day: 25, title: 'ğŸ‘ Le Jugement Final', description: 'JÃ©sus parle du jugement des nations.' },
                        { day: 26, title: 'ğŸ’¸ La Trahison', description: 'Judas trahit JÃ©sus pour 30 piÃ¨ces d\'argent.' },
                        { day: 27, title: 'ğŸ La CÃ¨ne', description: 'Le dernier repas de JÃ©sus avec ses disciples.' },
                        { day: 28, title: 'ğŸ«’ GethsÃ©manÃ©', description: 'JÃ©sus prie avec angoisse au jardin.' },
                        { day: 29, title: 'â›“ï¸ L\'Arrestation', description: 'JÃ©sus est arrÃªtÃ© et abandonnÃ©.' },
                        { day: 30, title: 'âš–ï¸ Le ProcÃ¨s', description: 'JÃ©sus comparaÃ®t devant Pilate.' },
                        { day: 31, title: 'ğŸ‘‘ La Couronne d\'Ã‰pines', description: 'JÃ©sus est moquÃ© et couronnÃ© d\'Ã©pines.' },
                        { day: 32, title: 'âœï¸ Le Chemin de Croix', description: 'JÃ©sus porte sa croix vers le Golgotha.' },
                        { day: 33, title: 'âš°ï¸ La Crucifixion', description: 'JÃ©sus meurt sur la croix pour nos pÃ©chÃ©s.' },
                        { day: 34, title: 'ğŸª¦ La Mise au Tombeau', description: 'Le corps de JÃ©sus est enseveli.' },
                        { day: 35, title: 'ğŸŒ… La RÃ©surrection', description: 'JÃ©sus ressuscite le troisiÃ¨me jour !' },
                        { day: 36, title: 'ğŸ‘© Marie-Madeleine', description: 'PremiÃ¨re tÃ©moin de la rÃ©surrection.' },
                        { day: 37, title: 'ğŸš¶â€â™‚ï¸ EmmaÃ¼s', description: 'JÃ©sus apparaÃ®t aux disciples d\'EmmaÃ¼s.' },
                        { day: 38, title: 'ğŸŸ PÃªche Miraculeuse', description: 'JÃ©sus apparaÃ®t aux disciples pÃªcheurs.' },
                        { day: 39, title: 'â˜ï¸ L\'Ascension', description: 'JÃ©sus monte au ciel devant ses disciples.' },
                        { day: 40, title: 'ğŸ”¥ La PentecÃ´te', description: 'L\'Esprit Saint descend sur les disciples.' }
                    ]
                },
                3: {
                    title: 'ğŸŒˆ La Vie de Joseph',
                    subtitle: 'De l\'Ã©preuve Ã  la gloire',
                    description: 'DÃ©couvre l\'histoire inspirante de Joseph, de ses rÃªves Ã  son rÃ¨gne en Ã‰gypte',
                    color: 'from-yellow-500 to-orange-600',
                    totalDays: 40,
                    dailyThemes: [
                        { day: 1, title: 'ğŸ‘¶ La Naissance de Joseph', description: 'Joseph naÃ®t, fils bien-aimÃ© de Jacob et Rachel.' },
                        { day: 2, title: 'ğŸŒˆ Le Manteau Multicolore', description: 'Jacob offre Ã  Joseph un manteau spÃ©cial.' },
                        { day: 3, title: 'ğŸ’­ Les Premiers RÃªves', description: 'Joseph rÃªve que ses frÃ¨res se prosternent devant lui.' },
                        { day: 4, title: 'ğŸ˜  La Jalousie des FrÃ¨res', description: 'Les frÃ¨res de Joseph deviennent jaloux.' },
                        { day: 5, title: 'ğŸ‘ Gardien de Troupeaux', description: 'Joseph aide son pÃ¨re Ã  surveiller les troupeaux.' },
                        { day: 6, title: 'ğŸ“° Le Rapport', description: 'Joseph rapporte les mauvaises actions de ses frÃ¨res.' },
                        { day: 7, title: 'ğŸŒ¾ Le RÃªve des Gerbes', description: 'Joseph rÃªve de gerbes qui se prosternent.' },
                        { day: 8, title: 'â­ Le RÃªve des Astres', description: 'Le soleil, la lune et les Ã©toiles se prosternent.' },
                        { day: 9, title: 'ğŸ—£ï¸ Joseph Raconte ses RÃªves', description: 'Joseph partage ses rÃªves avec sa famille.' },
                        { day: 10, title: 'ğŸ˜¤ La ColÃ¨re de Jacob', description: 'MÃªme Jacob rÃ©primande Joseph pour ses rÃªves.' },
                        { day: 11, title: 'ğŸš¶â€â™‚ï¸ Mission Ã  Sichem', description: 'Jacob envoie Joseph chercher ses frÃ¨res.' },
                        { day: 12, title: 'ğŸ” La Recherche', description: 'Joseph cherche ses frÃ¨res dans les pÃ¢turages.' },
                        { day: 13, title: 'ğŸ‘ï¸ "Voici le Faiseur de RÃªves"', description: 'Les frÃ¨res voient Joseph arriver de loin.' },
                        { day: 14, title: 'ğŸ’€ Le Complot', description: 'Les frÃ¨res complotent pour tuer Joseph.' },
                        { day: 15, title: 'ğŸ•³ï¸ La Citerne', description: 'Ruben sauve Joseph en le jetant dans une citerne.' },
                        { day: 16, title: 'ğŸ Le Repas Cruel', description: 'Les frÃ¨res mangent pendant que Joseph crie.' },
                        { day: 17, title: 'ğŸª Les Marchands', description: 'Une caravane d\'IsmaÃ©lites passe par lÃ .' },
                        { day: 18, title: 'ğŸ’° La Vente', description: 'Joseph est vendu pour 20 piÃ¨ces d\'argent.' },
                        { day: 19, title: 'ğŸ©¸ Le Mensonge', description: 'Les frÃ¨res trempent le manteau dans le sang.' },
                        { day: 20, title: 'ğŸ˜­ La Douleur de Jacob', description: 'Jacob pleure son fils qu\'il croit mort.' },
                        { day: 21, title: 'ğŸº Chez Potiphar', description: 'Joseph devient serviteur chez Potiphar.' },
                        { day: 22, title: 'ğŸ“ˆ La BÃ©nÃ©diction', description: 'Dieu bÃ©nit tout ce que fait Joseph.' },
                        { day: 23, title: 'ğŸ‘‘ Intendant de la Maison', description: 'Potiphar confie tout Ã  Joseph.' },
                        { day: 24, title: 'ğŸ‘© La Tentation', description: 'La femme de Potiphar tente de sÃ©duire Joseph.' },
                        { day: 25, title: 'ğŸƒâ€â™‚ï¸ La Fuite', description: 'Joseph fuit la tentation et reste pur.' },
                        { day: 26, title: 'ğŸ¤¥ L\'Accusation', description: 'La femme accuse faussement Joseph.' },
                        { day: 27, title: 'â›“ï¸ La Prison', description: 'Joseph est injustement emprisonnÃ©.' },
                        { day: 28, title: 'ğŸ”‘ Chef des Prisonniers', description: 'Dieu donne faveur Ã  Joseph en prison.' },
                        { day: 29, title: 'ğŸ· L\'Ã‰chanson et le Panetier', description: 'Joseph interprÃ¨te leurs rÃªves.' },
                        { day: 30, title: 'ğŸ˜” L\'Oubli', description: 'L\'Ã©chanson oublie Joseph pendant 2 ans.' },
                        { day: 31, title: 'ğŸ‘‘ Les RÃªves de Pharaon', description: 'Pharaon fait des rÃªves troublants.' },
                        { day: 32, title: 'ğŸ’¡ Le Souvenir', description: 'L\'Ã©chanson se souvient enfin de Joseph.' },
                        { day: 33, title: 'ğŸƒâ€â™‚ï¸ L\'Appel du Palais', description: 'Joseph est amenÃ© devant Pharaon.' },
                        { day: 34, title: 'ğŸ„ InterprÃ©tation des RÃªves', description: 'Joseph rÃ©vÃ¨le le sens des rÃªves.' },
                        { day: 35, title: 'ğŸŒ¾ 7 AnnÃ©es d\'Abondance', description: 'Joseph prÃ©dit 7 annÃ©es de prospÃ©ritÃ©.' },
                        { day: 36, title: 'ğŸ’€ 7 AnnÃ©es de Famine', description: 'Puis 7 annÃ©es de famine terrible.' },
                        { day: 37, title: 'ğŸ‘‘ Vice-Roi d\'Ã‰gypte', description: 'Pharaon Ã©lÃ¨ve Joseph au plus haut rang.' },
                        { day: 38, title: 'ğŸ’ L\'Anneau Royal', description: 'Joseph reÃ§oit l\'anneau et les insignes.' },
                        { day: 39, title: 'ğŸ‘° Mariage et Famille', description: 'Joseph Ã©pouse Asnath et a deux fils.' },
                        { day: 40, title: 'ğŸŒ Sauveur de l\'Ã‰gypte', description: 'Joseph sauve l\'Ã‰gypte et les nations.' }
                    ]
                }
            }
        };

        // Spiritual Journey functions
        function startSpiritualJourney() {
            document.getElementById('spiritualJourneyModal').classList.remove('hidden');
            document.getElementById('spiritualJourneyModal').classList.add('flex');
            
            updateJourneyDisplay();
        }

        function updateJourneyDisplay() {
            const currentJourney = journeyData.journeys[journeyData.currentJourney];
            const currentTheme = currentJourney.dailyThemes[journeyData.currentDay - 1] || currentJourney.dailyThemes[0];
            
            // Mettre Ã  jour les informations du parcours actuel
            document.getElementById('currentJourneyTitle').textContent = currentJourney.title;
            document.getElementById('currentJourneySubtitle').textContent = currentJourney.subtitle;
            document.getElementById('currentJourneyProgress').textContent = `${journeyData.currentDay}/${currentJourney.totalDays}`;
            
            // Mettre Ã  jour la carte du parcours avec la bonne couleur
            const currentJourneyCard = document.getElementById('currentJourneyCard');
            currentJourneyCard.className = `bg-gradient-to-r ${currentJourney.color} text-white rounded-xl p-3 mb-2`;
            
            // Mettre Ã  jour la carte du thÃ¨me quotidien
            const dailyThemeCard = document.getElementById('dailyThemeCard');
            dailyThemeCard.className = `bg-gradient-to-r ${currentJourney.color} text-white rounded-xl p-4 mb-4`;
            
            document.getElementById('journeyDay').textContent = journeyData.currentDay;
            document.getElementById('journeySteps').textContent = journeyData.completedSteps;
            document.getElementById('journeyXP').textContent = journeyData.xp;
            document.getElementById('journeyTitle').textContent = currentTheme.title;
            document.getElementById('journeyDescription').textContent = currentTheme.description;
            
            // Mettre Ã  jour la barre de progression
            const progress = (journeyData.completedSteps / journeyData.totalSteps) * 100;
            document.getElementById('journeyProgress').textContent = Math.round(progress) + '%';
            document.getElementById('journeyProgressBar').style.width = progress + '%';
            
            updateJourneySteps();
        }

        // Fonctions pour le sÃ©lecteur de parcours
        function showJourneySelector() {
            document.getElementById('journeySelectorModal').classList.remove('hidden');
            document.getElementById('journeySelectorModal').classList.add('flex');
            updateJourneySelectorDisplay();
        }

        function closeJourneySelector() {
            document.getElementById('journeySelectorModal').classList.add('hidden');
            document.getElementById('journeySelectorModal').classList.remove('flex');
        }

        function selectJourney(journeyId) {
            // VÃ©rifier si le parcours est dÃ©bloquÃ©
            if (journeyId === 1) {
                // Parcours 1 toujours disponible
                switchToJourney(journeyId);
            } else if (journeyId === 2 && journeyData.completedJourneys.includes(1)) {
                // Parcours 2 dÃ©bloquÃ© aprÃ¨s avoir terminÃ© le parcours 1
                switchToJourney(journeyId);
            } else if (journeyId === 3 && journeyData.completedJourneys.includes(2)) {
                // Parcours 3 dÃ©bloquÃ© aprÃ¨s avoir terminÃ© le parcours 2
                switchToJourney(journeyId);
            } else {
                // Parcours verrouillÃ©
                showNotification('ğŸ”’ Ce parcours sera dÃ©bloquÃ© aprÃ¨s avoir terminÃ© le prÃ©cÃ©dent !');
                return;
            }
            
            closeJourneySelector();
        }

        function switchToJourney(journeyId) {
            journeyData.currentJourney = journeyId;
            journeyData.currentDay = 1;
            journeyData.completedSteps = 0;
            
            // RÃ©initialiser les Ã©tapes
            journeyData.steps.forEach(step => {
                step.completed = false;
            });
            
            // Mettre Ã  jour les Ã©tapes pour le nouveau parcours
            updateDailyStepsForJourney();
            updateJourneyDisplay();
            
            const currentJourney = journeyData.journeys[journeyId];
            showNotification(`ğŸ¯ Parcours "${currentJourney.title}" sÃ©lectionnÃ© !`);
        }

        function updateJourneySelectorDisplay() {
            // Mettre Ã  jour l'Ã©tat des parcours dans le sÃ©lecteur
            const journey1 = document.querySelector('[onclick="selectJourney(1)"]');
            const journey2 = document.querySelector('[onclick="selectJourney(2)"]');
            const journey3 = document.querySelector('[onclick="selectJourney(3)"]');
            
            // Parcours 1 - toujours disponible
            if (journeyData.currentJourney === 1) {
                journey1.querySelector('.bg-emerald-100').textContent = 'En cours';
                journey1.querySelector('.bg-emerald-100').className = 'bg-emerald-100 text-emerald-700 px-3 py-1 rounded-full text-xs font-bold';
            } else if (journeyData.completedJourneys.includes(1)) {
                journey1.querySelector('.bg-emerald-100').textContent = 'âœ… TerminÃ©';
                journey1.querySelector('.bg-emerald-100').className = 'bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold';
            }
            
            // Parcours 2 - dÃ©bloquÃ© aprÃ¨s le parcours 1
            if (journeyData.completedJourneys.includes(1)) {
                if (journeyData.currentJourney === 2) {
                    journey2.querySelector('.bg-gray-100').textContent = 'En cours';
                    journey2.querySelector('.bg-gray-100').className = 'bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold';
                } else if (journeyData.completedJourneys.includes(2)) {
                    journey2.querySelector('.bg-gray-100').textContent = 'âœ… TerminÃ©';
                    journey2.querySelector('.bg-gray-100').className = 'bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold';
                } else {
                    journey2.querySelector('.bg-gray-100').textContent = 'ğŸ”“ Disponible';
                    journey2.querySelector('.bg-gray-100').className = 'bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-xs font-bold';
                }
                journey2.classList.remove('opacity-60');
                journey2.style.pointerEvents = 'auto';
            }
            
            // Parcours 3 - dÃ©bloquÃ© aprÃ¨s le parcours 2
            if (journeyData.completedJourneys.includes(2)) {
                if (journeyData.currentJourney === 3) {
                    journey3.querySelector('.bg-gray-100').textContent = 'En cours';
                    journey3.querySelector('.bg-gray-100').className = 'bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-xs font-bold';
                } else if (journeyData.completedJourneys.includes(3)) {
                    journey3.querySelector('.bg-gray-100').textContent = 'âœ… TerminÃ©';
                    journey3.querySelector('.bg-gray-100').className = 'bg-green-100 text-green-700 px-3 py-1 rounded-full text-xs font-bold';
                } else {
                    journey3.querySelector('.bg-gray-100').textContent = 'ğŸ”“ Disponible';
                    journey3.querySelector('.bg-gray-100').className = 'bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-xs font-bold';
                }
                journey3.classList.remove('opacity-60');
                journey3.style.pointerEvents = 'auto';
            }
        }

        function updateJourneySteps() {
            const stepsContainer = document.getElementById('journeyStepsContainer');
            
            stepsContainer.innerHTML = journeyData.steps.map((step, index) => {
                const isCompleted = step.completed;
                const isAvailable = index === 0 || journeyData.steps[index - 1].completed;
                const isLocked = !isAvailable && !isCompleted;
                
                let bgClass, borderClass, textClass, iconBg, statusIcon, opacity;
                
                if (isCompleted) {
                    bgClass = 'bg-green-50';
                    borderClass = 'border-green-200';
                    textClass = 'text-green-800';
                    iconBg = 'bg-green-500';
                    statusIcon = 'âœ…';
                    opacity = '';
                } else if (isAvailable) {
                    bgClass = 'bg-emerald-50';
                    borderClass = 'border-emerald-200';
                    textClass = 'text-emerald-800';
                    iconBg = 'bg-emerald-500';
                    statusIcon = 'â³';
                    opacity = '';
                } else {
                    bgClass = 'bg-gray-50';
                    borderClass = 'border-gray-200';
                    textClass = 'text-gray-600';
                    iconBg = 'bg-gray-400';
                    statusIcon = 'ğŸ”’';
                    opacity = 'opacity-50';
                }
                
                const clickHandler = isAvailable && !isCompleted ? `onclick="completeJourneyStep(${step.id})"` : '';
                const cursor = isAvailable && !isCompleted ? 'cursor-pointer hover:bg-emerald-100' : '';
                
                return `
                    <div class="flex items-center p-3 ${bgClass} rounded-xl border ${borderClass} ${cursor} transition-all ${opacity}" ${clickHandler}>
                        <div class="w-8 h-8 ${iconBg} rounded-full flex items-center justify-center text-white text-sm mr-3">
                            <span>${isCompleted ? 'âœ“' : step.id}</span>
                        </div>
                        <div class="flex-1">
                            <p class="font-semibold ${textClass} text-sm">${step.title}</p>
                            <p class="text-xs ${textClass.replace('800', '600')}">${step.description}</p>
                        </div>
                        <div class="${textClass.replace('800', '600')}">${statusIcon}</div>
                    </div>
                `;
            }).join('');
        }

        function completeJourneyStep(stepId) {
            const step = journeyData.steps.find(s => s.id === stepId);
            if (!step || step.completed) return;
            
            // VÃ©rifier si l'Ã©tape est disponible
            const stepIndex = journeyData.steps.findIndex(s => s.id === stepId);
            const isAvailable = stepIndex === 0 || journeyData.steps[stepIndex - 1].completed;
            
            if (!isAvailable) {
                showNotification('ğŸ”’ ComplÃ¨te d\'abord l\'Ã©tape prÃ©cÃ©dente !');
                return;
            }
            
            step.completed = true;
            journeyData.completedSteps++;
            journeyData.xp += 10;
            
            showNotification(`âœ… Ã‰tape "${step.title}" complÃ©tÃ©e ! +10 XP`);
            
            // VÃ©rifier si le jour est terminÃ©
            if (journeyData.completedSteps === journeyData.totalSteps) {
                setTimeout(() => {
                    completeDailyJourney();
                }, 1000);
            }
            
            updateJourneyDisplay();
        }

        function completeDailyJourney() {
            // Bonus de fin de jour
            journeyData.xp += 50;
            journeyData.streak++;
            
            const currentJourney = journeyData.journeys[journeyData.currentJourney];
            
            // Ajouter un badge selon le jour et le parcours
            const badges = {
                1: { // Parcours Fondations
                    1: 'ğŸŒ± Fondation', 5: 'ğŸ•Šï¸ Paix', 10: 'ğŸ”¥ Passion', 15: 'âš–ï¸ Justice', 
                    20: 'ğŸ Communion', 25: 'ğŸ“¯ TÃ©moignage', 30: 'â­ Gloire', 35: 'ğŸŒ± Fruits', 40: 'ğŸ‘‘ Victoire'
                },
                2: { // Parcours Vie de JÃ©sus
                    1: 'ğŸŒŸ Annonciation', 7: 'ğŸŒŠ BaptÃªme', 14: 'ğŸ Multiplication', 21: 'ğŸŒ´ Triomphe', 
                    27: 'ğŸ CÃ¨ne', 33: 'âœï¸ Crucifixion', 35: 'ğŸŒ… RÃ©surrection', 39: 'â˜ï¸ Ascension', 40: 'ğŸ”¥ PentecÃ´te'
                },
                3: { // Parcours Vie de Joseph
                    2: 'ğŸŒˆ Manteau', 8: 'â­ RÃªves', 15: 'ğŸ•³ï¸ Citerne', 18: 'ğŸ’° Vente', 
                    25: 'ğŸƒâ€â™‚ï¸ Fuite', 27: 'â›“ï¸ Prison', 34: 'ğŸ„ InterprÃ©tation', 37: 'ğŸ‘‘ Vice-Roi', 40: 'ğŸŒ Sauveur'
                }
            };
            
            const journeyBadges = badges[journeyData.currentJourney] || {};
            if (journeyBadges[journeyData.currentDay]) {
                journeyData.badges.push(journeyBadges[journeyData.currentDay]);
            }
            
            showNotification('ğŸ‰ Jour terminÃ© ! +50 XP bonus + Badge gagnÃ© !');
            
            // PrÃ©parer le jour suivant automatiquement
            if (journeyData.currentDay < currentJourney.totalDays) {
                setTimeout(() => {
                    showNotification(`ğŸŒŸ Jour ${journeyData.currentDay} terminÃ© ! Passage automatique au jour suivant...`);
                    setTimeout(() => {
                        nextJourneyDay();
                    }, 1500);
                }, 2000);
            } else {
                // Parcours terminÃ©
                journeyData.completedJourneys.push(journeyData.currentJourney);
                showNotification(`ğŸ† Parcours "${currentJourney.title}" terminÃ© ! Tu es un champion de la foi !`);
                
                // DÃ©bloquer le parcours suivant
                const nextJourneyId = journeyData.currentJourney + 1;
                if (journeyData.journeys[nextJourneyId]) {
                    setTimeout(() => {
                        showNotification(`ğŸ”“ Nouveau parcours dÃ©bloquÃ© : "${journeyData.journeys[nextJourneyId].title}" !`);
                    }, 2000);
                }
            }
        }

        function nextJourneyDay() {
            journeyData.currentDay++;
            journeyData.completedSteps = 0;
            
            // RÃ©initialiser les Ã©tapes
            journeyData.steps.forEach(step => {
                step.completed = false;
            });
            
            // Mettre Ã  jour les Ã©tapes pour le nouveau jour
            updateDailyStepsForJourney();
            updateJourneyDisplay();
            
            showNotification(`ğŸŒ… Bienvenue au jour ${journeyData.currentDay} !`);
        }

        function updateDailyStepsForJourney() {
            const currentJourney = journeyData.journeys[journeyData.currentJourney];
            const currentDay = journeyData.currentDay;
            
            // Ã‰tapes personnalisÃ©es selon le parcours et le jour
            if (journeyData.currentJourney === 1) {
                // Parcours Fondations - Ã©tapes gÃ©nÃ©riques spirituelles
                updateFoundationSteps(currentDay);
            } else if (journeyData.currentJourney === 2) {
                // Parcours Vie de JÃ©sus - Ã©tapes basÃ©es sur les Ã©vÃ©nements
                updateJesusLifeSteps(currentDay);
            } else if (journeyData.currentJourney === 3) {
                // Parcours Vie de Joseph - Ã©tapes basÃ©es sur l'histoire
                updateJosephLifeSteps(currentDay);
            }
        }

        function updateFoundationSteps(day) {
            const foundationSteps = {
                1: [
                    { id: 1, title: 'ğŸ“– Lire Jean 3:16', description: 'MÃ©dite sur l\'amour de Dieu', completed: false },
                    { id: 2, title: 'ğŸ™ Prier 5 minutes', description: 'Parle Ã  Dieu de ton cÅ“ur', completed: false },
                    { id: 3, title: 'âœï¸ Ã‰crire une gratitude', description: 'Note une chose pour laquelle tu es reconnaissant', completed: false },
                    { id: 4, title: 'ğŸ’ Acte de bontÃ©', description: 'Fais quelque chose de gentil pour quelqu\'un', completed: false },
                    { id: 5, title: 'ğŸ¯ RÃ©flexion du jour', description: 'RÃ©ponds Ã  la question de rÃ©flexion', completed: false }
                ],
                2: [
                    { id: 1, title: 'ğŸ“– Lire Matthieu 6:9-13', description: 'Apprends le Notre PÃ¨re', completed: false },
                    { id: 2, title: 'ğŸ™ Prier 10 minutes', description: 'Utilise le Notre PÃ¨re comme guide', completed: false },
                    { id: 3, title: 'âœï¸ Ã‰crire une priÃ¨re', description: 'Ã‰cris ta propre priÃ¨re Ã  Dieu', completed: false },
                    { id: 4, title: 'ğŸ’ Prier pour quelqu\'un', description: 'IntercÃ¨de pour une personne', completed: false },
                    { id: 5, title: 'ğŸ¯ RÃ©flexion sur la priÃ¨re', description: 'Comment la priÃ¨re change-t-elle ta vie ?', completed: false }
                ]
            };
            
            journeyData.steps = foundationSteps[day] || foundationSteps[1];
        }

        function updateJesusLifeSteps(day) {
            const jesusSteps = {
                1: [ // L'Annonciation
                    { id: 1, title: 'ğŸ“– Lire Luc 1:26-38', description: 'L\'annonce de l\'ange Gabriel Ã  Marie', completed: false },
                    { id: 2, title: 'ğŸ™ Prier pour l\'obÃ©issance', description: 'Comme Marie, dis "Qu\'il me soit fait selon ta parole"', completed: false },
                    { id: 3, title: 'âœï¸ RÃ©flexion sur l\'appel', description: 'Quel est l\'appel de Dieu dans ta vie ?', completed: false },
                    { id: 4, title: 'ğŸ’ Encourager quelqu\'un', description: 'Partage une parole d\'encouragement', completed: false },
                    { id: 5, title: 'ğŸ¯ MÃ©ditation', description: 'MÃ©dite sur la foi de Marie', completed: false }
                ],
                2: [ // La Naissance
                    { id: 1, title: 'ğŸ“– Lire Luc 2:1-20', description: 'La naissance de JÃ©sus Ã  BethlÃ©em', completed: false },
                    { id: 2, title: 'ğŸ™ Remercier pour JÃ©sus', description: 'Remercie Dieu pour le don de son Fils', completed: false },
                    { id: 3, title: 'âœï¸ Lettre Ã  JÃ©sus', description: 'Ã‰cris une lettre de bienvenue Ã  JÃ©sus', completed: false },
                    { id: 4, title: 'ğŸ’ Partager la joie', description: 'Partage la joie de NoÃ«l avec quelqu\'un', completed: false },
                    { id: 5, title: 'ğŸ¯ Adoration', description: 'Adore JÃ©sus comme les bergers', completed: false }
                ],
                7: [ // Le BaptÃªme
                    { id: 1, title: 'ğŸ“– Lire Matthieu 3:13-17', description: 'Le baptÃªme de JÃ©sus par Jean', completed: false },
                    { id: 2, title: 'ğŸ™ Prier pour ton baptÃªme', description: 'Si tu n\'es pas baptisÃ©, prie pour cette Ã©tape', completed: false },
                    { id: 3, title: 'âœï¸ TÃ©moignage', description: 'Ã‰cris ton tÃ©moignage de foi', completed: false },
                    { id: 4, title: 'ğŸ’ Encourager un nouveau croyant', description: 'Aide quelqu\'un dans sa foi', completed: false },
                    { id: 5, title: 'ğŸ¯ Engagement', description: 'Renouvelle ton engagement envers JÃ©sus', completed: false }
                ]
            };
            
            journeyData.steps = jesusSteps[day] || jesusSteps[1];
        }

        function updateJosephLifeSteps(day) {
            const josephSteps = {
                1: [ // La Naissance de Joseph
                    { id: 1, title: 'ğŸ“– Lire GenÃ¨se 30:22-24', description: 'La naissance de Joseph', completed: false },
                    { id: 2, title: 'ğŸ™ Remercier pour ta famille', description: 'Prie pour tes parents et proches', completed: false },
                    { id: 3, title: 'âœï¸ Histoire familiale', description: 'Ã‰cris sur l\'amour dans ta famille', completed: false },
                    { id: 4, title: 'ğŸ’ Honorer tes parents', description: 'Fais quelque chose de spÃ©cial pour eux', completed: false },
                    { id: 5, title: 'ğŸ¯ RÃ©flexion sur l\'identitÃ©', description: 'Qui es-tu aux yeux de Dieu ?', completed: false }
                ],
                2: [ // Le Manteau Multicolore
                    { id: 1, title: 'ğŸ“– Lire GenÃ¨se 37:3-4', description: 'Le manteau spÃ©cial de Joseph', completed: false },
                    { id: 2, title: 'ğŸ™ Prier contre la jalousie', description: 'Demande Ã  Dieu de garder ton cÅ“ur pur', completed: false },
                    { id: 3, title: 'âœï¸ Dons et talents', description: 'Liste tes dons uniques de Dieu', completed: false },
                    { id: 4, title: 'ğŸ’ CÃ©lÃ©brer les autres', description: 'FÃ©licite quelqu\'un pour ses rÃ©ussites', completed: false },
                    { id: 5, title: 'ğŸ¯ HumilitÃ©', description: 'Comment rester humble malgrÃ© les bÃ©nÃ©dictions ?', completed: false }
                ],
                18: [ // La Vente
                    { id: 1, title: 'ğŸ“– Lire GenÃ¨se 37:25-28', description: 'Joseph vendu par ses frÃ¨res', completed: false },
                    { id: 2, title: 'ğŸ™ Prier pour tes ennemis', description: 'Prie pour ceux qui t\'ont fait du mal', completed: false },
                    { id: 3, title: 'âœï¸ Pardon difficile', description: 'Ã‰cris sur une situation oÃ¹ tu dois pardonner', completed: false },
                    { id: 4, title: 'ğŸ’ Acte de pardon', description: 'Pardonne concrÃ¨tement Ã  quelqu\'un', completed: false },
                    { id: 5, title: 'ğŸ¯ Confiance en Dieu', description: 'Comment faire confiance quand tout va mal ?', completed: false }
                ],
                37: [ // Vice-Roi d'Ã‰gypte
                    { id: 1, title: 'ğŸ“– Lire GenÃ¨se 41:37-44', description: 'Joseph devient vice-roi', completed: false },
                    { id: 2, title: 'ğŸ™ Remercier pour les victoires', description: 'Remercie Dieu pour ses bÃ©nÃ©dictions', completed: false },
                    { id: 3, title: 'âœï¸ Plan de Dieu', description: 'Comment vois-tu le plan de Dieu dans ta vie ?', completed: false },
                    { id: 4, title: 'ğŸ’ Servir avec tes dons', description: 'Utilise tes talents pour aider les autres', completed: false },
                    { id: 5, title: 'ğŸ¯ ResponsabilitÃ©', description: 'Comment bien gÃ©rer ce que Dieu te confie ?', completed: false }
                ]
            };
            
            journeyData.steps = josephSteps[day] || josephSteps[1];
        }

        function updateDailySteps() {
            // Ã‰tapes diffÃ©rentes selon le jour
            const daySteps = {
                1: [
                    { id: 1, title: 'ğŸ“– Lire Jean 3:16', description: 'MÃ©dite sur l\'amour de Dieu', completed: false },
                    { id: 2, title: 'ğŸ™ Prier 5 minutes', description: 'Parle Ã  Dieu de ton cÅ“ur', completed: false },
                    { id: 3, title: 'âœï¸ Ã‰crire une gratitude', description: 'Note une chose pour laquelle tu es reconnaissant', completed: false },
                    { id: 4, title: 'ğŸ’ Acte de bontÃ©', description: 'Fais quelque chose de gentil pour quelqu\'un', completed: false },
                    { id: 5, title: 'ğŸ¯ RÃ©flexion du jour', description: 'RÃ©ponds Ã  la question de rÃ©flexion', completed: false }
                ],
                2: [
                    { id: 1, title: 'ğŸ“– Lire Matthieu 6:9-13', description: 'Apprends le Notre PÃ¨re', completed: false },
                    { id: 2, title: 'ğŸ™ Prier 10 minutes', description: 'Utilise le Notre PÃ¨re comme guide', completed: false },
                    { id: 3, title: 'âœï¸ Ã‰crire une priÃ¨re', description: 'Ã‰cris ta propre priÃ¨re Ã  Dieu', completed: false },
                    { id: 4, title: 'ğŸ’ Prier pour quelqu\'un', description: 'IntercÃ¨de pour une personne', completed: false },
                    { id: 5, title: 'ğŸ¯ RÃ©flexion sur la priÃ¨re', description: 'Comment la priÃ¨re change-t-elle ta vie ?', completed: false }
                ],
                3: [
                    { id: 1, title: 'ğŸ“– Lire Psaume 119:105', description: 'La Parole comme lumiÃ¨re', completed: false },
                    { id: 2, title: 'ğŸ™ Prier avec un verset', description: 'Utilise un verset dans ta priÃ¨re', completed: false },
                    { id: 3, title: 'âœï¸ MÃ©moriser un verset', description: 'Apprends un verset par cÅ“ur', completed: false },
                    { id: 4, title: 'ğŸ’ Partager la Parole', description: 'Partage un verset avec quelqu\'un', completed: false },
                    { id: 5, title: 'ğŸ¯ MÃ©ditation biblique', description: 'MÃ©dite 10 minutes sur un passage', completed: false }
                ],
                4: [
                    { id: 1, title: 'ğŸ“– Lire 1 Corinthiens 13', description: 'Le chapitre de l\'amour', completed: false },
                    { id: 2, title: 'ğŸ™ Prier pour tes ennemis', description: 'Demande Ã  Dieu de bÃ©nir ceux qui te font du mal', completed: false },
                    { id: 3, title: 'âœï¸ Lettre d\'amour', description: 'Ã‰cris une lettre d\'encouragement', completed: false },
                    { id: 4, title: 'ğŸ’ Pardonner quelqu\'un', description: 'Pardonne Ã  quelqu\'un qui t\'a blessÃ©', completed: false },
                    { id: 5, title: 'ğŸ¯ Acte d\'amour', description: 'Fais un geste d\'amour dÃ©sintÃ©ressÃ©', completed: false }
                ],
                5: [
                    { id: 1, title: 'ğŸ“– Lire Philippiens 4:6-7', description: 'La paix qui surpasse tout', completed: false },
                    { id: 2, title: 'ğŸ™ PriÃ¨re de paix', description: 'Prie pour la paix dans ton cÅ“ur', completed: false },
                    { id: 3, title: 'âœï¸ Journal de paix', description: 'Ã‰cris ce qui trouble ta paix', completed: false },
                    { id: 4, title: 'ğŸ’ RÃ©conciliation', description: 'RÃ©concilie-toi avec quelqu\'un', completed: false },
                    { id: 5, title: 'ğŸ¯ MÃ©ditation de paix', description: 'MÃ©dite en silence 15 minutes', completed: false }
                ]
            };
            
            journeyData.steps = daySteps[journeyData.currentDay] || daySteps[1];
        }

        function viewJourneyCalendar() {
            document.getElementById('journeyContent').classList.add('hidden');
            document.getElementById('journeyStats').classList.add('hidden');
            document.getElementById('journeyCalendar').classList.remove('hidden');
        }

        function viewJourneyStats() {
            document.getElementById('journeyContent').classList.add('hidden');
            document.getElementById('journeyCalendar').classList.add('hidden');
            document.getElementById('journeyStats').classList.remove('hidden');
        }

        function backToJourney() {
            document.getElementById('journeyCalendar').classList.add('hidden');
            document.getElementById('journeyStats').classList.add('hidden');
            document.getElementById('journeyContent').classList.remove('hidden');
        }

        function closeSpiritualJourneyModal() {
            document.getElementById('spiritualJourneyModal').classList.add('hidden');
            document.getElementById('spiritualJourneyModal').classList.remove('flex');
        }

        // Variables pour le systÃ¨me de rÃ©ponse
        let currentReplyMessage = null;
        let privateChats = {}; // Stockage des discussions privÃ©es

        // Fonctions pour le modal de rÃ©ponse
        function openReplyModal(messageId) {
            const message = inboxMessages.find(msg => msg.id === messageId);
            if (!message) return;
            
            currentReplyMessage = message;
            
            // Remplir les informations du modal
            document.getElementById('replyUserName').textContent = message.sender;
            document.getElementById('replyUserAvatar').textContent = message.avatar;
            document.getElementById('replyMessageType').textContent = message.type;
            document.getElementById('replyMessageType').className = `${message.typeColor} px-2 py-1 rounded-full text-xs font-medium`;
            document.getElementById('replyMessageTime').textContent = message.time;
            document.getElementById('replyOriginalMessage').textContent = `"${message.message}"`;
            
            // RÃ©initialiser le textarea
            document.getElementById('replyTextarea').value = '';
            document.getElementById('replyCharCount').textContent = '0';
            
            // Ouvrir le modal
            document.getElementById('replyModal').classList.remove('hidden');
            document.getElementById('replyModal').classList.add('flex');
            
            showNotification(`ğŸ’¬ RÃ©ponse Ã  ${message.sender}`);
        }

        function closeReplyModal() {
            document.getElementById('replyModal').classList.add('hidden');
            document.getElementById('replyModal').classList.remove('flex');
            currentReplyMessage = null;
        }

        function addReplyEmoji(emoji) {
            const textarea = document.getElementById('replyTextarea');
            const currentText = textarea.value;
            const newText = currentText + emoji;
            
            if (newText.length <= 500) {
                textarea.value = newText;
                updateReplyCharCount();
                textarea.focus();
            }
        }

        function setQuickReply(text) {
            const textarea = document.getElementById('replyTextarea');
            textarea.value = text;
            updateReplyCharCount();
            textarea.focus();
        }

        function updateReplyCharCount() {
            const textarea = document.getElementById('replyTextarea');
            const charCount = document.getElementById('replyCharCount');
            charCount.textContent = textarea.value.length;
            
            // Changer la couleur selon la limite
            if (textarea.value.length > 450) {
                charCount.className = 'text-red-500 font-medium';
            } else if (textarea.value.length > 400) {
                charCount.className = 'text-orange-500';
            } else {
                charCount.className = '';
            }
        }

        function sendReply() {
            const replyText = document.getElementById('replyTextarea').value.trim();
            
            if (!replyText) {
                showNotification('âŒ Ã‰cris d\'abord ta rÃ©ponse !');
                return;
            }
            
            if (!currentReplyMessage) {
                showNotification('âŒ Erreur : message introuvable');
                return;
            }
            
            // GÃ©nÃ©rer l'image template avec la rÃ©ponse
            generateReplyTemplate(currentReplyMessage, replyText);
            
            // Simuler l'envoi de la rÃ©ponse
            showNotification('ğŸ“¤ RÃ©ponse envoyÃ©e avec succÃ¨s !');
            
            // Si la personne a un lien/profil, proposer de commencer une discussion
            if (currentReplyMessage.hasLink) {
                setTimeout(() => {
                    if (confirm(`ğŸ’¬ ${currentReplyMessage.sender} a un profil PrayLink ! Veux-tu commencer une discussion privÃ©e avec cette personne ?`)) {
                        startPrivateChatFromReply();
                    } else {
                        closeReplyModal();
                    }
                }, 1000);
            } else {
                // Fermer le modal aprÃ¨s 2 secondes
                setTimeout(() => {
                    closeReplyModal();
                }, 2000);
            }
            
            // Ajouter une animation de succÃ¨s
            const sendBtn = document.querySelector('[onclick="sendReply()"]');
            const originalText = sendBtn.innerHTML;
            sendBtn.innerHTML = 'âœ… EnvoyÃ© !';
            sendBtn.classList.add('bg-green-500');
            sendBtn.disabled = true;
            
            setTimeout(() => {
                sendBtn.innerHTML = originalText;
                sendBtn.classList.remove('bg-green-500');
                sendBtn.disabled = false;
            }, 2000);
        }

        function startPrivateChat() {
            if (!currentReplyMessage) {
                showNotification('âŒ Erreur : message introuvable');
                return;
            }
            
            if (!currentReplyMessage.hasLink) {
                showNotification('âŒ Cette personne n\'a pas de profil PrayLink pour une discussion privÃ©e');
                return;
            }
            
            startPrivateChatFromReply();
        }

        function startPrivateChatFromReply() {
            const message = currentReplyMessage;
            
            // CrÃ©er un nom d'utilisateur basÃ© sur le lien
            let chatUsername = message.sender;
            if (message.link) {
                const linkParts = message.link.split('/');
                const userFromLink = linkParts[linkParts.length - 1];
                chatUsername = userFromLink.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
            }
            
            // CrÃ©er ou rÃ©cupÃ©rer la discussion privÃ©e
            if (!privateChats[chatUsername]) {
                privateChats[chatUsername] = {
                    avatar: 'ğŸ’¬',
                    status: 'En ligne',
                    messages: [
                        {
                            type: 'received',
                            text: `Salut ! J'ai vu que tu as rÃ©pondu Ã  mon message "${message.message.substring(0, 50)}..." ğŸ˜Š`,
                            time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })
                        },
                        {
                            type: 'received',
                            text: 'Merci pour ta rÃ©ponse ! Ã‡a me fait vraiment plaisir ğŸ™',
                            time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })
                        }
                    ]
                };
            }
            
            // Ajouter la rÃ©ponse Ã  la discussion si elle existe
            const replyText = document.getElementById('replyTextarea').value.trim();
            if (replyText) {
                privateChats[chatUsername].messages.push({
                    type: 'sent',
                    text: replyText,
                    time: new Date().toLocaleTimeString('fr-FR', { hour: '2-digit', minute: '2-digit' })
                });
            }
            
            // Fermer le modal de rÃ©ponse
            closeReplyModal();
            
            // Ouvrir la discussion privÃ©e
            setTimeout(() => {
                startConversation(chatUsername);
                showNotification(`ğŸ’¬ Discussion privÃ©e avec ${chatUsername} ouverte !`);
            }, 500);
        }

        // Mettre Ã  jour la fonction startConversation pour utiliser les discussions privÃ©es
        function startConversation(username) {
            currentConversation = username;
            
            // Utiliser les donnÃ©es des discussions privÃ©es si disponibles
            const chatData = privateChats[username] || conversationData[username];
            
            document.getElementById('conversationUserName').textContent = username;
            document.getElementById('conversationUserAvatar').textContent = chatData?.avatar || 'ğŸ‘¤';
            document.getElementById('conversationStatus').textContent = chatData?.status || 'Hors ligne';
            
            loadConversationMessages();
            
            document.getElementById('conversationModal').classList.remove('hidden');
            document.getElementById('conversationModal').classList.add('flex');
        }

        // Mettre Ã  jour loadConversationMessages pour utiliser les discussions privÃ©es
        function loadConversationMessages() {
            const messagesContainer = document.getElementById('conversationMessages');
            const messages = privateChats[currentConversation]?.messages || conversationData[currentConversation]?.messages || [];
            
            messagesContainer.innerHTML = messages.map(msg => `
                <div class="flex ${msg.type === 'sent' ? 'justify-end' : 'justify-start'}">
                    <div class="max-w-[70%] ${msg.type === 'sent' 
                        ? 'bg-gradient-to-r from-purple-500 to-pink-500 text-white' 
                        : 'bg-gray-100 text-gray-800'} rounded-2xl px-4 py-3">
                        <p class="text-sm">${msg.text}</p>
                        <p class="text-xs opacity-75 mt-1">${msg.time}</p>
                    </div>
                </div>
            `).join('');
            
            // Scroll vers le bas
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Mettre Ã  jour sendMessage pour utiliser les discussions privÃ©es
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message && currentConversation) {
                const now = new Date();
                const time = now.getHours().toString().padStart(2, '0') + ':' + now.getMinutes().toString().padStart(2, '0');
                
                // CrÃ©er la discussion privÃ©e si elle n'existe pas
                if (!privateChats[currentConversation]) {
                    privateChats[currentConversation] = { messages: [] };
                }
                
                // Ajouter le message Ã  la discussion privÃ©e
                privateChats[currentConversation].messages.push({
                    type: 'sent',
                    text: message,
                    time: time
                });
                
                input.value = '';
                loadConversationMessages();
                showNotification('ğŸ“¤ Message envoyÃ© !');
                
                // Simuler une rÃ©ponse automatique aprÃ¨s 2 secondes
                setTimeout(() => {
                    const responses = [
                        'Merci pour ton message ! ğŸ™',
                        'Amen ! Ce verset me touche aussi â¤ï¸',
                        'Que Dieu te bÃ©nisse ! âœ¨',
                        'Prions ensemble pour cela ğŸ•Šï¸',
                        'Tu as raison, Dieu est fidÃ¨le ! ğŸŒŸ',
                        'Merci pour tes encouragements ğŸ’',
                        'C\'est exactement ce dont j\'avais besoin d\'entendre ğŸ¯'
                    ];
                    
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    const responseTime = new Date();
                    const responseTimeStr = responseTime.getHours().toString().padStart(2, '0') + ':' + responseTime.getMinutes().toString().padStart(2, '0');
                    
                    privateChats[currentConversation].messages.push({
                        type: 'received',
                        text: randomResponse,
                        time: responseTimeStr
                    });
                    
                    loadConversationMessages();
                }, 2000);
            }
        }

        // Fonctions pour le systÃ¨me de template
        function generateReplyTemplate(originalMessage, replyText) {
            // CrÃ©er le template HTML
            const templateHTML = createTemplateHTML(originalMessage, replyText);
            
            // Afficher dans le modal
            document.getElementById('templatePreview').innerHTML = templateHTML;
            
            // GÃ©nÃ©rer le lien personnel
            const personalLink = `https://praylink.app/u/${username || 'prayerwarrior'}`;
            document.getElementById('personalLink').value = personalLink;
            
            // Ouvrir le modal de template
            document.getElementById('templateModal').classList.remove('hidden');
            document.getElementById('templateModal').classList.add('flex');
            
            showNotification('ğŸ“¸ Template gÃ©nÃ©rÃ© ! PrÃªt Ã  partager sur ton statut');
        }

        function createTemplateHTML(originalMessage, replyText) {
            const userDisplayName = username || 'PrayerWarrior';
            const personalLink = `https://praylink.app/u/${username || 'prayerwarrior'}`;
            
            return `
                <div class="w-full bg-gradient-to-br from-purple-500 to-pink-600 text-white p-6 relative overflow-hidden" style="min-height: 400px;">
                    <!-- Motifs dÃ©coratifs -->
                    <div class="absolute top-0 right-0 w-32 h-32 bg-white bg-opacity-10 rounded-full -translate-y-16 translate-x-16"></div>
                    <div class="absolute bottom-0 left-0 w-24 h-24 bg-white bg-opacity-10 rounded-full translate-y-12 -translate-x-12"></div>
                    
                    <!-- Header -->
                    <div class="text-center mb-6">
                        <div class="w-16 h-16 bg-white bg-opacity-20 rounded-full mx-auto mb-3 flex items-center justify-center text-2xl">
                            ğŸ™
                        </div>
                        <h1 class="text-xl font-bold mb-1">PrayLink</h1>
                        <p class="text-sm opacity-90">Messages anonymes bibliques</p>
                    </div>
                    
                    <!-- Message original -->
                    <div class="bg-white bg-opacity-15 rounded-2xl p-4 mb-4 backdrop-blur-sm">
                        <div class="flex items-center mb-2">
                            <span class="bg-white bg-opacity-30 px-2 py-1 rounded-full text-xs font-medium">${originalMessage.type}</span>
                            <span class="text-xs opacity-75 ml-2">${originalMessage.time}</span>
                        </div>
                        <p class="text-sm font-medium italic">"${originalMessage.message}"</p>
                        <p class="text-xs opacity-75 mt-2">- ${originalMessage.sender}</p>
                    </div>
                    
                    <!-- RÃ©ponse -->
                    <div class="bg-white text-gray-800 rounded-2xl p-4 mb-4 shadow-lg">
                        <div class="flex items-center mb-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center text-white text-sm mr-3">
                                ${profileEmoji}
                            </div>
                            <div>
                                <p class="font-semibold text-sm">${userDisplayName}</p>
                                <p class="text-xs text-gray-500">Ma rÃ©ponse</p>
                            </div>
                        </div>
                        <p class="text-sm leading-relaxed">${replyText}</p>
                    </div>
                    
                    <!-- Call to action -->
                    <div class="text-center">
                        <div class="bg-white bg-opacity-20 rounded-2xl p-3 backdrop-blur-sm">
                            <p class="text-sm font-medium mb-2">ğŸ’¬ Envoie-moi tes messages anonymes</p>
                            <div class="bg-white bg-opacity-30 rounded-lg px-3 py-2">
                                <p class="text-xs font-mono">${personalLink}</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Footer -->
                    <div class="text-center mt-4">
                        <p class="text-xs opacity-75">Partage ta foi â€¢ ReÃ§ois des priÃ¨res â€¢ Encourage les autres</p>
                    </div>
                </div>
            `;
        }

        function closeTemplateModal() {
            document.getElementById('templateModal').classList.add('hidden');
            document.getElementById('templateModal').classList.remove('flex');
        }

        function copyPersonalLink() {
            const linkInput = document.getElementById('personalLink');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            
            try {
                document.execCommand('copy');
                showNotification('ğŸ”— Lien personnel copiÃ© !');
                
                // Animation de succÃ¨s
                const copyBtn = document.querySelector('[onclick="copyPersonalLink()"]');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = 'âœ… CopiÃ© !';
                copyBtn.classList.add('text-green-600');
                
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                    copyBtn.classList.remove('text-green-600');
                }, 2000);
            } catch (err) {
                showNotification('âŒ Erreur lors de la copie');
            }
        }

        function downloadTemplate() {
            // CrÃ©er un canvas pour gÃ©nÃ©rer l'image
            const templateElement = document.getElementById('templatePreview');
            
            // Utiliser html2canvas si disponible, sinon simuler le tÃ©lÃ©chargement
            if (typeof html2canvas !== 'undefined') {
                html2canvas(templateElement, {
                    width: 400,
                    height: 600,
                    scale: 2,
                    backgroundColor: null
                }).then(canvas => {
                    // CrÃ©er un lien de tÃ©lÃ©chargement
                    const link = document.createElement('a');
                    link.download = `praylink-reponse-${Date.now()}.png`;
                    link.href = canvas.toDataURL();
                    link.click();
                    
                    showNotification('ğŸ“± Image tÃ©lÃ©chargÃ©e avec succÃ¨s !');
                });
            } else {
                // Simulation du tÃ©lÃ©chargement
                showNotification('ğŸ“± FonctionnalitÃ© de tÃ©lÃ©chargement simulÃ©e ! En production, l\'image serait tÃ©lÃ©chargÃ©e.');
                
                // CrÃ©er un blob simulÃ© et dÃ©clencher le tÃ©lÃ©chargement
                const canvas = document.createElement('canvas');
                canvas.width = 400;
                canvas.height = 600;
                const ctx = canvas.getContext('2d');
                
                // Fond dÃ©gradÃ©
                const gradient = ctx.createLinearGradient(0, 0, 400, 600);
                gradient.addColorStop(0, '#8b5cf6');
                gradient.addColorStop(1, '#ec4899');
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, 400, 600);
                
                // Texte de dÃ©monstration
                ctx.fillStyle = 'white';
                ctx.font = 'bold 24px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('PrayLink', 200, 100);
                
                ctx.font = '16px Arial';
                ctx.fillText('Template de rÃ©ponse gÃ©nÃ©rÃ© !', 200, 300);
                
                // TÃ©lÃ©charger
                const link = document.createElement('a');
                link.download = `praylink-reponse-${Date.now()}.png`;
                link.href = canvas.toDataURL();
                link.click();
            }
        }

        function shareToWhatsAppStatus() {
            // Simuler le partage sur WhatsApp Status
            showNotification('ğŸ“± Ouverture de WhatsApp pour partager sur ton statut...');
            
            // En production, cela ouvrirait WhatsApp avec l'image
            const message = "Nouvelle rÃ©ponse PrayLink ! ğŸ™ DÃ©couvre mes messages anonymes sur mon profil.";
            const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(message)}`;
            
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
            }, 1000);
        }

        function shareToInstagramStory() {
            // Simuler le partage sur Instagram Story
            showNotification('ğŸ“· Ouverture d\'Instagram pour partager en story...');
            
            // En production, cela ouvrirait Instagram avec l'image
            setTimeout(() => {
                // Simuler l'ouverture d'Instagram
                showNotification('ğŸ“· Instagram ouvert ! Ajoute l\'image tÃ©lÃ©chargÃ©e Ã  ta story.');
            }, 1000);
        }

        function generateReplyTemplateFromModal() {
            const replyText = document.getElementById('replyTextarea').value.trim();
            
            if (!replyText) {
                showNotification('âŒ Ã‰cris d\'abord ta rÃ©ponse !');
                return;
            }
            
            if (!currentReplyMessage) {
                showNotification('âŒ Erreur : message introuvable');
                return;
            }
            
            // Fermer le modal de rÃ©ponse
            closeReplyModal();
            
            // GÃ©nÃ©rer le template aprÃ¨s un court dÃ©lai
            setTimeout(() => {
                generateReplyTemplate(currentReplyMessage, replyText);
            }, 300);
        }

        // Variables pour l'envoi de versets
        let selectedVersetStyle = 'classic';

        // Fonctions pour envoyer un verset
        function sendVersetToSomeone() {
            const currentVerset = allVersets[currentVersetIndex];
            
            // Remplir les informations du modal
            document.getElementById('sendVersetText').textContent = `"${currentVerset.text}"`;
            document.getElementById('sendVersetRef').textContent = currentVerset.ref;
            
            // RÃ©initialiser le formulaire
            document.getElementById('recipientContact').value = '';
            document.getElementById('personalMessage').value = '';
            document.getElementById('messageCharCount').textContent = '0';
            
            // RÃ©initialiser le style sÃ©lectionnÃ©
            selectVersetStyle('classic');
            
            // Fermer le modal des versets
            closeVersetsModal();
            
            // Ouvrir le modal d'envoi
            document.getElementById('sendVersetModal').classList.remove('hidden');
            document.getElementById('sendVersetModal').classList.add('flex');
            
            showNotification('ğŸ’Œ PrÃªt Ã  envoyer ce verset Ã  quelqu\'un !');
        }

        function closeSendVersetModal() {
            document.getElementById('sendVersetModal').classList.add('hidden');
            document.getElementById('sendVersetModal').classList.remove('flex');
        }

        function selectVersetStyle(style) {
            selectedVersetStyle = style;
            
            // RÃ©initialiser tous les styles
            document.getElementById('styleClassic').classList.remove('border-blue-500', 'bg-blue-50');
            document.getElementById('styleModern').classList.remove('border-blue-500', 'bg-blue-50');
            document.getElementById('styleElegant').classList.remove('border-blue-500', 'bg-blue-50');
            
            document.getElementById('styleClassic').classList.add('border-gray-200');
            document.getElementById('styleModern').classList.add('border-gray-200');
            document.getElementById('styleElegant').classList.add('border-gray-200');
            
            // Appliquer le style sÃ©lectionnÃ©
            const selectedElement = document.getElementById(`style${style.charAt(0).toUpperCase() + style.slice(1)}`);
            selectedElement.classList.remove('border-gray-200');
            selectedElement.classList.add('border-blue-500', 'bg-blue-50');
            
            showNotification(`ğŸ¨ Style "${style}" sÃ©lectionnÃ©`);
        }

        function selectSuggestedContact(name, contact) {
            document.getElementById('recipientContact').value = contact;
            showNotification(`ğŸ‘¥ Contact "${name}" sÃ©lectionnÃ©`);
        }

        function updateMessageCharCount() {
            const textarea = document.getElementById('personalMessage');
            const charCount = document.getElementById('messageCharCount');
            charCount.textContent = textarea.value.length;
            
            // Changer la couleur selon la limite
            if (textarea.value.length > 180) {
                charCount.className = 'text-red-500 font-medium';
            } else if (textarea.value.length > 150) {
                charCount.className = 'text-orange-500';
            } else {
                charCount.className = '';
            }
        }

        function previewVersetMessage() {
            const currentVerset = allVersets[currentVersetIndex];
            const personalMsg = document.getElementById('personalMessage').value;
            const contact = document.getElementById('recipientContact').value;
            
            if (!contact) {
                showNotification('âŒ Ajoute d\'abord un contact !');
                return;
            }
            
            let previewText = `AperÃ§u du message pour ${contact} :\n\n`;
            
            if (personalMsg) {
                previewText += `${personalMsg}\n\n`;
            }
            
            previewText += `"${currentVerset.text}"\n- ${currentVerset.ref}\n\n`;
            previewText += `EnvoyÃ© avec PrayLink ğŸ™`;
            
            alert(previewText);
        }

        function saveVersetDraft() {
            const currentVerset = allVersets[currentVersetIndex];
            const personalMsg = document.getElementById('personalMessage').value;
            const contact = document.getElementById('recipientContact').value;
            
            // Simuler la sauvegarde
            showNotification('ğŸ’¾ Brouillon sauvegardÃ© ! Tu pourras le retrouver dans tes brouillons.');
        }

        function sendVersetNow() {
            const contact = document.getElementById('recipientContact').value.trim();
            const personalMsg = document.getElementById('personalMessage').value.trim();
            
            if (!contact) {
                showNotification('âŒ Ajoute un numÃ©ro de tÃ©lÃ©phone ou email !');
                return;
            }
            
            // Simuler l'envoi
            showNotification('ğŸ“¤ Verset envoyÃ© avec succÃ¨s ! ğŸ™');
            
            // Animation de succÃ¨s
            const sendBtn = document.querySelector('[onclick="sendVersetNow()"]');
            const originalText = sendBtn.innerHTML;
            sendBtn.innerHTML = 'âœ… EnvoyÃ© !';
            sendBtn.classList.add('bg-green-600');
            sendBtn.disabled = true;
            
            setTimeout(() => {
                sendBtn.innerHTML = originalText;
                sendBtn.classList.remove('bg-green-600');
                sendBtn.disabled = false;
                closeSendVersetModal();
            }, 2000);
            
            // Ajouter aux statistiques
            showNotification('ğŸ“Š Statistiques mises Ã  jour : +1 verset partagÃ©');
        }

        // Ajouter l'Ã©vÃ©nement pour le compteur de caractÃ¨res
        document.addEventListener('DOMContentLoaded', function() {
            const replyTextarea = document.getElementById('replyTextarea');
            if (replyTextarea) {
                replyTextarea.addEventListener('input', updateReplyCharCount);
            }
            
            const personalMessageTextarea = document.getElementById('personalMessage');
            if (personalMessageTextarea) {
                personalMessageTextarea.addEventListener('input', updateMessageCharCount);
            }
        });

        // --- Nouveau flux d'inscription et de connexion ---

        async function createAccount() {
            const usernameInput = document.getElementById('usernameInput').value.trim();
            if (!usernameInput) {
                showNotification('âŒ Veuillez entrer un nom d\'utilisateur.');
                return;
            }

            username = usernameInput;
            showLoader();

            try {
                // 1. VÃ©rifier si le nom d'utilisateur est disponible
                let response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'checkUser', username: username })
                });
                let result = await response.json();

                if (result.success && result.exists) {
                    showNotification('âŒ Ce nom d\'utilisateur est dÃ©jÃ  pris. Veuillez en choisir un autre.');
                    hideLoader();
                    return;
                }

                // 2. Si disponible, crÃ©er l'utilisateur
                const userData = {
                    username: username,
                    platform: selectedPlatform || 'instagram',
                    profileEmoji: 'ğŸ™' // Emoji par dÃ©faut
                };

                response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ action: 'createUser', ...userData })
                });
                result = await response.json();

                if (result.success) {
                    localStorage.setItem('praylink_user', JSON.stringify(userData));
                    showNotification('âœ… Profil crÃ©Ã© avec succÃ¨s !');
                    showLinksPage(userData.username);
                } else {
                    showNotification(`âŒ Erreur lors de la crÃ©ation : ${result.error}`);
                }

            } catch (error) {
                showNotification('âŒ Erreur rÃ©seau. Veuillez rÃ©essayer.');
            } finally {
                hideLoader();
            }
        }

        function showLinksPage(username) {
            const baseUrl = 'https://praylink-beta.vercel.app';
            document.getElementById('sharingLink').value = `${baseUrl}/u/${username}`;
            document.getElementById('loginLink').value = `${baseUrl}/profile/${username}`;
            goToPage('linksPage');
        }

        function copyLink(inputId) {
            const linkInput = document.getElementById(inputId);
            linkInput.select();
            linkInput.setSelectionRange(0, 99999);
            try {
                document.execCommand('copy');
                showNotification('âœ… Lien copiÃ© !');
            } catch (err) {
                showNotification('âŒ Erreur lors de la copie');
            }
        }

        function onContinueFromLinksPage() {
            const savedUser = localStorage.getItem('praylink_user');
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                username = userData.username;
                profileEmoji = userData.profileEmoji;
                document.getElementById('mainUsername').textContent = '@' + username;
                setProfileEmoji(profileEmoji);
            }
            goToPage('mainPage');
        }

        async function handleLoginFromUrl() {
            const path = window.location.pathname;
            const loginPath = '/profile/';

            if (path.startsWith(loginPath)) {
                const loginUsername = path.substring(loginPath.length).split('/')[0];
                if (loginUsername) {
                    showLoader();
                    try {
                        const response = await fetch(SCRIPT_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ action: 'checkUser', username: loginUsername })
                        });
                        const result = await response.json();

                        if (result.success && result.exists) {
                            const user = result.user;
                            localStorage.setItem('praylink_user', JSON.stringify(user));
                            username = user.username;
                            selectedPlatform = user.platform;
                            profileEmoji = user.profileEmoji;

                            document.getElementById('mainUsername').textContent = '@' + user.username;
                            setProfileEmoji(user.profileEmoji);
                            
                            showNotification(`ğŸ‘‹ Bienvenue, ${user.username} !`);
                            goToPage('mainPage');
                            window.history.replaceState({}, document.title, '/');
                        } else {
                            showNotification('âŒ Profil non trouvÃ©. Veuillez vÃ©rifier votre lien.');
                            window.history.replaceState({}, document.title, '/');
                            goToPage('welcomePage');
                        }
                    } catch (error) {
                        showNotification('âŒ Erreur rÃ©seau. Impossible de se connecter.');
                        goToPage('welcomePage');
                    } finally {
                        hideLoader();
                    }
                    return true; // Indique qu'une tentative de connexion a eu lieu
                }
            }
            return false; // Pas de tentative de connexion par URL
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', async function() {
            const usernameInput = document.getElementById('usernameInput');
            if (usernameInput) {
                usernameInput.addEventListener('input', function() {
                    username = this.value.trim();
                });
            }

            const loggedInViaUrl = await handleLoginFromUrl();
            if (loggedInViaUrl) return;

            // Si pas de connexion par URL, vÃ©rifier le localStorage
            const savedUser = localStorage.getItem('praylink_user');
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                username = userData.username;
                profileEmoji = userData.profileEmoji;
                document.getElementById('mainUsername').textContent = '@' + username;
                setProfileEmoji(profileEmoji);
                goToPage('mainPage');
            }
            // Sinon, la page d'accueil est dÃ©jÃ  affichÃ©e par dÃ©faut
        });

    </script>
</body>
</html>
